WandB initialized successfully!
Starting training for lstm model...
Using device: cuda
Model parameters: 33,671 total, 33,671 trainable
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 121.19it/s, loss=0.1996]
Epoch 1 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 110.43it/s, loss=0.1753]
Epoch 1/100 - Time: 1.1s - Train loss: 0.1996, Val loss: 0.1753, Learning rate: 0.010000
  Multiclass: Train acc: 0.3582, Val acc: 0.3910, Val F1: 0.3404
  Contralateral: Train acc: 0.7285, Val acc: 0.7843, Val F1: 0.7782
  Ipsilateral: Train acc: 0.8161, Val acc: 0.8067, Val F1: 0.7245
New best model saved (val_loss: 0.1753)
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 152.73it/s, loss=0.1464]
Epoch 2 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 106.88it/s, loss=0.1194]
Epoch 2/100 - Time: 1.1s - Train loss: 0.1464, Val loss: 0.1194, Learning rate: 0.010000
  Multiclass: Train acc: 0.5455, Val acc: 0.5730, Val F1: 0.5709
  Contralateral: Train acc: 0.7915, Val acc: 0.8067, Val F1: 0.8061
  Ipsilateral: Train acc: 0.8069, Val acc: 0.7933, Val F1: 0.8135
New best model saved (val_loss: 0.1194)
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 149.01it/s, loss=0.1177]
Epoch 3 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 106.26it/s, loss=0.1030]
Epoch 3/100 - Time: 1.9s - Train loss: 0.1177, Val loss: 0.1030, Learning rate: 0.010000
  Multiclass: Train acc: 0.6163, Val acc: 0.6607, Val F1: 0.6583
  Contralateral: Train acc: 0.8214, Val acc: 0.8090, Val F1: 0.8195
  Ipsilateral: Train acc: 0.8488, Val acc: 0.8854, Val F1: 0.8866
New best model saved (val_loss: 0.1030)
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 149.78it/s, loss=0.0941]
Epoch 4 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 101.28it/s, loss=0.1112]
Epoch 4/100 - Time: 0.9s - Train loss: 0.0941, Val loss: 0.1112, Learning rate: 0.010000
  Multiclass: Train acc: 0.7053, Val acc: 0.6427, Val F1: 0.6419
  Contralateral: Train acc: 0.8512, Val acc: 0.8360, Val F1: 0.8394
  Ipsilateral: Train acc: 0.8801, Val acc: 0.8787, Val F1: 0.8750
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 153.23it/s, loss=0.0822]
Epoch 5 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 108.34it/s, loss=0.0899]
Epoch 5/100 - Time: 0.9s - Train loss: 0.0822, Val loss: 0.0899, Learning rate: 0.010000
  Multiclass: Train acc: 0.7439, Val acc: 0.7326, Val F1: 0.7347
  Contralateral: Train acc: 0.8719, Val acc: 0.8809, Val F1: 0.8839
  Ipsilateral: Train acc: 0.8922, Val acc: 0.8539, Val F1: 0.8657
New best model saved (val_loss: 0.0899)
Epoch 6 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 151.06it/s, loss=0.0648]
Epoch 6 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 104.93it/s, loss=0.0851]
Epoch 6/100 - Time: 0.9s - Train loss: 0.0648, Val loss: 0.0851, Learning rate: 0.010000
  Multiclass: Train acc: 0.7843, Val acc: 0.6966, Val F1: 0.6936
  Contralateral: Train acc: 0.8825, Val acc: 0.8292, Val F1: 0.8376
  Ipsilateral: Train acc: 0.9157, Val acc: 0.8854, Val F1: 0.8924
New best model saved (val_loss: 0.0851)
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 153.81it/s, loss=0.0667]
Epoch 7 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 113.19it/s, loss=0.0725]
Epoch 7/100 - Time: 0.9s - Train loss: 0.0667, Val loss: 0.0725, Learning rate: 0.010000
  Multiclass: Train acc: 0.8074, Val acc: 0.7843, Val F1: 0.7854
  Contralateral: Train acc: 0.8888, Val acc: 0.8899, Val F1: 0.8929
  Ipsilateral: Train acc: 0.9206, Val acc: 0.8966, Val F1: 0.8992
New best model saved (val_loss: 0.0725)
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 148.55it/s, loss=0.0600]
Epoch 8 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 100.19it/s, loss=0.0805]
Epoch 8/100 - Time: 0.9s - Train loss: 0.0600, Val loss: 0.0805, Learning rate: 0.010000
  Multiclass: Train acc: 0.8175, Val acc: 0.7551, Val F1: 0.7555
  Contralateral: Train acc: 0.8941, Val acc: 0.8539, Val F1: 0.8610
  Ipsilateral: Train acc: 0.9287, Val acc: 0.8966, Val F1: 0.8996
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 151.60it/s, loss=0.0538]
Epoch 9 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 103.77it/s, loss=0.0719]
Epoch 9/100 - Time: 0.9s - Train loss: 0.0538, Val loss: 0.0719, Learning rate: 0.010000
  Multiclass: Train acc: 0.8488, Val acc: 0.7888, Val F1: 0.7893
  Contralateral: Train acc: 0.9162, Val acc: 0.8674, Val F1: 0.8736
  Ipsilateral: Train acc: 0.9340, Val acc: 0.9191, Val F1: 0.9217
New best model saved (val_loss: 0.0719)
Epoch 10 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.47it/s, loss=0.0485]
Epoch 10 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 109.04it/s, loss=0.0691]
Epoch 10/100 - Time: 0.9s - Train loss: 0.0485, Val loss: 0.0691, Learning rate: 0.010000
  Multiclass: Train acc: 0.8637, Val acc: 0.7820, Val F1: 0.7835
  Contralateral: Train acc: 0.9239, Val acc: 0.8876, Val F1: 0.8898
  Ipsilateral: Train acc: 0.9413, Val acc: 0.9101, Val F1: 0.9142
New best model saved (val_loss: 0.0691)
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.39it/s, loss=0.0437]
Epoch 11 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 108.30it/s, loss=0.0823]
Epoch 11/100 - Time: 0.9s - Train loss: 0.0437, Val loss: 0.0823, Learning rate: 0.010000
  Multiclass: Train acc: 0.8700, Val acc: 0.8157, Val F1: 0.8169
  Contralateral: Train acc: 0.9287, Val acc: 0.9034, Val F1: 0.9056
  Ipsilateral: Train acc: 0.9480, Val acc: 0.9056, Val F1: 0.9087
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.07it/s, loss=0.0421]
Epoch 12 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 106.33it/s, loss=0.0733]
Epoch 12/100 - Time: 0.9s - Train loss: 0.0421, Val loss: 0.0733, Learning rate: 0.010000
  Multiclass: Train acc: 0.8695, Val acc: 0.7955, Val F1: 0.7966
  Contralateral: Train acc: 0.9336, Val acc: 0.8831, Val F1: 0.8842
  Ipsilateral: Train acc: 0.9432, Val acc: 0.9258, Val F1: 0.9286
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 150.46it/s, loss=0.0418]
Epoch 13 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 94.07it/s, loss=0.0877]
Epoch 13/100 - Time: 0.9s - Train loss: 0.0418, Val loss: 0.0877, Learning rate: 0.010000
  Multiclass: Train acc: 0.8864, Val acc: 0.8112, Val F1: 0.8124
  Contralateral: Train acc: 0.9350, Val acc: 0.9011, Val F1: 0.9038
  Ipsilateral: Train acc: 0.9533, Val acc: 0.9101, Val F1: 0.9120
Epoch 14 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.08it/s, loss=0.0413]
Epoch 14 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 106.61it/s, loss=0.0660]
Epoch 14/100 - Time: 0.9s - Train loss: 0.0413, Val loss: 0.0660, Learning rate: 0.010000
  Multiclass: Train acc: 0.8854, Val acc: 0.7978, Val F1: 0.7984
  Contralateral: Train acc: 0.9403, Val acc: 0.8697, Val F1: 0.8752
  Ipsilateral: Train acc: 0.9485, Val acc: 0.9348, Val F1: 0.9370
New best model saved (val_loss: 0.0660)
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.11it/s, loss=0.0400]
Epoch 15 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 110.81it/s, loss=0.0603]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 151.39it/s, loss=0.0353]
Epoch 16 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 105.83it/s, loss=0.0741]
Epoch 15/100 - Time: 0.9s - Train loss: 0.0400, Val loss: 0.0603, Learning rate: 0.010000
  Multiclass: Train acc: 0.8878, Val acc: 0.8315, Val F1: 0.8324
  Contralateral: Train acc: 0.9321, Val acc: 0.8944, Val F1: 0.8971
  Ipsilateral: Train acc: 0.9591, Val acc: 0.9213, Val F1: 0.9229
New best model saved (val_loss: 0.0603)
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.70it/s, loss=0.0342]
Epoch 17 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 108.80it/s, loss=0.0640]
Epoch 16/100 - Time: 0.9s - Train loss: 0.0353, Val loss: 0.0741, Learning rate: 0.010000
  Multiclass: Train acc: 0.9143, Val acc: 0.7978, Val F1: 0.7986
  Contralateral: Train acc: 0.9543, Val acc: 0.8831, Val F1: 0.8868
  Ipsilateral: Train acc: 0.9557, Val acc: 0.9146, Val F1: 0.9187
Epoch 18 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 151.37it/s, loss=0.0331]
Epoch 18 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 110.63it/s, loss=0.0777]
Epoch 17/100 - Time: 0.9s - Train loss: 0.0342, Val loss: 0.0640, Learning rate: 0.010000
  Multiclass: Train acc: 0.8960, Val acc: 0.8337, Val F1: 0.8343
  Contralateral: Train acc: 0.9413, Val acc: 0.8899, Val F1: 0.8937
  Ipsilateral: Train acc: 0.9528, Val acc: 0.9371, Val F1: 0.9393
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.38it/s, loss=0.0325]
Epoch 19 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 112.65it/s, loss=0.0626]
Epoch 18/100 - Time: 0.9s - Train loss: 0.0331, Val loss: 0.0777, Learning rate: 0.010000
  Multiclass: Train acc: 0.8960, Val acc: 0.8202, Val F1: 0.8214
  Contralateral: Train acc: 0.9470, Val acc: 0.8966, Val F1: 0.8986
  Ipsilateral: Train acc: 0.9543, Val acc: 0.9169, Val F1: 0.9174
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 152.80it/s, loss=0.0311]
Epoch 20 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 106.97it/s, loss=0.0818]
Epoch 19/100 - Time: 0.9s - Train loss: 0.0325, Val loss: 0.0626, Learning rate: 0.010000
  Multiclass: Train acc: 0.9133, Val acc: 0.8225, Val F1: 0.8239
  Contralateral: Train acc: 0.9562, Val acc: 0.8966, Val F1: 0.8981
  Ipsilateral: Train acc: 0.9629, Val acc: 0.9169, Val F1: 0.9191
Evaluating: 100%|█████████████████████████████████████| 14/14 [00:00<00:00, 111.08it/s]
Epoch 20/100 - Time: 0.8s - Train loss: 0.0311, Val loss: 0.0818, Learning rate: 0.010000
  Multiclass: Train acc: 0.9143, Val acc: 0.8180, Val F1: 0.8194
  Contralateral: Train acc: 0.9514, Val acc: 0.8854, Val F1: 0.8881
  Ipsilateral: Train acc: 0.9624, Val acc: 0.9236, Val F1: 0.9246
Early stopping triggered after 20 epochs
Best model was at epoch 15
Training completed in 19.1s. Best validation loss: 0.0603
Loaded model from checkpoint (epoch 15)
Evaluating model on test set...
Multiclass Metrics:
  accuracy: 0.8004
  precision: 0.8170
  recall: 0.8004
  f1: 0.8040
Contralateral Metrics:
  accuracy: 0.8834
  precision: 0.8913
  recall: 0.8834
  f1: 0.8861
Ipsilateral Metrics:
  accuracy: 0.9215
  precision: 0.9211
  recall: 0.9215
  f1: 0.9213
Overall Accuracy: 0.8685
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Saved combined metrics to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/combined_metrics.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json