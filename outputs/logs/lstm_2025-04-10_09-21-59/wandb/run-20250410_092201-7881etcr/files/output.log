WandB initialized successfully!
Starting training for lstm model...
Using device: cuda
Model parameters: 71,111 total, 71,111 trainable
Epoch 1 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 126.61it/s, loss=0.2063]
Epoch 1 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 120.70it/s, loss=0.2077]
Epoch 1/100 - Time: 1.2s - Train loss: 0.2063, Val loss: 0.2077, Learning rate: 0.000100
  Multiclass: Train acc: 0.4434, Val acc: 0.4180, Val F1: 0.4071
  Contralateral: Train acc: 0.4988, Val acc: 0.6764, Val F1: 0.6575
  Ipsilateral: Train acc: 0.6168, Val acc: 0.7798, Val F1: 0.7144
New best model saved (val_loss: 0.2077)
Epoch 2 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 148.87it/s, loss=0.2056]
Epoch 2 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 130.90it/s, loss=0.2071]
Epoch 2/100 - Time: 1.0s - Train loss: 0.2056, Val loss: 0.2071, Learning rate: 0.000100
  Multiclass: Train acc: 0.4328, Val acc: 0.4202, Val F1: 0.4100
  Contralateral: Train acc: 0.7130, Val acc: 0.7528, Val F1: 0.6486
  Ipsilateral: Train acc: 0.8166, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.2071)
Epoch 3 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 130.87it/s, loss=0.2048]
Epoch 3 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 99.58it/s, loss=0.2064]
Epoch 3/100 - Time: 1.0s - Train loss: 0.2048, Val loss: 0.2064, Learning rate: 0.000100
  Multiclass: Train acc: 0.4545, Val acc: 0.3978, Val F1: 0.3884
  Contralateral: Train acc: 0.7390, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.2064)
Epoch 4 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 143.01it/s, loss=0.2039]
Epoch 4 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 117.37it/s, loss=0.2054]
Epoch 4/100 - Time: 0.9s - Train loss: 0.2039, Val loss: 0.2054, Learning rate: 0.000100
  Multiclass: Train acc: 0.4405, Val acc: 0.3978, Val F1: 0.3901
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.2054)
Epoch 5/100 - Time: 0.9s - Train loss: 0.2026, Val loss: 0.2039, Learning rate: 0.000100
  Multiclass: Train acc: 0.4333, Val acc: 0.4494, Val F1: 0.4425
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.2039)
Epoch 5 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 152.33it/s, loss=0.2026]
Epoch 5 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 115.93it/s, loss=0.2039]
Epoch 6 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 149.63it/s, loss=0.2003]
Epoch 6 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 111.82it/s, loss=0.2009]
Epoch 6/100 - Time: 0.9s - Train loss: 0.2003, Val loss: 0.2009, Learning rate: 0.000100
  Multiclass: Train acc: 0.4665, Val acc: 0.4562, Val F1: 0.4510
  Contralateral: Train acc: 0.7434, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.2009)
Epoch 7 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 145.01it/s, loss=0.1949]
Epoch 7 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 117.47it/s, loss=0.1944]
Epoch 7/100 - Time: 0.9s - Train loss: 0.1949, Val loss: 0.1944, Learning rate: 0.000100
  Multiclass: Train acc: 0.5036, Val acc: 0.4854, Val F1: 0.4901
  Contralateral: Train acc: 0.7443, Val acc: 0.7573, Val F1: 0.6550
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.1944)
Epoch 8 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 149.64it/s, loss=0.1835]
Epoch 8 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 123.59it/s, loss=0.1813]
Epoch 8/100 - Time: 0.9s - Train loss: 0.1835, Val loss: 0.1813, Learning rate: 0.000100
  Multiclass: Train acc: 0.5161, Val acc: 0.4742, Val F1: 0.4645
  Contralateral: Train acc: 0.7535, Val acc: 0.7528, Val F1: 0.7478
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.1813)
Epoch 9 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.88it/s, loss=0.1635]
Epoch 9 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 120.61it/s, loss=0.1608]
Epoch 10 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 150.31it/s, loss=0.1381]
Epoch 10 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.49it/s, loss=0.1423]
Epoch 9/100 - Time: 0.9s - Train loss: 0.1635, Val loss: 0.1608, Learning rate: 0.000100
  Multiclass: Train acc: 0.5296, Val acc: 0.4989, Val F1: 0.4868
  Contralateral: Train acc: 0.7419, Val acc: 0.7056, Val F1: 0.7207
  Ipsilateral: Train acc: 0.8320, Val acc: 0.8225, Val F1: 0.8017
New best model saved (val_loss: 0.1608)
Epoch 11 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.83it/s, loss=0.1184]
Epoch 11 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.45it/s, loss=0.1266]
Epoch 10/100 - Time: 0.9s - Train loss: 0.1381, Val loss: 0.1423, Learning rate: 0.000100
  Multiclass: Train acc: 0.5556, Val acc: 0.5371, Val F1: 0.5323
  Contralateral: Train acc: 0.7208, Val acc: 0.7326, Val F1: 0.7433
  Ipsilateral: Train acc: 0.8450, Val acc: 0.8180, Val F1: 0.8281
New best model saved (val_loss: 0.1423)
Epoch 11/100 - Time: 0.9s - Train loss: 0.1184, Val loss: 0.1266, Learning rate: 0.000100
  Multiclass: Train acc: 0.5941, Val acc: 0.5618, Val F1: 0.5570
  Contralateral: Train acc: 0.7390, Val acc: 0.7258, Val F1: 0.7420
  Ipsilateral: Train acc: 0.8556, Val acc: 0.8517, Val F1: 0.8565
New best model saved (val_loss: 0.1266)
Epoch 12 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.90it/s, loss=0.1055]
Epoch 12 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.38it/s, loss=0.1183]
Epoch 13 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 160.70it/s, loss=0.0961]
Epoch 13 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 121.53it/s, loss=0.1100]
Epoch 12/100 - Time: 0.9s - Train loss: 0.1055, Val loss: 0.1183, Learning rate: 0.000100
  Multiclass: Train acc: 0.6259, Val acc: 0.6045, Val F1: 0.6026
  Contralateral: Train acc: 0.7439, Val acc: 0.7258, Val F1: 0.7428
  Ipsilateral: Train acc: 0.8719, Val acc: 0.8539, Val F1: 0.8578
New best model saved (val_loss: 0.1183)
Epoch 13/100 - Time: 2.1s - Train loss: 0.0961, Val loss: 0.1100, Learning rate: 0.000100
  Multiclass: Train acc: 0.6567, Val acc: 0.6112, Val F1: 0.6057
  Contralateral: Train acc: 0.7622, Val acc: 0.7438, Val F1: 0.7584
  Ipsilateral: Train acc: 0.8840, Val acc: 0.8517, Val F1: 0.8605
New best model saved (val_loss: 0.1100)
Epoch 14 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.52it/s, loss=0.0899]
Epoch 14 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 125.49it/s, loss=0.1034]
Epoch 14/100 - Time: 0.8s - Train loss: 0.0899, Val loss: 0.1034, Learning rate: 0.000100
  Multiclass: Train acc: 0.6635, Val acc: 0.6090, Val F1: 0.6037
  Contralateral: Train acc: 0.7761, Val acc: 0.7461, Val F1: 0.7612
  Ipsilateral: Train acc: 0.8893, Val acc: 0.8539, Val F1: 0.8612
New best model saved (val_loss: 0.1034)
Epoch 15 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.61it/s, loss=0.0834]
Epoch 15 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 123.75it/s, loss=0.0982]
Epoch 16 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 159.44it/s, loss=0.0759]
Epoch 16 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 123.42it/s, loss=0.0970]
Epoch 15/100 - Time: 0.9s - Train loss: 0.0834, Val loss: 0.0982, Learning rate: 0.000100
  Multiclass: Train acc: 0.6923, Val acc: 0.6382, Val F1: 0.6348
  Contralateral: Train acc: 0.7752, Val acc: 0.7573, Val F1: 0.7708
  Ipsilateral: Train acc: 0.9027, Val acc: 0.8517, Val F1: 0.8601
New best model saved (val_loss: 0.0982)
Epoch 16/100 - Time: 0.9s - Train loss: 0.0759, Val loss: 0.0970, Learning rate: 0.000100
  Multiclass: Train acc: 0.7130, Val acc: 0.6382, Val F1: 0.6362
  Contralateral: Train acc: 0.7867, Val acc: 0.7528, Val F1: 0.7683
  Ipsilateral: Train acc: 0.9162, Val acc: 0.8719, Val F1: 0.8749
New best model saved (val_loss: 0.0970)
Epoch 17 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 161.47it/s, loss=0.0753]
Epoch 17 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 133.72it/s, loss=0.0919]
Epoch 18 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.37it/s, loss=0.0728]
Epoch 18 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 120.51it/s, loss=0.0866]
Epoch 17/100 - Time: 0.8s - Train loss: 0.0753, Val loss: 0.0919, Learning rate: 0.000100
  Multiclass: Train acc: 0.7130, Val acc: 0.6562, Val F1: 0.6521
  Contralateral: Train acc: 0.7935, Val acc: 0.7596, Val F1: 0.7747
  Ipsilateral: Train acc: 0.9104, Val acc: 0.8831, Val F1: 0.8873
New best model saved (val_loss: 0.0919)
Epoch 18/100 - Time: 0.8s - Train loss: 0.0728, Val loss: 0.0866, Learning rate: 0.000100
  Multiclass: Train acc: 0.7246, Val acc: 0.6719, Val F1: 0.6695
  Contralateral: Train acc: 0.7978, Val acc: 0.7820, Val F1: 0.7943
  Ipsilateral: Train acc: 0.9182, Val acc: 0.8764, Val F1: 0.8826
New best model saved (val_loss: 0.0866)
Epoch 19 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.70it/s, loss=0.0674]
Epoch 19 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 111.01it/s, loss=0.0830]
Epoch 20 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.74it/s, loss=0.0651]
Epoch 20 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.44it/s, loss=0.0804]
Epoch 19/100 - Time: 0.9s - Train loss: 0.0674, Val loss: 0.0830, Learning rate: 0.000100
  Multiclass: Train acc: 0.7501, Val acc: 0.6831, Val F1: 0.6804
  Contralateral: Train acc: 0.8219, Val acc: 0.7820, Val F1: 0.7940
  Ipsilateral: Train acc: 0.9239, Val acc: 0.8831, Val F1: 0.8898
New best model saved (val_loss: 0.0830)
Epoch 21 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.89it/s, loss=0.0608]
Epoch 21 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 122.39it/s, loss=0.0772]
Epoch 20/100 - Time: 0.9s - Train loss: 0.0651, Val loss: 0.0804, Learning rate: 0.000100
  Multiclass: Train acc: 0.7646, Val acc: 0.6989, Val F1: 0.6971
  Contralateral: Train acc: 0.8373, Val acc: 0.8090, Val F1: 0.8173
  Ipsilateral: Train acc: 0.9244, Val acc: 0.8854, Val F1: 0.8926
New best model saved (val_loss: 0.0804)
Epoch 22 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.29it/s, loss=0.0586]
Epoch 22 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.09it/s, loss=0.0751]
Epoch 21/100 - Time: 0.8s - Train loss: 0.0608, Val loss: 0.0772, Learning rate: 0.000100
  Multiclass: Train acc: 0.7761, Val acc: 0.7169, Val F1: 0.7150
  Contralateral: Train acc: 0.8334, Val acc: 0.8157, Val F1: 0.8242
  Ipsilateral: Train acc: 0.9321, Val acc: 0.8899, Val F1: 0.8963
New best model saved (val_loss: 0.0772)
Epoch 22/100 - Time: 0.9s - Train loss: 0.0586, Val loss: 0.0751, Learning rate: 0.000100
  Multiclass: Train acc: 0.7829, Val acc: 0.7169, Val F1: 0.7162
  Contralateral: Train acc: 0.8498, Val acc: 0.8225, Val F1: 0.8308
  Ipsilateral: Train acc: 0.9364, Val acc: 0.8921, Val F1: 0.8967
New best model saved (val_loss: 0.0751)
Epoch 23 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.31it/s, loss=0.0552]
Epoch 23 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.14it/s, loss=0.0733]
Epoch 24 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.41it/s, loss=0.0536]
Epoch 24 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.54it/s, loss=0.0734]
Epoch 23/100 - Time: 0.9s - Train loss: 0.0552, Val loss: 0.0733, Learning rate: 0.000100
  Multiclass: Train acc: 0.7944, Val acc: 0.7303, Val F1: 0.7289
  Contralateral: Train acc: 0.8455, Val acc: 0.8270, Val F1: 0.8342
  Ipsilateral: Train acc: 0.9427, Val acc: 0.8854, Val F1: 0.8917
New best model saved (val_loss: 0.0733)
Epoch 24/100 - Time: 0.9s - Train loss: 0.0536, Val loss: 0.0734, Learning rate: 0.000100
  Multiclass: Train acc: 0.8098, Val acc: 0.7348, Val F1: 0.7357
  Contralateral: Train acc: 0.8613, Val acc: 0.8382, Val F1: 0.8456
  Ipsilateral: Train acc: 0.9374, Val acc: 0.9011, Val F1: 0.9043
Epoch 25 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 159.98it/s, loss=0.0501]
Epoch 25 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 117.41it/s, loss=0.0685]
Epoch 26 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.10it/s, loss=0.0490]
Epoch 26 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.83it/s, loss=0.0672]
Epoch 25/100 - Time: 0.8s - Train loss: 0.0501, Val loss: 0.0685, Learning rate: 0.000100
  Multiclass: Train acc: 0.8190, Val acc: 0.7461, Val F1: 0.7461
  Contralateral: Train acc: 0.8671, Val acc: 0.8427, Val F1: 0.8479
  Ipsilateral: Train acc: 0.9480, Val acc: 0.8989, Val F1: 0.9033
New best model saved (val_loss: 0.0685)
Epoch 27 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 161.48it/s, loss=0.0453]
Epoch 27 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 128.53it/s, loss=0.0657]
Epoch 26/100 - Time: 0.9s - Train loss: 0.0490, Val loss: 0.0672, Learning rate: 0.000100
  Multiclass: Train acc: 0.8223, Val acc: 0.7528, Val F1: 0.7527
  Contralateral: Train acc: 0.8772, Val acc: 0.8539, Val F1: 0.8589
  Ipsilateral: Train acc: 0.9470, Val acc: 0.9079, Val F1: 0.9116
New best model saved (val_loss: 0.0672)
Epoch 28 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.54it/s, loss=0.0425]
Epoch 28 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 121.64it/s, loss=0.0638]
Epoch 27/100 - Time: 0.8s - Train loss: 0.0453, Val loss: 0.0657, Learning rate: 0.000100
  Multiclass: Train acc: 0.8305, Val acc: 0.7483, Val F1: 0.7473
  Contralateral: Train acc: 0.8859, Val acc: 0.8517, Val F1: 0.8582
  Ipsilateral: Train acc: 0.9538, Val acc: 0.9056, Val F1: 0.9099
New best model saved (val_loss: 0.0657)
Epoch 29 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 159.17it/s, loss=0.0415]
Epoch 29 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 123.95it/s, loss=0.0634]
Epoch 28/100 - Time: 0.9s - Train loss: 0.0425, Val loss: 0.0638, Learning rate: 0.000100
  Multiclass: Train acc: 0.8536, Val acc: 0.7551, Val F1: 0.7545
  Contralateral: Train acc: 0.8936, Val acc: 0.8562, Val F1: 0.8623
  Ipsilateral: Train acc: 0.9552, Val acc: 0.9056, Val F1: 0.9105
New best model saved (val_loss: 0.0638)
Epoch 30 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 160.43it/s, loss=0.0428]
Epoch 30 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.69it/s, loss=0.0612]
Epoch 29/100 - Time: 0.8s - Train loss: 0.0415, Val loss: 0.0634, Learning rate: 0.000100
  Multiclass: Train acc: 0.8536, Val acc: 0.7708, Val F1: 0.7711
  Contralateral: Train acc: 0.8878, Val acc: 0.8562, Val F1: 0.8609
  Ipsilateral: Train acc: 0.9634, Val acc: 0.9101, Val F1: 0.9142
New best model saved (val_loss: 0.0634)
Epoch 31 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.60it/s, loss=0.0393]
Epoch 31 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 121.58it/s, loss=0.0599]
Epoch 30/100 - Time: 0.8s - Train loss: 0.0428, Val loss: 0.0612, Learning rate: 0.000100
  Multiclass: Train acc: 0.8488, Val acc: 0.7798, Val F1: 0.7798
  Contralateral: Train acc: 0.8941, Val acc: 0.8629, Val F1: 0.8673
  Ipsilateral: Train acc: 0.9494, Val acc: 0.9101, Val F1: 0.9147
New best model saved (val_loss: 0.0612)
Epoch 32 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.12it/s, loss=0.0376]
Epoch 32 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.20it/s, loss=0.0595]
Epoch 31/100 - Time: 0.9s - Train loss: 0.0393, Val loss: 0.0599, Learning rate: 0.000100
  Multiclass: Train acc: 0.8604, Val acc: 0.7910, Val F1: 0.7909
  Contralateral: Train acc: 0.8979, Val acc: 0.8652, Val F1: 0.8707
  Ipsilateral: Train acc: 0.9591, Val acc: 0.9169, Val F1: 0.9210
New best model saved (val_loss: 0.0599)
Epoch 33 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 159.15it/s, loss=0.0373]
Epoch 33 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 125.43it/s, loss=0.0601]
Epoch 32/100 - Time: 0.9s - Train loss: 0.0376, Val loss: 0.0595, Learning rate: 0.000100
  Multiclass: Train acc: 0.8652, Val acc: 0.7798, Val F1: 0.7790
  Contralateral: Train acc: 0.9066, Val acc: 0.8674, Val F1: 0.8732
  Ipsilateral: Train acc: 0.9562, Val acc: 0.9146, Val F1: 0.9190
New best model saved (val_loss: 0.0595)
Epoch 34 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.27it/s, loss=0.0352]
Epoch 34 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 127.40it/s, loss=0.0576]
Epoch 33/100 - Time: 0.8s - Train loss: 0.0373, Val loss: 0.0601, Learning rate: 0.000100
  Multiclass: Train acc: 0.8681, Val acc: 0.7798, Val F1: 0.7796
  Contralateral: Train acc: 0.9095, Val acc: 0.8719, Val F1: 0.8755
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9056, Val F1: 0.9112
Epoch 35 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.95it/s, loss=0.0335]
Epoch 35 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 121.70it/s, loss=0.0562]
Epoch 34/100 - Time: 0.8s - Train loss: 0.0352, Val loss: 0.0576, Learning rate: 0.000100
  Multiclass: Train acc: 0.8657, Val acc: 0.7888, Val F1: 0.7889
  Contralateral: Train acc: 0.9100, Val acc: 0.8764, Val F1: 0.8801
  Ipsilateral: Train acc: 0.9605, Val acc: 0.9236, Val F1: 0.9268
New best model saved (val_loss: 0.0576)
Epoch 36 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.95it/s, loss=0.0331]
Epoch 36 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 116.25it/s, loss=0.0555]
Epoch 35/100 - Time: 0.8s - Train loss: 0.0335, Val loss: 0.0562, Learning rate: 0.000100
  Multiclass: Train acc: 0.8854, Val acc: 0.8135, Val F1: 0.8139
  Contralateral: Train acc: 0.9186, Val acc: 0.8809, Val F1: 0.8857
  Ipsilateral: Train acc: 0.9682, Val acc: 0.9303, Val F1: 0.9327
New best model saved (val_loss: 0.0562)
Epoch 37 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.96it/s, loss=0.0319]
Epoch 37 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 127.18it/s, loss=0.0565]
Epoch 36/100 - Time: 0.9s - Train loss: 0.0331, Val loss: 0.0555, Learning rate: 0.000100
  Multiclass: Train acc: 0.8825, Val acc: 0.8202, Val F1: 0.8205
  Contralateral: Train acc: 0.9244, Val acc: 0.8899, Val F1: 0.8943
  Ipsilateral: Train acc: 0.9596, Val acc: 0.9303, Val F1: 0.9332
New best model saved (val_loss: 0.0555)
Epoch 38 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 159.76it/s, loss=0.0299]
Epoch 38 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 117.98it/s, loss=0.0570]
Epoch 37/100 - Time: 0.9s - Train loss: 0.0319, Val loss: 0.0565, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8112, Val F1: 0.8117
  Contralateral: Train acc: 0.9186, Val acc: 0.8876, Val F1: 0.8909
  Ipsilateral: Train acc: 0.9673, Val acc: 0.9213, Val F1: 0.9245
Epoch 39 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.61it/s, loss=0.0296]
Epoch 39 (Val):   0%|                             | 0/14 [00:00<?, ?it/s, loss=0.0600]
Epoch 38/100 - Time: 0.8s - Train loss: 0.0299, Val loss: 0.0570, Learning rate: 0.000100
  Multiclass: Train acc: 0.8926, Val acc: 0.8090, Val F1: 0.8092
  Contralateral: Train acc: 0.9225, Val acc: 0.8921, Val F1: 0.8955

Epoch 39 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 122.36it/s, loss=0.0588]
Epoch 40 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.67it/s, loss=0.0292]
Epoch 40 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 122.24it/s, loss=0.0564]
Epoch 39/100 - Time: 0.8s - Train loss: 0.0296, Val loss: 0.0588, Learning rate: 0.000100
  Multiclass: Train acc: 0.8902, Val acc: 0.8045, Val F1: 0.8050
  Contralateral: Train acc: 0.9307, Val acc: 0.8899, Val F1: 0.8927
  Ipsilateral: Train acc: 0.9682, Val acc: 0.9169, Val F1: 0.9210
Epoch 41 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.97it/s, loss=0.0285]
Epoch 41 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.09it/s, loss=0.0564]
Epoch 40/100 - Time: 0.9s - Train loss: 0.0292, Val loss: 0.0564, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8270, Val F1: 0.8277
  Contralateral: Train acc: 0.9230, Val acc: 0.8966, Val F1: 0.9001
  Ipsilateral: Train acc: 0.9668, Val acc: 0.9326, Val F1: 0.9345
Evaluating: 100%|████████████████████████████████████| 14/14 [00:00<00:00, 126.03it/s]
Epoch 41/100 - Time: 0.8s - Train loss: 0.0285, Val loss: 0.0564, Learning rate: 0.000100
  Multiclass: Train acc: 0.8960, Val acc: 0.8292, Val F1: 0.8296
  Contralateral: Train acc: 0.9278, Val acc: 0.9034, Val F1: 0.9069
  Ipsilateral: Train acc: 0.9653, Val acc: 0.9236, Val F1: 0.9261
Early stopping triggered after 41 epochs
Best model was at epoch 36
Training completed in 37.2s. Best validation loss: 0.0555
Loaded model from checkpoint (epoch 36)
Evaluating model on test set...
Multiclass Metrics:
  accuracy: 0.7960
  precision: 0.8191
  recall: 0.7960
  f1: 0.7994
Contralateral Metrics:
  accuracy: 0.8520
  precision: 0.8751
  recall: 0.8520
  f1: 0.8583
Ipsilateral Metrics:
  accuracy: 0.9327
  precision: 0.9379
  recall: 0.9327
  f1: 0.9346
Overall Accuracy: 0.8602
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Saved combined metrics to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/combined_metrics.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json