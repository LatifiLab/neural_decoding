WandB initialized successfully!
Starting training...
Starting training for lstm model...
Using device: cuda
Model parameters: 208,583 total, 208,583 trainable
Epoch 1/18 - Time: 1.2s - Train loss: 0.2617, Val loss: 0.2584, Learning rate: 0.000100
  Multiclass: Train acc: 0.3535, Val acc: 0.3758, Val F1: 0.3716
  Contralateral: Train acc: 0.4985, Val acc: 0.6398, Val F1: 0.3264
  Ipsilateral: Train acc: 0.6743, Val acc: 0.7450, Val F1: 0.1231
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2584)
Epoch 1 (Train): 100%|█████████████| 32/32 [00:00<00:00, 85.52it/s, loss=0.2617]
Epoch 1 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 63.85it/s, loss=0.2584]
Epoch 2 (Train): 100%|████████████| 32/32 [00:00<00:00, 123.02it/s, loss=0.2576]
Epoch 2 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 67.71it/s, loss=0.2554]
Epoch 2/18 - Time: 0.8s - Train loss: 0.2576, Val loss: 0.2554, Learning rate: 0.000100
  Multiclass: Train acc: 0.3687, Val acc: 0.4027, Val F1: 0.3992
  Contralateral: Train acc: 0.5405, Val acc: 0.6376, Val F1: 0.3955
  Ipsilateral: Train acc: 0.7056, Val acc: 0.7450, Val F1: 0.1231
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2554)
Validation score improved from 0.2584 to 0.2554
Epoch 3/18 - Time: 0.8s - Train loss: 0.2555, Val loss: 0.2526, Learning rate: 0.000100
  Multiclass: Train acc: 0.3770, Val acc: 0.4228, Val F1: 0.4181
  Contralateral: Train acc: 0.5938, Val acc: 0.6711, Val F1: 0.3797
  Ipsilateral: Train acc: 0.7188, Val acc: 0.7517, Val F1: 0.1260
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2526)
Validation score improved from 0.2554 to 0.2526
Epoch 4/18 - Time: 0.8s - Train loss: 0.2538, Val loss: 0.2501, Learning rate: 0.000100
  Multiclass: Train acc: 0.3794, Val acc: 0.4407, Val F1: 0.4389
  Contralateral: Train acc: 0.6040, Val acc: 0.6957, Val F1: 0.4035
  Ipsilateral: Train acc: 0.7246, Val acc: 0.7562, Val F1: 0.1138
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2501)
Validation score improved from 0.2526 to 0.2501
Epoch 3 (Train): 100%|████████████| 32/32 [00:00<00:00, 121.34it/s, loss=0.2555]
Epoch 3 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 66.09it/s, loss=0.2526]
Epoch 4 (Train): 100%|████████████| 32/32 [00:00<00:00, 120.30it/s, loss=0.2538]
Epoch 4 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 67.04it/s, loss=0.2501]
Epoch 5 (Train): 100%|████████████| 32/32 [00:00<00:00, 120.31it/s, loss=0.2510]
Epoch 5 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.28it/s, loss=0.2478]
Epoch 6 (Train): 100%|████████████| 32/32 [00:00<00:00, 120.55it/s, loss=0.2484]
Epoch 6 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.00it/s, loss=0.2451]
Epoch 7 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.22it/s, loss=0.2444]
Epoch 7 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 63.81it/s, loss=0.2418]
Epoch 5/18 - Time: 0.7s - Train loss: 0.2510, Val loss: 0.2478, Learning rate: 0.000100
  Multiclass: Train acc: 0.4121, Val acc: 0.4765, Val F1: 0.4717
  Contralateral: Train acc: 0.6050, Val acc: 0.6980, Val F1: 0.3779
  Ipsilateral: Train acc: 0.7314, Val acc: 0.7539, Val F1: 0.0678
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2478)
Validation score improved from 0.2501 to 0.2478
Epoch 6/18 - Time: 0.9s - Train loss: 0.2484, Val loss: 0.2451, Learning rate: 0.000100
  Multiclass: Train acc: 0.4248, Val acc: 0.5056, Val F1: 0.5034
  Contralateral: Train acc: 0.6548, Val acc: 0.7248, Val F1: 0.4000
  Ipsilateral: Train acc: 0.7236, Val acc: 0.7562, Val F1: 0.0840
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2451)
Validation score improved from 0.2478 to 0.2451
Epoch 8 (Train): 100%|████████████| 32/32 [00:00<00:00, 119.36it/s, loss=0.2414]
Epoch 8 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 66.26it/s, loss=0.2384]
Epoch 9 (Train): 100%|████████████| 32/32 [00:00<00:00, 119.38it/s, loss=0.2371]
Epoch 9 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.04it/s, loss=0.2340]
Epoch 10 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.45it/s, loss=0.2322]
Epoch 10 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.10it/s, loss=0.2286]
Epoch 7/18 - Time: 0.7s - Train loss: 0.2444, Val loss: 0.2418, Learning rate: 0.000100
  Multiclass: Train acc: 0.4360, Val acc: 0.5302, Val F1: 0.5306
  Contralateral: Train acc: 0.6807, Val acc: 0.7248, Val F1: 0.4058
  Ipsilateral: Train acc: 0.7324, Val acc: 0.7584, Val F1: 0.1000
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2418)
Validation score improved from 0.2451 to 0.2418
Epoch 8/18 - Time: 0.7s - Train loss: 0.2414, Val loss: 0.2384, Learning rate: 0.000100
  Multiclass: Train acc: 0.4790, Val acc: 0.5548, Val F1: 0.5552
  Contralateral: Train acc: 0.6704, Val acc: 0.7338, Val F1: 0.4465
  Ipsilateral: Train acc: 0.7480, Val acc: 0.7629, Val F1: 0.1311
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2384)
Validation score improved from 0.2418 to 0.2384
Epoch 9/18 - Time: 0.7s - Train loss: 0.2371, Val loss: 0.2340, Learning rate: 0.000100
  Multiclass: Train acc: 0.4863, Val acc: 0.6063, Val F1: 0.6085
  Contralateral: Train acc: 0.7031, Val acc: 0.7360, Val F1: 0.4434
  Ipsilateral: Train acc: 0.7368, Val acc: 0.7673, Val F1: 0.1746
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2340)
Validation score improved from 0.2384 to 0.2340
Epoch 11 (Train): 100%|███████████| 32/32 [00:00<00:00, 116.58it/s, loss=0.2244]
Epoch 11 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.91it/s, loss=0.2224]
Epoch 12 (Train): 100%|███████████| 32/32 [00:00<00:00, 118.33it/s, loss=0.2171]
Epoch 12 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.22it/s, loss=0.2141]
Epoch 13 (Train):  12%|█▋           | 4/32 [00:00<00:00, 39.87it/s, loss=0.2077]
Epoch 10/18 - Time: 0.7s - Train loss: 0.2322, Val loss: 0.2286, Learning rate: 0.000100
  Multiclass: Train acc: 0.5298, Val acc: 0.5928, Val F1: 0.5960
  Contralateral: Train acc: 0.7178, Val acc: 0.7383, Val F1: 0.4753
  Ipsilateral: Train acc: 0.7510, Val acc: 0.7740, Val F1: 0.2171
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2286)
Validation score improved from 0.2340 to 0.2286
Epoch 11/18 - Time: 0.8s - Train loss: 0.2244, Val loss: 0.2224, Learning rate: 0.000100
  Multiclass: Train acc: 0.5547, Val acc: 0.6040, Val F1: 0.6055
  Contralateral: Train acc: 0.7363, Val acc: 0.7472, Val F1: 0.5350
  Ipsilateral: Train acc: 0.7563, Val acc: 0.7808, Val F1: 0.2576
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2224)
Validation score improved from 0.2286 to 0.2224
Epoch 12/18 - Time: 0.8s - Train loss: 0.2171, Val loss: 0.2141, Learning rate: 0.000100
  Multiclass: Train acc: 0.5869, Val acc: 0.6107, Val F1: 0.6124
  Contralateral: Train acc: 0.7520, Val acc: 0.7673, Val F1: 0.5772
  Ipsilateral: Train acc: 0.7627, Val acc: 0.8009, Val F1: 0.3946
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2141)
Epoch 13 (Train): 100%|███████████| 32/32 [00:00<00:00, 119.09it/s, loss=0.2085]
Epoch 13 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.06it/s, loss=0.2054]
Epoch 14 (Train): 100%|███████████| 32/32 [00:00<00:00, 116.20it/s, loss=0.1990]
Epoch 14 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.45it/s, loss=0.1955]
Epoch 15 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.14it/s, loss=0.1882]
Epoch 15 (Val): 100%|████████████████| 7/7 [00:00<00:00, 63.60it/s, loss=0.1838]
Epoch 13/18 - Time: 0.9s - Train loss: 0.2085, Val loss: 0.2054, Learning rate: 0.000100
  Multiclass: Train acc: 0.6143, Val acc: 0.6421, Val F1: 0.6433
  Contralateral: Train acc: 0.7749, Val acc: 0.7808, Val F1: 0.6080
  Ipsilateral: Train acc: 0.7783, Val acc: 0.8076, Val F1: 0.4487
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2054)
Validation score improved from 0.2141 to 0.2054
Epoch 14/18 - Time: 0.8s - Train loss: 0.1990, Val loss: 0.1955, Learning rate: 0.000100
  Multiclass: Train acc: 0.6387, Val acc: 0.6667, Val F1: 0.6661
  Contralateral: Train acc: 0.7847, Val acc: 0.8031, Val F1: 0.6535
  Ipsilateral: Train acc: 0.7842, Val acc: 0.8076, Val F1: 0.4881
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1955)
Validation score improved from 0.2054 to 0.1955
Epoch 16 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.99it/s, loss=0.1740]
Epoch 16 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.98it/s, loss=0.1723]
Epoch 17 (Train): 100%|███████████| 32/32 [00:00<00:00, 119.62it/s, loss=0.1619]
Epoch 17 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.25it/s, loss=0.1599]
Epoch 18 (Train):  69%|███████▌   | 22/32 [00:00<00:00, 118.97it/s, loss=0.1469]
Epoch 15/18 - Time: 0.8s - Train loss: 0.1882, Val loss: 0.1838, Learning rate: 0.000100
  Multiclass: Train acc: 0.6616, Val acc: 0.6890, Val F1: 0.6878
  Contralateral: Train acc: 0.7983, Val acc: 0.8054, Val F1: 0.6667
  Ipsilateral: Train acc: 0.7920, Val acc: 0.8233, Val F1: 0.5907
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1838)
Validation score improved from 0.1955 to 0.1838
Epoch 16/18 - Time: 0.8s - Train loss: 0.1740, Val loss: 0.1723, Learning rate: 0.000100
  Multiclass: Train acc: 0.6914, Val acc: 0.6980, Val F1: 0.6975
  Contralateral: Train acc: 0.8242, Val acc: 0.8188, Val F1: 0.6798
  Ipsilateral: Train acc: 0.8066, Val acc: 0.8389, Val F1: 0.6697
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1723)
Validation score improved from 0.1838 to 0.1723
Epoch 17/18 - Time: 0.7s - Train loss: 0.1619, Val loss: 0.1599, Learning rate: 0.000100
  Multiclass: Train acc: 0.7251, Val acc: 0.7069, Val F1: 0.7063
  Contralateral: Train acc: 0.8345, Val acc: 0.8345, Val F1: 0.7087
  Ipsilateral: Train acc: 0.8252, Val acc: 0.8479, Val F1: 0.7069
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1599)
Epoch 18 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.25it/s, loss=0.1469]
Epoch 18 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.33it/s, loss=0.1476]
Evaluating: 100%|████████████████████| 8/8 [00:00<00:00, 70.55it/s, loss=0.3171]
Epoch 18/18 - Time: 0.7s - Train loss: 0.1469, Val loss: 0.1476, Learning rate: 0.000100
  Multiclass: Train acc: 0.7441, Val acc: 0.7360, Val F1: 0.7349
  Contralateral: Train acc: 0.8491, Val acc: 0.8389, Val F1: 0.7209
  Ipsilateral: Train acc: 0.8506, Val acc: 0.8591, Val F1: 0.7386
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1476)
Validation score improved from 0.1599 to 0.1476
Training completed in 14.3s. Best validation loss: 0.1476
Loaded model from checkpoint (epoch 18)
Evaluating model on test set...
Multiclass Test Metrics:
  accuracy: 0.7317
  precision: 0.7533
  recall: 0.7317
  f1: 0.7326
Contralateral Test Metrics:
  accuracy: 0.8714
  precision: 0.7652
  recall: 0.7891
  f1: 0.7769
Ipsilateral Test Metrics:
  accuracy: 0.8514
  precision: 0.6829
  recall: 0.7500
  f1: 0.7149
Overall Test Accuracy: 0.8182
Generating visualizations...
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json