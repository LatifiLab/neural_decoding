WandB initialized successfully!
Starting training for lstm model...
Using device: cuda
Model parameters: 71,111 total, 71,111 trainable
Epoch 1 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 109.65it/s, loss=0.6190]
Epoch 1 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 104.40it/s, loss=0.6231]
Epoch 1/100 - Time: 1.2s - Train loss: 0.6190, Val loss: 0.6231, Learning rate: 0.000100
  Multiclass: Train acc: 0.4449, Val acc: 0.4202, Val F1: 0.4100
  Contralateral: Train acc: 0.4974, Val acc: 0.6764, Val F1: 0.6575
  Ipsilateral: Train acc: 0.6172, Val acc: 0.7798, Val F1: 0.7144
New best model saved (val_loss: 0.6231)
Epoch 2 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.20it/s, loss=0.6167]
Epoch 2 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 97.06it/s, loss=0.6212]
Epoch 2/100 - Time: 1.0s - Train loss: 0.6167, Val loss: 0.6212, Learning rate: 0.000100
  Multiclass: Train acc: 0.4372, Val acc: 0.4292, Val F1: 0.4171
  Contralateral: Train acc: 0.7116, Val acc: 0.7506, Val F1: 0.6475
  Ipsilateral: Train acc: 0.8166, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6212)
Epoch 3 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 152.83it/s, loss=0.6144]
Epoch 3 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 108.13it/s, loss=0.6190]
Epoch 3/100 - Time: 0.8s - Train loss: 0.6144, Val loss: 0.6190, Learning rate: 0.000100
  Multiclass: Train acc: 0.4622, Val acc: 0.4180, Val F1: 0.4085
  Contralateral: Train acc: 0.7376, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6190)
Epoch 4 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.05it/s, loss=0.6116]
Epoch 4 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 99.36it/s, loss=0.6159]
Epoch 4/100 - Time: 0.9s - Train loss: 0.6116, Val loss: 0.6159, Learning rate: 0.000100
  Multiclass: Train acc: 0.4506, Val acc: 0.4090, Val F1: 0.4009
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6159)
Epoch 5 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 122.26it/s, loss=0.6075]
Epoch 5 (Val): 100%|█████████████████████| 14/14 [00:00<00:00, 93.16it/s, loss=0.6112]
Epoch 5/100 - Time: 1.0s - Train loss: 0.6075, Val loss: 0.6112, Learning rate: 0.000100
  Multiclass: Train acc: 0.4444, Val acc: 0.4449, Val F1: 0.4385
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6112)
Epoch 6/100 - Time: 0.9s - Train loss: 0.6000, Val loss: 0.6018, Learning rate: 0.000100
  Multiclass: Train acc: 0.4699, Val acc: 0.4742, Val F1: 0.4726
  Contralateral: Train acc: 0.7439, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6018)
Epoch 6 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.61it/s, loss=0.6000]
Epoch 6 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 109.87it/s, loss=0.6018]
Epoch 7 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 152.13it/s, loss=0.5829]
Epoch 7 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 111.84it/s, loss=0.5808]
Epoch 7/100 - Time: 0.9s - Train loss: 0.5829, Val loss: 0.5808, Learning rate: 0.000100
  Multiclass: Train acc: 0.5070, Val acc: 0.4854, Val F1: 0.4900
  Contralateral: Train acc: 0.7458, Val acc: 0.7596, Val F1: 0.6602
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5808)
Epoch 8 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 152.88it/s, loss=0.5467]
Epoch 8 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 111.27it/s, loss=0.5397]
Epoch 8/100 - Time: 0.9s - Train loss: 0.5467, Val loss: 0.5397, Learning rate: 0.000100
  Multiclass: Train acc: 0.5176, Val acc: 0.4831, Val F1: 0.4733
  Contralateral: Train acc: 0.7530, Val acc: 0.7483, Val F1: 0.7459
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5397)
Epoch 9 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 156.76it/s, loss=0.4851]
Epoch 9 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 116.18it/s, loss=0.4773]
Epoch 10 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.60it/s, loss=0.4090]
Epoch 10 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.91it/s, loss=0.4231]
Epoch 9/100 - Time: 0.9s - Train loss: 0.4851, Val loss: 0.4773, Learning rate: 0.000100
  Multiclass: Train acc: 0.5330, Val acc: 0.4966, Val F1: 0.4847
  Contralateral: Train acc: 0.7434, Val acc: 0.7011, Val F1: 0.7168
  Ipsilateral: Train acc: 0.8300, Val acc: 0.8180, Val F1: 0.8038
New best model saved (val_loss: 0.4773)
Epoch 10/100 - Time: 0.9s - Train loss: 0.4090, Val loss: 0.4231, Learning rate: 0.000100
  Multiclass: Train acc: 0.5648, Val acc: 0.5438, Val F1: 0.5400
  Contralateral: Train acc: 0.7232, Val acc: 0.7326, Val F1: 0.7433
  Ipsilateral: Train acc: 0.8435, Val acc: 0.8180, Val F1: 0.8281
New best model saved (val_loss: 0.4231)
Epoch 11 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 124.87it/s, loss=0.3518]
Epoch 11 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 97.08it/s, loss=0.3790]
Epoch 12 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 151.33it/s, loss=0.3146]
Epoch 12 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.13it/s, loss=0.3569]
Epoch 11/100 - Time: 1.0s - Train loss: 0.3518, Val loss: 0.3790, Learning rate: 0.000100
  Multiclass: Train acc: 0.6047, Val acc: 0.5820, Val F1: 0.5800
  Contralateral: Train acc: 0.7381, Val acc: 0.7258, Val F1: 0.7414
  Ipsilateral: Train acc: 0.8618, Val acc: 0.8449, Val F1: 0.8497
New best model saved (val_loss: 0.3790)
Epoch 13 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 145.93it/s, loss=0.2903]
Epoch 13 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 101.55it/s, loss=0.3342]
Epoch 12/100 - Time: 0.9s - Train loss: 0.3146, Val loss: 0.3569, Learning rate: 0.000100
  Multiclass: Train acc: 0.6365, Val acc: 0.6090, Val F1: 0.6082
  Contralateral: Train acc: 0.7477, Val acc: 0.7348, Val F1: 0.7504
  Ipsilateral: Train acc: 0.8792, Val acc: 0.8517, Val F1: 0.8548
New best model saved (val_loss: 0.3569)
Epoch 14 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.62it/s, loss=0.2714]
Epoch 14 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.70it/s, loss=0.3225]
Epoch 13/100 - Time: 0.9s - Train loss: 0.2903, Val loss: 0.3342, Learning rate: 0.000100
  Multiclass: Train acc: 0.6586, Val acc: 0.6112, Val F1: 0.6072
  Contralateral: Train acc: 0.7646, Val acc: 0.7393, Val F1: 0.7547
  Ipsilateral: Train acc: 0.8825, Val acc: 0.8562, Val F1: 0.8631
New best model saved (val_loss: 0.3342)
Epoch 15 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 148.43it/s, loss=0.2525]
Epoch 15 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 107.96it/s, loss=0.3040]
Epoch 14/100 - Time: 0.9s - Train loss: 0.2714, Val loss: 0.3225, Learning rate: 0.000100
  Multiclass: Train acc: 0.6721, Val acc: 0.6112, Val F1: 0.6087
  Contralateral: Train acc: 0.7824, Val acc: 0.7438, Val F1: 0.7586
  Ipsilateral: Train acc: 0.8965, Val acc: 0.8629, Val F1: 0.8676
New best model saved (val_loss: 0.3225)
Epoch 16 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 149.07it/s, loss=0.2294]
Epoch 16 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.21it/s, loss=0.2992]
Epoch 15/100 - Time: 0.9s - Train loss: 0.2525, Val loss: 0.3040, Learning rate: 0.000100
  Multiclass: Train acc: 0.7025, Val acc: 0.6292, Val F1: 0.6270
  Contralateral: Train acc: 0.7805, Val acc: 0.7551, Val F1: 0.7685
  Ipsilateral: Train acc: 0.9061, Val acc: 0.8539, Val F1: 0.8620
New best model saved (val_loss: 0.3040)
Epoch 17 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.20it/s, loss=0.2286]
Epoch 17 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.16it/s, loss=0.2809]
Epoch 16/100 - Time: 0.9s - Train loss: 0.2294, Val loss: 0.2992, Learning rate: 0.000100
  Multiclass: Train acc: 0.7183, Val acc: 0.6337, Val F1: 0.6333
  Contralateral: Train acc: 0.7891, Val acc: 0.7573, Val F1: 0.7713
  Ipsilateral: Train acc: 0.9138, Val acc: 0.8719, Val F1: 0.8744
New best model saved (val_loss: 0.2992)
Epoch 18 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 152.03it/s, loss=0.2219]
Epoch 18 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.43it/s, loss=0.2629]
Epoch 17/100 - Time: 0.9s - Train loss: 0.2286, Val loss: 0.2809, Learning rate: 0.000100
  Multiclass: Train acc: 0.7183, Val acc: 0.6562, Val F1: 0.6551
  Contralateral: Train acc: 0.7978, Val acc: 0.7573, Val F1: 0.7721
  Ipsilateral: Train acc: 0.9172, Val acc: 0.8854, Val F1: 0.8876
New best model saved (val_loss: 0.2809)
Epoch 19 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 152.83it/s, loss=0.2070]
Epoch 19 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.10it/s, loss=0.2528]
Epoch 18/100 - Time: 0.9s - Train loss: 0.2219, Val loss: 0.2629, Learning rate: 0.000100
  Multiclass: Train acc: 0.7318, Val acc: 0.6629, Val F1: 0.6613
  Contralateral: Train acc: 0.7997, Val acc: 0.7820, Val F1: 0.7932
  Ipsilateral: Train acc: 0.9196, Val acc: 0.8787, Val F1: 0.8838
New best model saved (val_loss: 0.2629)
Epoch 20 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.73it/s, loss=0.2004]
Epoch 20 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.31it/s, loss=0.2433]
Epoch 19/100 - Time: 0.8s - Train loss: 0.2070, Val loss: 0.2528, Learning rate: 0.000100
  Multiclass: Train acc: 0.7593, Val acc: 0.6787, Val F1: 0.6774
  Contralateral: Train acc: 0.8243, Val acc: 0.7978, Val F1: 0.8067
  Ipsilateral: Train acc: 0.9254, Val acc: 0.8809, Val F1: 0.8875
New best model saved (val_loss: 0.2528)
Epoch 21 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 154.68it/s, loss=0.1854]
Epoch 21 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.52it/s, loss=0.2358]
Epoch 20/100 - Time: 0.9s - Train loss: 0.2004, Val loss: 0.2433, Learning rate: 0.000100
  Multiclass: Train acc: 0.7727, Val acc: 0.6944, Val F1: 0.6928
  Contralateral: Train acc: 0.8382, Val acc: 0.8045, Val F1: 0.8130
  Ipsilateral: Train acc: 0.9292, Val acc: 0.8854, Val F1: 0.8917
New best model saved (val_loss: 0.2433)
Epoch 22 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.13it/s, loss=0.1823]
Epoch 22 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 111.22it/s, loss=0.2340]
Epoch 21/100 - Time: 0.9s - Train loss: 0.1854, Val loss: 0.2358, Learning rate: 0.000100
  Multiclass: Train acc: 0.7824, Val acc: 0.6989, Val F1: 0.6976
  Contralateral: Train acc: 0.8334, Val acc: 0.8067, Val F1: 0.8153
  Ipsilateral: Train acc: 0.9398, Val acc: 0.8876, Val F1: 0.8940
New best model saved (val_loss: 0.2358)
Epoch 23 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 139.62it/s, loss=0.1723]
Epoch 23 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.04it/s, loss=0.2225]
Epoch 22/100 - Time: 0.9s - Train loss: 0.1823, Val loss: 0.2340, Learning rate: 0.000100
  Multiclass: Train acc: 0.7910, Val acc: 0.7236, Val F1: 0.7244
  Contralateral: Train acc: 0.8498, Val acc: 0.8180, Val F1: 0.8256
  Ipsilateral: Train acc: 0.9446, Val acc: 0.9056, Val F1: 0.9087
New best model saved (val_loss: 0.2340)
Epoch 24 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.53it/s, loss=0.1656]
Epoch 24 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 109.81it/s, loss=0.2184]
Epoch 23/100 - Time: 0.9s - Train loss: 0.1723, Val loss: 0.2225, Learning rate: 0.000100
  Multiclass: Train acc: 0.8012, Val acc: 0.7236, Val F1: 0.7231
  Contralateral: Train acc: 0.8507, Val acc: 0.8225, Val F1: 0.8289
  Ipsilateral: Train acc: 0.9427, Val acc: 0.8899, Val F1: 0.8960
New best model saved (val_loss: 0.2225)
Epoch 25 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 151.49it/s, loss=0.1563]
Epoch 25 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.10it/s, loss=0.2087]
Epoch 24/100 - Time: 0.9s - Train loss: 0.1656, Val loss: 0.2184, Learning rate: 0.000100
  Multiclass: Train acc: 0.8170, Val acc: 0.7303, Val F1: 0.7312
  Contralateral: Train acc: 0.8652, Val acc: 0.8360, Val F1: 0.8419
  Ipsilateral: Train acc: 0.9403, Val acc: 0.9034, Val F1: 0.9066
New best model saved (val_loss: 0.2184)
Epoch 26 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 151.77it/s, loss=0.1522]
Epoch 26 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.51it/s, loss=0.2035]
Epoch 25/100 - Time: 0.9s - Train loss: 0.1563, Val loss: 0.2087, Learning rate: 0.000100
  Multiclass: Train acc: 0.8238, Val acc: 0.7371, Val F1: 0.7379
  Contralateral: Train acc: 0.8705, Val acc: 0.8337, Val F1: 0.8392
  Ipsilateral: Train acc: 0.9480, Val acc: 0.9011, Val F1: 0.9050
New best model saved (val_loss: 0.2087)
Epoch 27 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.06it/s, loss=0.1411]
Epoch 27 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.77it/s, loss=0.1940]
Epoch 26/100 - Time: 0.9s - Train loss: 0.1522, Val loss: 0.2035, Learning rate: 0.000100
  Multiclass: Train acc: 0.8320, Val acc: 0.7416, Val F1: 0.7421
  Contralateral: Train acc: 0.8792, Val acc: 0.8382, Val F1: 0.8425
  Ipsilateral: Train acc: 0.9519, Val acc: 0.9011, Val F1: 0.9053
New best model saved (val_loss: 0.2035)
Epoch 28 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 154.73it/s, loss=0.1347]
Epoch 28 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.60it/s, loss=0.1887]
Epoch 27/100 - Time: 0.9s - Train loss: 0.1411, Val loss: 0.1940, Learning rate: 0.000100
  Multiclass: Train acc: 0.8382, Val acc: 0.7551, Val F1: 0.7549
  Contralateral: Train acc: 0.8893, Val acc: 0.8494, Val F1: 0.8554
  Ipsilateral: Train acc: 0.9547, Val acc: 0.9101, Val F1: 0.9139
New best model saved (val_loss: 0.1940)
Epoch 29 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 137.72it/s, loss=0.1309]
Epoch 29 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 103.21it/s, loss=0.1875]
Epoch 28/100 - Time: 2.2s - Train loss: 0.1347, Val loss: 0.1887, Learning rate: 0.000100
  Multiclass: Train acc: 0.8575, Val acc: 0.7528, Val F1: 0.7525
  Contralateral: Train acc: 0.8955, Val acc: 0.8517, Val F1: 0.8575
  Ipsilateral: Train acc: 0.9562, Val acc: 0.9101, Val F1: 0.9139
New best model saved (val_loss: 0.1887)
Epoch 30 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 146.91it/s, loss=0.1362]
Epoch 30 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 95.61it/s, loss=0.1825]
Epoch 29/100 - Time: 1.0s - Train loss: 0.1309, Val loss: 0.1875, Learning rate: 0.000100
  Multiclass: Train acc: 0.8560, Val acc: 0.7753, Val F1: 0.7757
  Contralateral: Train acc: 0.8922, Val acc: 0.8584, Val F1: 0.8633
  Ipsilateral: Train acc: 0.9620, Val acc: 0.9146, Val F1: 0.9176
New best model saved (val_loss: 0.1875)
Epoch 31 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 130.23it/s, loss=0.1244]
Epoch 31 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.88it/s, loss=0.1772]
Epoch 30/100 - Time: 0.9s - Train loss: 0.1362, Val loss: 0.1825, Learning rate: 0.000100
  Multiclass: Train acc: 0.8551, Val acc: 0.7798, Val F1: 0.7801
  Contralateral: Train acc: 0.8941, Val acc: 0.8629, Val F1: 0.8673
  Ipsilateral: Train acc: 0.9538, Val acc: 0.9101, Val F1: 0.9136
New best model saved (val_loss: 0.1825)
Epoch 32 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 137.82it/s, loss=0.1202]
Epoch 32 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 109.89it/s, loss=0.1747]
Epoch 31/100 - Time: 1.0s - Train loss: 0.1244, Val loss: 0.1772, Learning rate: 0.000100
  Multiclass: Train acc: 0.8633, Val acc: 0.7843, Val F1: 0.7841
  Contralateral: Train acc: 0.8970, Val acc: 0.8652, Val F1: 0.8704
  Ipsilateral: Train acc: 0.9567, Val acc: 0.9191, Val F1: 0.9230
New best model saved (val_loss: 0.1772)
Epoch 33 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 137.95it/s, loss=0.1194]
Epoch 33 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.92it/s, loss=0.1775]
Epoch 32/100 - Time: 0.9s - Train loss: 0.1202, Val loss: 0.1747, Learning rate: 0.000100
  Multiclass: Train acc: 0.8662, Val acc: 0.7888, Val F1: 0.7885
  Contralateral: Train acc: 0.9071, Val acc: 0.8674, Val F1: 0.8734
  Ipsilateral: Train acc: 0.9581, Val acc: 0.9146, Val F1: 0.9182
New best model saved (val_loss: 0.1747)
Epoch 34 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.94it/s, loss=0.1138]
Epoch 34 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 111.50it/s, loss=0.1724]
Epoch 33/100 - Time: 0.9s - Train loss: 0.1194, Val loss: 0.1775, Learning rate: 0.000100
  Multiclass: Train acc: 0.8710, Val acc: 0.7910, Val F1: 0.7911
  Contralateral: Train acc: 0.9071, Val acc: 0.8719, Val F1: 0.8755
  Ipsilateral: Train acc: 0.9620, Val acc: 0.9101, Val F1: 0.9150
Epoch 35 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 151.39it/s, loss=0.1086]
Epoch 35 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 119.32it/s, loss=0.1678]
Epoch 34/100 - Time: 0.9s - Train loss: 0.1138, Val loss: 0.1724, Learning rate: 0.000100
  Multiclass: Train acc: 0.8734, Val acc: 0.8000, Val F1: 0.8003
  Contralateral: Train acc: 0.9119, Val acc: 0.8787, Val F1: 0.8822
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9258, Val F1: 0.9289
New best model saved (val_loss: 0.1724)
Epoch 36 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 150.79it/s, loss=0.1068]
Epoch 36 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 108.89it/s, loss=0.1644]
Epoch 35/100 - Time: 0.9s - Train loss: 0.1086, Val loss: 0.1678, Learning rate: 0.000100
  Multiclass: Train acc: 0.8859, Val acc: 0.8157, Val F1: 0.8162
  Contralateral: Train acc: 0.9162, Val acc: 0.8854, Val F1: 0.8895
  Ipsilateral: Train acc: 0.9673, Val acc: 0.9258, Val F1: 0.9284
New best model saved (val_loss: 0.1678)
Epoch 37 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 152.20it/s, loss=0.1022]
Epoch 37 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 117.43it/s, loss=0.1660]
Epoch 36/100 - Time: 0.9s - Train loss: 0.1068, Val loss: 0.1644, Learning rate: 0.000100
  Multiclass: Train acc: 0.8931, Val acc: 0.8225, Val F1: 0.8229
  Contralateral: Train acc: 0.9234, Val acc: 0.8921, Val F1: 0.8961
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9236, Val F1: 0.9263
New best model saved (val_loss: 0.1644)
Epoch 38 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 151.88it/s, loss=0.0955]
Epoch 38 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.70it/s, loss=0.1682]
Epoch 37/100 - Time: 0.9s - Train loss: 0.1022, Val loss: 0.1660, Learning rate: 0.000100
  Multiclass: Train acc: 0.8946, Val acc: 0.8157, Val F1: 0.8162
  Contralateral: Train acc: 0.9182, Val acc: 0.8899, Val F1: 0.8932
  Ipsilateral: Train acc: 0.9726, Val acc: 0.9236, Val F1: 0.9266
Epoch 39 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 149.51it/s, loss=0.0962]
Epoch 39 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.21it/s, loss=0.1677]
Epoch 38/100 - Time: 0.9s - Train loss: 0.0955, Val loss: 0.1682, Learning rate: 0.000100
  Multiclass: Train acc: 0.9003, Val acc: 0.8157, Val F1: 0.8160
  Contralateral: Train acc: 0.9215, Val acc: 0.8966, Val F1: 0.9001
  Ipsilateral: Train acc: 0.9716, Val acc: 0.9191, Val F1: 0.9230
Epoch 40 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.98it/s, loss=0.0939]
Epoch 40 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 117.48it/s, loss=0.1651]
Epoch 39/100 - Time: 0.9s - Train loss: 0.0962, Val loss: 0.1677, Learning rate: 0.000100
  Multiclass: Train acc: 0.8974, Val acc: 0.8090, Val F1: 0.8095
  Contralateral: Train acc: 0.9312, Val acc: 0.8831, Val F1: 0.8860
  Ipsilateral: Train acc: 0.9697, Val acc: 0.9213, Val F1: 0.9250
Epoch 41 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 150.87it/s, loss=0.0934]
Epoch 41 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 102.23it/s, loss=0.1661]
Epoch 40/100 - Time: 0.9s - Train loss: 0.0939, Val loss: 0.1651, Learning rate: 0.000100
  Multiclass: Train acc: 0.8950, Val acc: 0.8270, Val F1: 0.8276
  Contralateral: Train acc: 0.9244, Val acc: 0.8966, Val F1: 0.8996
  Ipsilateral: Train acc: 0.9682, Val acc: 0.9303, Val F1: 0.9325
Evaluating: 100%|████████████████████████████████████| 14/14 [00:00<00:00, 113.94it/s]
Epoch 41/100 - Time: 0.9s - Train loss: 0.0934, Val loss: 0.1661, Learning rate: 0.000100
  Multiclass: Train acc: 0.8950, Val acc: 0.8360, Val F1: 0.8364
  Contralateral: Train acc: 0.9249, Val acc: 0.8989, Val F1: 0.9027
  Ipsilateral: Train acc: 0.9687, Val acc: 0.9303, Val F1: 0.9322
Early stopping triggered after 41 epochs
Best model was at epoch 36
Training completed in 38.9s. Best validation loss: 0.1644
Loaded model from checkpoint (epoch 36)
Evaluating model on test set...
Multiclass Metrics:
  accuracy: 0.8049
  precision: 0.8248
  recall: 0.8049
  f1: 0.8081
Contralateral Metrics:
  accuracy: 0.8632
  precision: 0.8814
  recall: 0.8632
  f1: 0.8683
Ipsilateral Metrics:
  accuracy: 0.9350
  precision: 0.9394
  recall: 0.9350
  f1: 0.9366
Overall Accuracy: 0.8677
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Saved combined metrics to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/combined_metrics.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json