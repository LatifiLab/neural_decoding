WandB initialized successfully!
Starting training...
Starting training for lstm model...
Using device: cuda
Model parameters: 205,511 total, 205,511 trainable
Epoch 1/18 - Time: 1.2s - Train loss: 0.2621, Val loss: 0.2565, Learning rate: 0.000100
  Multiclass: Train acc: 0.2666, Val acc: 0.2841, Val F1: 0.2455
  Contralateral: Train acc: 0.6250, Val acc: 0.7248, Val F1: 0.0465
  Ipsilateral: Train acc: 0.4839, Val acc: 0.6555, Val F1: 0.2300
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2565)
Epoch 1 (Train): 100%|█████████████| 32/32 [00:00<00:00, 85.20it/s, loss=0.2621]
Epoch 1 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 66.99it/s, loss=0.2565]
Epoch 2 (Train): 100%|████████████| 32/32 [00:00<00:00, 121.55it/s, loss=0.2576]
Epoch 2 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 68.41it/s, loss=0.2538]
Epoch 2/18 - Time: 0.7s - Train loss: 0.2576, Val loss: 0.2538, Learning rate: 0.000100
  Multiclass: Train acc: 0.3032, Val acc: 0.3043, Val F1: 0.2525
  Contralateral: Train acc: 0.6504, Val acc: 0.7338, Val F1: 0.1314
  Ipsilateral: Train acc: 0.5410, Val acc: 0.6622, Val F1: 0.2977
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2538)
Validation score improved from 0.2565 to 0.2538
Epoch 3/18 - Time: 0.7s - Train loss: 0.2539, Val loss: 0.2509, Learning rate: 0.000100
  Multiclass: Train acc: 0.3242, Val acc: 0.3468, Val F1: 0.3013
  Contralateral: Train acc: 0.6523, Val acc: 0.7450, Val F1: 0.1493
  Ipsilateral: Train acc: 0.6143, Val acc: 0.7069, Val F1: 0.2762
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2509)
Validation score improved from 0.2538 to 0.2509
Epoch 4/18 - Time: 0.7s - Train loss: 0.2501, Val loss: 0.2481, Learning rate: 0.000100
  Multiclass: Train acc: 0.3511, Val acc: 0.3915, Val F1: 0.3413
  Contralateral: Train acc: 0.6885, Val acc: 0.7383, Val F1: 0.1333
  Ipsilateral: Train acc: 0.6636, Val acc: 0.7338, Val F1: 0.2420
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2481)
Validation score improved from 0.2509 to 0.2481
Epoch 3 (Train): 100%|████████████| 32/32 [00:00<00:00, 121.44it/s, loss=0.2539]
Epoch 3 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 67.19it/s, loss=0.2509]
Epoch 4 (Train): 100%|████████████| 32/32 [00:00<00:00, 117.92it/s, loss=0.2501]
Epoch 4 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 66.43it/s, loss=0.2481]
Epoch 5 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.75it/s, loss=0.2472]
Epoch 5 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 66.61it/s, loss=0.2455]
Epoch 6 (Train): 100%|████████████| 32/32 [00:00<00:00, 119.64it/s, loss=0.2430]
Epoch 6 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.32it/s, loss=0.2422]
Epoch 7 (Train): 100%|████████████| 32/32 [00:00<00:00, 117.07it/s, loss=0.2403]
Epoch 7 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.13it/s, loss=0.2382]
Epoch 5/18 - Time: 0.7s - Train loss: 0.2472, Val loss: 0.2455, Learning rate: 0.000100
  Multiclass: Train acc: 0.3711, Val acc: 0.4139, Val F1: 0.3673
  Contralateral: Train acc: 0.7100, Val acc: 0.7494, Val F1: 0.1884
  Ipsilateral: Train acc: 0.6914, Val acc: 0.7450, Val F1: 0.2400
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2455)
Validation score improved from 0.2481 to 0.2455
Epoch 6/18 - Time: 0.9s - Train loss: 0.2430, Val loss: 0.2422, Learning rate: 0.000100
  Multiclass: Train acc: 0.3838, Val acc: 0.4407, Val F1: 0.3977
  Contralateral: Train acc: 0.7114, Val acc: 0.7405, Val F1: 0.1714
  Ipsilateral: Train acc: 0.7153, Val acc: 0.7606, Val F1: 0.2721
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2422)
Validation score improved from 0.2455 to 0.2422
Epoch 8 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.46it/s, loss=0.2346]
Epoch 8 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 59.55it/s, loss=0.2333]
Epoch 9 (Train): 100%|████████████| 32/32 [00:00<00:00, 117.96it/s, loss=0.2280]
Epoch 9 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.63it/s, loss=0.2274]
Epoch 10 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.16it/s, loss=0.2203]
Epoch 10 (Val):   0%|                        | 0/7 [00:00<?, ?it/s, loss=0.2207]
Epoch 7/18 - Time: 0.8s - Train loss: 0.2403, Val loss: 0.2382, Learning rate: 0.000100
  Multiclass: Train acc: 0.4077, Val acc: 0.4676, Val F1: 0.4299
  Contralateral: Train acc: 0.7031, Val acc: 0.7427, Val F1: 0.2177
  Ipsilateral: Train acc: 0.7368, Val acc: 0.7629, Val F1: 0.2933
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2382)
Validation score improved from 0.2422 to 0.2382
Epoch 8/18 - Time: 0.8s - Train loss: 0.2346, Val loss: 0.2333, Learning rate: 0.000100
  Multiclass: Train acc: 0.4492, Val acc: 0.4698, Val F1: 0.4301
  Contralateral: Train acc: 0.7261, Val acc: 0.7405, Val F1: 0.2368
  Ipsilateral: Train acc: 0.7441, Val acc: 0.7696, Val F1: 0.3681
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2333)
Validation score improved from 0.2382 to 0.2333
Epoch 9/18 - Time: 0.7s - Train loss: 0.2280, Val loss: 0.2274, Learning rate: 0.000100
  Multiclass: Train acc: 0.4697, Val acc: 0.4743, Val F1: 0.4315
  Contralateral: Train acc: 0.7300, Val acc: 0.7450, Val F1: 0.3523
  Ipsilateral: Train acc: 0.7681, Val acc: 0.7763, Val F1: 0.4118
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2274)
Validation score improved from 0.2333 to 0.2274
Epoch 10/18 - Time: 0.8s - Train loss: 0.2203, Val loss: 0.2207, Learning rate: 0.000100
  Multiclass: Train acc: 0.4980, Val acc: 0.4944, Val F1: 0.4611
  Contralateral: Train acc: 0.7480, Val acc: 0.7450, Val F1: 0.4000
  Ipsilateral: Train acc: 0.7803, Val acc: 0.8143, Val F1: 0.5654
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2207)
Validation score improved from 0.2274 to 0.2207
Epoch 11/18 - Time: 0.7s - Train loss: 0.2119, Val loss: 0.2127, Learning rate: 0.000100
  Multiclass: Train acc: 0.5103, Val acc: 0.4989, Val F1: 0.4561
  Contralateral: Train acc: 0.7593, Val acc: 0.7539, Val F1: 0.4907
  Ipsilateral: Train acc: 0.7788, Val acc: 0.8345, Val F1: 0.6476
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2127)
Validation score improved from 0.2207 to 0.2127
Epoch 12/18 - Time: 0.8s - Train loss: 0.2036, Val loss: 0.2056, Learning rate: 0.000100
  Multiclass: Train acc: 0.5283, Val acc: 0.5078, Val F1: 0.4701
  Contralateral: Train acc: 0.7573, Val acc: 0.7405, Val F1: 0.4957
  Ipsilateral: Train acc: 0.7944, Val acc: 0.8300, Val F1: 0.6724
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2056)
Epoch 10 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.91it/s, loss=0.2207]
Epoch 11 (Train): 100%|███████████| 32/32 [00:00<00:00, 121.15it/s, loss=0.2119]
Epoch 11 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.27it/s, loss=0.2127]
Epoch 12 (Train): 100%|███████████| 32/32 [00:00<00:00, 119.04it/s, loss=0.2036]
Epoch 12 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.53it/s, loss=0.2056]
Epoch 13 (Train):  12%|█▋           | 4/32 [00:00<00:00, 39.99it/s, loss=0.1935]
Epoch 13/18 - Time: 0.9s - Train loss: 0.1920, Val loss: 0.1968, Learning rate: 0.000100
  Multiclass: Train acc: 0.5435, Val acc: 0.5257, Val F1: 0.4919
  Contralateral: Train acc: 0.7661, Val acc: 0.7405, Val F1: 0.5360
  Ipsilateral: Train acc: 0.7969, Val acc: 0.8389, Val F1: 0.7049
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1968)
Validation score improved from 0.2056 to 0.1968
Epoch 14/18 - Time: 0.8s - Train loss: 0.1830, Val loss: 0.1897, Learning rate: 0.000100
  Multiclass: Train acc: 0.5737, Val acc: 0.5436, Val F1: 0.5157
  Contralateral: Train acc: 0.7866, Val acc: 0.7248, Val F1: 0.5323
  Ipsilateral: Train acc: 0.8208, Val acc: 0.8300, Val F1: 0.7031
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1897)
Epoch 13 (Train): 100%|███████████| 32/32 [00:00<00:00, 119.53it/s, loss=0.1920]
Epoch 13 (Val): 100%|████████████████| 7/7 [00:00<00:00, 65.12it/s, loss=0.1968]
Epoch 14 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.48it/s, loss=0.1830]
Epoch 14 (Val): 100%|████████████████| 7/7 [00:00<00:00, 63.66it/s, loss=0.1897]
Epoch 15 (Train): 100%|███████████| 32/32 [00:00<00:00, 115.32it/s, loss=0.1733]
Epoch 15 (Val): 100%|████████████████| 7/7 [00:00<00:00, 62.85it/s, loss=0.1831]
Epoch 15/18 - Time: 0.8s - Train loss: 0.1733, Val loss: 0.1831, Learning rate: 0.000100
  Multiclass: Train acc: 0.6016, Val acc: 0.5548, Val F1: 0.5339
  Contralateral: Train acc: 0.7817, Val acc: 0.7427, Val F1: 0.5490
  Ipsilateral: Train acc: 0.8325, Val acc: 0.8300, Val F1: 0.7099
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1831)
Validation score improved from 0.1897 to 0.1831
Epoch 16/18 - Time: 0.8s - Train loss: 0.1636, Val loss: 0.1755, Learning rate: 0.000100
  Multiclass: Train acc: 0.6167, Val acc: 0.5682, Val F1: 0.5464
  Contralateral: Train acc: 0.7822, Val acc: 0.7472, Val F1: 0.5637
  Ipsilateral: Train acc: 0.8418, Val acc: 0.8300, Val F1: 0.7185
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1755)
Validation score improved from 0.1831 to 0.1755
Epoch 17/18 - Time: 0.8s - Train loss: 0.1560, Val loss: 0.1704, Learning rate: 0.000100
  Multiclass: Train acc: 0.6304, Val acc: 0.5951, Val F1: 0.5817
  Contralateral: Train acc: 0.7900, Val acc: 0.7494, Val F1: 0.5659
  Ipsilateral: Train acc: 0.8394, Val acc: 0.8389, Val F1: 0.7372
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1704)
Validation score improved from 0.1755 to 0.1704
Epoch 16 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.35it/s, loss=0.1636]
Epoch 16 (Val): 100%|████████████████| 7/7 [00:00<00:00, 63.81it/s, loss=0.1755]
Epoch 17 (Train): 100%|███████████| 32/32 [00:00<00:00, 120.38it/s, loss=0.1560]
Epoch 17 (Val): 100%|████████████████| 7/7 [00:00<00:00, 64.76it/s, loss=0.1704]
Epoch 18 (Train): 100%|███████████| 32/32 [00:00<00:00, 117.70it/s, loss=0.1463]
Epoch 18 (Val): 100%|████████████████| 7/7 [00:00<00:00, 61.40it/s, loss=0.1641]
Evaluating: 100%|████████████████████| 8/8 [00:00<00:00, 70.22it/s, loss=0.1573]
Epoch 18/18 - Time: 0.8s - Train loss: 0.1463, Val loss: 0.1641, Learning rate: 0.000100
  Multiclass: Train acc: 0.6704, Val acc: 0.6376, Val F1: 0.6311
  Contralateral: Train acc: 0.8052, Val acc: 0.7450, Val F1: 0.5682
  Ipsilateral: Train acc: 0.8555, Val acc: 0.8591, Val F1: 0.7623
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1641)
Validation score improved from 0.1704 to 0.1641
Training completed in 14.4s. Best validation loss: 0.1641
Loaded model from checkpoint (epoch 18)
Evaluating model on test set...
Multiclass Test Metrics:
  accuracy: 0.6563
  precision: 0.7231
  recall: 0.6563
  f1: 0.6470
Contralateral Test Metrics:
  accuracy: 0.7761
  precision: 0.5541
  recall: 0.7373
  f1: 0.6327
Ipsilateral Test Metrics:
  accuracy: 0.8226
  precision: 0.6013
  recall: 0.8482
  f1: 0.7037
Overall Test Accuracy: 0.7517
Generating visualizations...
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json