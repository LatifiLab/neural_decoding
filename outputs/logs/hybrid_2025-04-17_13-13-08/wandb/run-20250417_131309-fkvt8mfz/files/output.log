WandB initialized successfully!
Starting training...
Starting training for hybrid model...
Using device: cuda
Model parameters: 4,529,553 total, 4,529,553 trainable
Epoch 1 (Train): 100%|█████████████| 64/64 [00:01<00:00, 48.78it/s, loss=9.3113]
Epoch 1 (Val): 100%|███████████████| 14/14 [00:00<00:00, 85.18it/s, loss=5.7386]
Epoch 2 (Train): 100%|█████████████| 64/64 [00:01<00:00, 59.31it/s, loss=8.2250]
Epoch 2 (Val): 100%|███████████████| 14/14 [00:00<00:00, 92.36it/s, loss=5.4265]
Epoch 1/100 - Time: 2.2s - Train loss: 9.3113, Val loss: 5.7386, Learning rate: 0.000004
  Multiclass: Train acc: 0.3462, Val acc: 0.3567, Val F1: 0.3692
  Contralateral: Train acc: 0.5337, Val acc: 0.5666, Val F1: 0.3287
  Ipsilateral: Train acc: 0.4067, Val acc: 0.3995, Val F1: 0.2692
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 5.7386)
Epoch 3 (Train): 100%|█████████████| 64/64 [00:01<00:00, 59.24it/s, loss=7.7545]
Epoch 3 (Val): 100%|███████████████| 14/14 [00:00<00:00, 92.65it/s, loss=5.1892]
Epoch 4 (Train):   3%|▍             | 2/64 [00:00<00:03, 18.16it/s, loss=4.9854]
Epoch 2/100 - Time: 1.6s - Train loss: 8.2250, Val loss: 5.4265, Learning rate: 0.000005
  Multiclass: Train acc: 0.3359, Val acc: 0.3657, Val F1: 0.3781
  Contralateral: Train acc: 0.5278, Val acc: 0.5688, Val F1: 0.3251
  Ipsilateral: Train acc: 0.4482, Val acc: 0.4989, Val F1: 0.2500
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 5.4265)
Validation score improved from 5.7386 to 5.4265
Epoch 3/100 - Time: 1.6s - Train loss: 7.7545, Val loss: 5.1892, Learning rate: 0.000006
  Multiclass: Train acc: 0.3364, Val acc: 0.3679, Val F1: 0.3788
  Contralateral: Train acc: 0.5293, Val acc: 0.5779, Val F1: 0.3200
  Ipsilateral: Train acc: 0.5010, Val acc: 0.5937, Val F1: 0.2308
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 5.1892)
Epoch 4 (Train): 100%|█████████████| 64/64 [00:01<00:00, 58.87it/s, loss=7.3412]
Epoch 4 (Val): 100%|███████████████| 14/14 [00:00<00:00, 92.75it/s, loss=4.9679]
Epoch 5 (Train):  36%|████▋        | 23/64 [00:00<00:00, 57.79it/s, loss=6.5452]
Epoch 4/100 - Time: 1.6s - Train loss: 7.3412, Val loss: 4.9679, Learning rate: 0.000008
  Multiclass: Train acc: 0.3540, Val acc: 0.3837, Val F1: 0.3929
  Contralateral: Train acc: 0.5371, Val acc: 0.5892, Val F1: 0.3259
  Ipsilateral: Train acc: 0.5366, Val acc: 0.6682, Val F1: 0.1878
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 4.9679)
Epoch 5 (Train): 100%|█████████████| 64/64 [00:01<00:00, 58.90it/s, loss=6.7136]
Epoch 5 (Val): 100%|███████████████| 14/14 [00:00<00:00, 92.42it/s, loss=4.7668]
Epoch 6 (Train):  69%|████████▉    | 44/64 [00:00<00:00, 62.53it/s, loss=6.6115]
Epoch 5/100 - Time: 1.6s - Train loss: 6.7136, Val loss: 4.7668, Learning rate: 0.000010
  Multiclass: Train acc: 0.3623, Val acc: 0.4018, Val F1: 0.4061
  Contralateral: Train acc: 0.5518, Val acc: 0.5892, Val F1: 0.3259
  Ipsilateral: Train acc: 0.5742, Val acc: 0.7201, Val F1: 0.1507
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 4.7668)
Epoch 6 (Train): 100%|█████████████| 64/64 [00:01<00:00, 59.03it/s, loss=6.5911]
Epoch 6 (Val): 100%|███████████████| 14/14 [00:00<00:00, 87.87it/s, loss=4.4845]
Epoch 7 (Train):  91%|███████████▊ | 58/64 [00:00<00:00, 63.67it/s, loss=6.1953]
Epoch 6/100 - Time: 1.7s - Train loss: 6.5911, Val loss: 4.4845, Learning rate: 0.000013
  Multiclass: Train acc: 0.3281, Val acc: 0.3973, Val F1: 0.3990
  Contralateral: Train acc: 0.5645, Val acc: 0.5959, Val F1: 0.3443
  Ipsilateral: Train acc: 0.5796, Val acc: 0.7359, Val F1: 0.1069
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 4.4845)
Epoch 7 (Train): 100%|█████████████| 64/64 [00:01<00:00, 58.54it/s, loss=6.1861]
Epoch 7 (Val): 100%|███████████████| 14/14 [00:00<00:00, 84.96it/s, loss=4.1753]
Epoch 8 (Train): 100%|█████████████| 64/64 [00:01<00:00, 58.58it/s, loss=5.3727]
Epoch 8 (Val): 100%|███████████████| 14/14 [00:00<00:00, 86.33it/s, loss=3.9018]
Epoch 7/100 - Time: 1.6s - Train loss: 6.1861, Val loss: 4.1753, Learning rate: 0.000016
  Multiclass: Train acc: 0.3540, Val acc: 0.3950, Val F1: 0.4025
  Contralateral: Train acc: 0.5420, Val acc: 0.6140, Val F1: 0.3398
  Ipsilateral: Train acc: 0.6016, Val acc: 0.7517, Val F1: 0.1129
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 4.1753)
Validation score improved from 4.4845 to 4.1753
Epoch 9 (Train): 100%|█████████████| 64/64 [00:01<00:00, 58.93it/s, loss=5.3015]
Epoch 9 (Val): 100%|███████████████| 14/14 [00:00<00:00, 79.90it/s, loss=3.7510]
Epoch 8/100 - Time: 1.6s - Train loss: 5.3727, Val loss: 3.9018, Learning rate: 0.000020
  Multiclass: Train acc: 0.3530, Val acc: 0.3860, Val F1: 0.3953
  Contralateral: Train acc: 0.5420, Val acc: 0.6208, Val F1: 0.3588
  Ipsilateral: Train acc: 0.6167, Val acc: 0.7743, Val F1: 0.0909
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 3.9018)
Validation score improved from 4.1753 to 3.9018
Epoch 10 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.84it/s, loss=4.6703]
Epoch 10 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.89it/s, loss=3.4904]
Epoch 11 (Train):   3%|▍            | 2/64 [00:00<00:03, 18.56it/s, loss=3.8964]
Epoch 9/100 - Time: 1.7s - Train loss: 5.3015, Val loss: 3.7510, Learning rate: 0.000024
  Multiclass: Train acc: 0.3604, Val acc: 0.4153, Val F1: 0.4241
  Contralateral: Train acc: 0.5542, Val acc: 0.6275, Val F1: 0.3726
  Ipsilateral: Train acc: 0.6343, Val acc: 0.7901, Val F1: 0.0606
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 3.7510)
Validation score improved from 3.9018 to 3.7510
Epoch 10/100 - Time: 1.6s - Train loss: 4.6703, Val loss: 3.4904, Learning rate: 0.000028
  Multiclass: Train acc: 0.3647, Val acc: 0.3928, Val F1: 0.4058
  Contralateral: Train acc: 0.5747, Val acc: 0.6659, Val F1: 0.4394
  Ipsilateral: Train acc: 0.6494, Val acc: 0.7923, Val F1: 0.0417
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 3.4904)
Epoch 11 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.81it/s, loss=4.5223]
Epoch 11 (Val): 100%|██████████████| 14/14 [00:00<00:00, 90.94it/s, loss=3.2392]
Epoch 12 (Train):  36%|████▎       | 23/64 [00:00<00:00, 57.82it/s, loss=4.2675]
Epoch 11/100 - Time: 1.6s - Train loss: 4.5223, Val loss: 3.2392, Learning rate: 0.000033
  Multiclass: Train acc: 0.3789, Val acc: 0.4492, Val F1: 0.4624
  Contralateral: Train acc: 0.5864, Val acc: 0.7111, Val F1: 0.4622
  Ipsilateral: Train acc: 0.6484, Val acc: 0.7901, Val F1: 0.2051
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 3.2392)
Epoch 12 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.36it/s, loss=3.8320]
Epoch 12 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.46it/s, loss=3.0362]
Epoch 13 (Train):  58%|██████▉     | 37/64 [00:00<00:00, 60.44it/s, loss=3.6757]
Epoch 12/100 - Time: 1.7s - Train loss: 3.8320, Val loss: 3.0362, Learning rate: 0.000037
  Multiclass: Train acc: 0.4116, Val acc: 0.4628, Val F1: 0.4657
  Contralateral: Train acc: 0.5786, Val acc: 0.7359, Val F1: 0.4706
  Ipsilateral: Train acc: 0.6582, Val acc: 0.8081, Val F1: 0.1584
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 3.0362)
Epoch 13 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.00it/s, loss=3.5966]
Epoch 13 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.85it/s, loss=2.9071]
Epoch 14 (Train):  91%|██████████▉ | 58/64 [00:01<00:00, 63.78it/s, loss=3.1804]
Epoch 13/100 - Time: 1.6s - Train loss: 3.5966, Val loss: 2.9071, Learning rate: 0.000042
  Multiclass: Train acc: 0.3848, Val acc: 0.4673, Val F1: 0.4781
  Contralateral: Train acc: 0.5859, Val acc: 0.6953, Val F1: 0.4944
  Ipsilateral: Train acc: 0.6553, Val acc: 0.8014, Val F1: 0.1852
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 2.9071)
Epoch 14 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.65it/s, loss=3.1700]
Epoch 14 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.21it/s, loss=2.7993]
Epoch 15 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.63it/s, loss=2.9579]
Epoch 15 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.76it/s, loss=2.4738]
Epoch 14/100 - Time: 1.6s - Train loss: 3.1700, Val loss: 2.7993, Learning rate: 0.000047
  Multiclass: Train acc: 0.4062, Val acc: 0.4334, Val F1: 0.4491
  Contralateral: Train acc: 0.6060, Val acc: 0.7381, Val F1: 0.4867
  Ipsilateral: Train acc: 0.6636, Val acc: 0.7991, Val F1: 0.1835
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 2.7993)
Validation score improved from 2.9071 to 2.7993
Epoch 16 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.87it/s, loss=2.6401]
Epoch 16 (Val): 100%|██████████████| 14/14 [00:00<00:00, 90.33it/s, loss=2.1086]
Epoch 17 (Train):   0%|                                  | 0/64 [00:00<?, ?it/s]
Epoch 15/100 - Time: 1.6s - Train loss: 2.9579, Val loss: 2.4738, Learning rate: 0.000052
  Multiclass: Train acc: 0.4141, Val acc: 0.4379, Val F1: 0.4531
  Contralateral: Train acc: 0.6304, Val acc: 0.7246, Val F1: 0.4602
  Ipsilateral: Train acc: 0.6929, Val acc: 0.7901, Val F1: 0.1308
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 2.4738)
Epoch 17 (Train): 100%|████████████| 64/64 [00:01<00:00, 59.02it/s, loss=2.4306]
Epoch 17 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.67it/s, loss=1.8343]
Epoch 18 (Train):  25%|███         | 16/64 [00:00<00:00, 53.57it/s, loss=2.4290]
Epoch 16/100 - Time: 1.6s - Train loss: 2.6401, Val loss: 2.1086, Learning rate: 0.000057
  Multiclass: Train acc: 0.4307, Val acc: 0.4289, Val F1: 0.4456
  Contralateral: Train acc: 0.6309, Val acc: 0.7269, Val F1: 0.4622
  Ipsilateral: Train acc: 0.7075, Val acc: 0.7946, Val F1: 0.1165
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 2.1086)
Validation score improved from 2.4738 to 2.1086
Epoch 17/100 - Time: 1.6s - Train loss: 2.4306, Val loss: 1.8343, Learning rate: 0.000062
  Multiclass: Train acc: 0.4189, Val acc: 0.4289, Val F1: 0.4443
  Contralateral: Train acc: 0.6255, Val acc: 0.7314, Val F1: 0.3497
  Ipsilateral: Train acc: 0.7256, Val acc: 0.7810, Val F1: 0.1849
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 1.8343)
Epoch 18 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.76it/s, loss=2.2692]
Epoch 18 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.93it/s, loss=2.1301]
Epoch 19 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.38it/s, loss=1.9035]
Epoch 18/100 - Time: 1.8s - Train loss: 2.2692, Val loss: 2.1301, Learning rate: 0.000067
  Multiclass: Train acc: 0.4131, Val acc: 0.4582, Val F1: 0.4712
  Contralateral: Train acc: 0.6665, Val acc: 0.7088, Val F1: 0.4416
  Ipsilateral: Train acc: 0.7339, Val acc: 0.8059, Val F1: 0.0851
Epoch 19 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.86it/s, loss=2.0017]
Epoch 19 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.50it/s, loss=1.9469]
Epoch 20 (Train):  91%|██████████▉ | 58/64 [00:00<00:00, 63.46it/s, loss=1.9613]
Epoch 19/100 - Time: 1.6s - Train loss: 2.0017, Val loss: 1.9469, Learning rate: 0.000072
  Multiclass: Train acc: 0.4116, Val acc: 0.3815, Val F1: 0.3818
  Contralateral: Train acc: 0.6626, Val acc: 0.7359, Val F1: 0.5301
  Ipsilateral: Train acc: 0.7573, Val acc: 0.8036, Val F1: 0.1212
Epoch 20 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.26it/s, loss=1.9360]
Epoch 20 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.05it/s, loss=1.5860]
Epoch 21 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.38it/s, loss=1.8862]
Epoch 21 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.87it/s, loss=1.8311]
Epoch 20/100 - Time: 1.7s - Train loss: 1.9360, Val loss: 1.5860, Learning rate: 0.000076
  Multiclass: Train acc: 0.4502, Val acc: 0.5034, Val F1: 0.5144
  Contralateral: Train acc: 0.6733, Val acc: 0.7630, Val F1: 0.4000
  Ipsilateral: Train acc: 0.7466, Val acc: 0.8081, Val F1: 0.1237
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 1.5860)
Validation score improved from 1.8343 to 1.5860
Epoch 22 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.61it/s, loss=1.7891]
Epoch 22 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.74it/s, loss=1.3772]
Epoch 21/100 - Time: 1.6s - Train loss: 1.8862, Val loss: 1.8311, Learning rate: 0.000080
  Multiclass: Train acc: 0.4756, Val acc: 0.4763, Val F1: 0.4903
  Contralateral: Train acc: 0.6851, Val acc: 0.7517, Val F1: 0.5000
  Ipsilateral: Train acc: 0.7690, Val acc: 0.8081, Val F1: 0.0860
No improvement in validation score: 1/7
Epoch 23 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.59it/s, loss=1.6578]
Epoch 23 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.53it/s, loss=1.6061]
Epoch 24 (Train):  25%|███         | 16/64 [00:00<00:00, 53.39it/s, loss=1.7540]
Epoch 22/100 - Time: 1.6s - Train loss: 1.7891, Val loss: 1.3772, Learning rate: 0.000084
  Multiclass: Train acc: 0.4678, Val acc: 0.5056, Val F1: 0.5268
  Contralateral: Train acc: 0.6841, Val acc: 0.7675, Val F1: 0.4663
  Ipsilateral: Train acc: 0.7671, Val acc: 0.8126, Val F1: 0.1263
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 1.3772)
Validation score improved from 1.5860 to 1.3772
Epoch 23/100 - Time: 1.6s - Train loss: 1.6578, Val loss: 1.6061, Learning rate: 0.000088
  Multiclass: Train acc: 0.4756, Val acc: 0.5079, Val F1: 0.5139
  Contralateral: Train acc: 0.6758, Val acc: 0.7043, Val F1: 0.4781
  Ipsilateral: Train acc: 0.7856, Val acc: 0.8081, Val F1: 0.0860
Epoch 24 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.80it/s, loss=1.7632]
Epoch 24 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.06it/s, loss=1.4237]
Epoch 25 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.62it/s, loss=1.7188]
Epoch 24/100 - Time: 1.8s - Train loss: 1.7632, Val loss: 1.4237, Learning rate: 0.000091
  Multiclass: Train acc: 0.4878, Val acc: 0.4763, Val F1: 0.4906
  Contralateral: Train acc: 0.7017, Val acc: 0.7065, Val F1: 0.4922
  Ipsilateral: Train acc: 0.7905, Val acc: 0.8081, Val F1: 0.1237
Epoch 25 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.83it/s, loss=1.6433]
Epoch 25 (Val): 100%|██████████████| 14/14 [00:00<00:00, 83.73it/s, loss=1.5503]
Epoch 26 (Train):  91%|██████████▉ | 58/64 [00:00<00:00, 62.94it/s, loss=1.4445]
Epoch 25/100 - Time: 1.6s - Train loss: 1.6433, Val loss: 1.5503, Learning rate: 0.000094
  Multiclass: Train acc: 0.4966, Val acc: 0.4153, Val F1: 0.4255
  Contralateral: Train acc: 0.7051, Val acc: 0.7201, Val F1: 0.4876
  Ipsilateral: Train acc: 0.7896, Val acc: 0.8014, Val F1: 0.1373
Epoch 26 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.21it/s, loss=1.4920]
Epoch 26 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.89it/s, loss=1.5039]
Epoch 27 (Train):  25%|███         | 16/64 [00:00<00:00, 53.69it/s, loss=1.3782][34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 2.1 seconds.), retrying request
Epoch 27 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.56it/s, loss=1.4212]
Epoch 27 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.52it/s, loss=1.1035]
Epoch 26/100 - Time: 1.6s - Train loss: 1.4920, Val loss: 1.5039, Learning rate: 0.000096
  Multiclass: Train acc: 0.4985, Val acc: 0.3815, Val F1: 0.3831
  Contralateral: Train acc: 0.7134, Val acc: 0.7156, Val F1: 0.4750
  Ipsilateral: Train acc: 0.7925, Val acc: 0.7743, Val F1: 0.2063
No improvement in validation score: 4/7
Epoch 28 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.18it/s, loss=1.3268]
Epoch 28 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.18it/s, loss=1.0043]
Epoch 27/100 - Time: 1.6s - Train loss: 1.4212, Val loss: 1.1035, Learning rate: 0.000098
  Multiclass: Train acc: 0.4849, Val acc: 0.5598, Val F1: 0.5612
  Contralateral: Train acc: 0.7012, Val acc: 0.7404, Val F1: 0.4796
  Ipsilateral: Train acc: 0.7886, Val acc: 0.8081, Val F1: 0.1053
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 1.1035)
Validation score improved from 1.3772 to 1.1035
Epoch 29 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.64it/s, loss=1.2688]
Epoch 29 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.25it/s, loss=1.0145]
Epoch 30 (Train):  25%|███         | 16/64 [00:00<00:00, 53.27it/s, loss=1.2436]
Epoch 28/100 - Time: 1.6s - Train loss: 1.3268, Val loss: 1.0043, Learning rate: 0.000099
  Multiclass: Train acc: 0.4990, Val acc: 0.5011, Val F1: 0.5058
  Contralateral: Train acc: 0.7197, Val acc: 0.7111, Val F1: 0.5616
  Ipsilateral: Train acc: 0.8032, Val acc: 0.8104, Val F1: 0.1765
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 1.0043)
Validation score improved from 1.1035 to 1.0043
Epoch 29/100 - Time: 1.6s - Train loss: 1.2688, Val loss: 1.0145, Learning rate: 0.000100
  Multiclass: Train acc: 0.5239, Val acc: 0.4876, Val F1: 0.5051
  Contralateral: Train acc: 0.7222, Val acc: 0.7562, Val F1: 0.4066
  Ipsilateral: Train acc: 0.7925, Val acc: 0.8036, Val F1: 0.0842
Epoch 30 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.66it/s, loss=1.2231]
Epoch 30 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.27it/s, loss=1.1267]
Epoch 31 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.82it/s, loss=1.1803]
Epoch 30/100 - Time: 1.8s - Train loss: 1.2231, Val loss: 1.1267, Learning rate: 0.000100
  Multiclass: Train acc: 0.5161, Val acc: 0.4695, Val F1: 0.4755
  Contralateral: Train acc: 0.7466, Val acc: 0.6953, Val F1: 0.5361
  Ipsilateral: Train acc: 0.7925, Val acc: 0.8036, Val F1: 0.1869
Epoch 31 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.99it/s, loss=1.1729]
Epoch 31 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.16it/s, loss=1.0933]
Epoch 32 (Train):  91%|██████████▉ | 58/64 [00:01<00:00, 63.59it/s, loss=1.1487]
Epoch 31/100 - Time: 1.6s - Train loss: 1.1729, Val loss: 1.0933, Learning rate: 0.000100
  Multiclass: Train acc: 0.5229, Val acc: 0.3792, Val F1: 0.3772
  Contralateral: Train acc: 0.7388, Val acc: 0.7585, Val F1: 0.4569
  Ipsilateral: Train acc: 0.8066, Val acc: 0.7743, Val F1: 0.1803
Epoch 32 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.61it/s, loss=1.1406]
Epoch 32 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.04it/s, loss=0.7999]
Epoch 33 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.09it/s, loss=1.0367]
Epoch 33 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.25it/s, loss=0.8314]
Epoch 32/100 - Time: 1.6s - Train loss: 1.1406, Val loss: 0.7999, Learning rate: 0.000100
  Multiclass: Train acc: 0.5430, Val acc: 0.4560, Val F1: 0.4621
  Contralateral: Train acc: 0.7280, Val acc: 0.6614, Val F1: 0.5283
  Ipsilateral: Train acc: 0.7998, Val acc: 0.7652, Val F1: 0.2464
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.7999)
Validation score improved from 1.0043 to 0.7999
Epoch 34 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.04it/s, loss=1.0455]
Epoch 34 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.98it/s, loss=0.9910]
Epoch 35 (Train):   0%|                     | 0/64 [00:00<?, ?it/s, loss=0.7753]
Epoch 33/100 - Time: 1.6s - Train loss: 1.0367, Val loss: 0.8314, Learning rate: 0.000100
  Multiclass: Train acc: 0.5278, Val acc: 0.4808, Val F1: 0.4892
  Contralateral: Train acc: 0.7437, Val acc: 0.7111, Val F1: 0.5152
  Ipsilateral: Train acc: 0.8032, Val acc: 0.7946, Val F1: 0.2087
Epoch 35 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.34it/s, loss=0.9595]
Epoch 35 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.43it/s, loss=0.8870]
Epoch 36 (Train):  36%|████▎       | 23/64 [00:00<00:00, 57.76it/s, loss=0.9314]
Epoch 34/100 - Time: 1.6s - Train loss: 1.0455, Val loss: 0.9910, Learning rate: 0.000099
  Multiclass: Train acc: 0.5420, Val acc: 0.5372, Val F1: 0.5458
  Contralateral: Train acc: 0.7568, Val acc: 0.7223, Val F1: 0.5461
  Ipsilateral: Train acc: 0.7998, Val acc: 0.8149, Val F1: 0.1961
No improvement in validation score: 2/7
Epoch 35/100 - Time: 1.7s - Train loss: 0.9595, Val loss: 0.8870, Learning rate: 0.000099
  Multiclass: Train acc: 0.5532, Val acc: 0.4424, Val F1: 0.4559
  Contralateral: Train acc: 0.7476, Val acc: 0.7472, Val F1: 0.5725
Epoch 36 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.61it/s, loss=0.9033]
Epoch 36 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.72it/s, loss=0.7766]
Epoch 37 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.63it/s, loss=0.8545]
No improvement in validation score: 3/7
Epoch 36/100 - Time: 1.8s - Train loss: 0.9033, Val loss: 0.7766, Learning rate: 0.000098
  Multiclass: Train acc: 0.5449, Val acc: 0.5214, Val F1: 0.5313
  Contralateral: Train acc: 0.7583, Val acc: 0.7291, Val F1: 0.5276
  Ipsilateral: Train acc: 0.8130, Val acc: 0.7856, Val F1: 0.2149
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.7766)
Epoch 37 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.78it/s, loss=0.8493]
Epoch 37 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.37it/s, loss=0.8730]
Epoch 38 (Train):  36%|████▎       | 23/64 [00:00<00:00, 57.36it/s, loss=0.8995]
Epoch 37/100 - Time: 1.7s - Train loss: 0.8493, Val loss: 0.8730, Learning rate: 0.000098
  Multiclass: Train acc: 0.5640, Val acc: 0.5192, Val F1: 0.5298
  Contralateral: Train acc: 0.7495, Val acc: 0.7562, Val F1: 0.5878
  Ipsilateral: Train acc: 0.8042, Val acc: 0.7923, Val F1: 0.2069
Epoch 38 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.58it/s, loss=0.9800]
Epoch 38 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.54it/s, loss=0.7711]
Epoch 39 (Train):  69%|████████▎   | 44/64 [00:00<00:00, 62.22it/s, loss=0.8584]
Epoch 38/100 - Time: 1.6s - Train loss: 0.9800, Val loss: 0.7711, Learning rate: 0.000097
  Multiclass: Train acc: 0.5723, Val acc: 0.4695, Val F1: 0.4885
  Contralateral: Train acc: 0.7651, Val acc: 0.7427, Val F1: 0.4865
  Ipsilateral: Train acc: 0.7949, Val acc: 0.7427, Val F1: 0.4000
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.7711)
Epoch 39 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.58it/s, loss=0.8477]
Epoch 39 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.49it/s, loss=0.7265]
Epoch 40 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.61it/s, loss=0.8142]
Epoch 40 (Val):   0%|                                    | 0/14 [00:00<?, ?it/s]
Epoch 39/100 - Time: 1.6s - Train loss: 0.8477, Val loss: 0.7265, Learning rate: 0.000096
  Multiclass: Train acc: 0.5791, Val acc: 0.4898, Val F1: 0.5041
  Contralateral: Train acc: 0.7583, Val acc: 0.7517, Val F1: 0.5259
  Ipsilateral: Train acc: 0.8042, Val acc: 0.7540, Val F1: 0.3771
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.7265)
Epoch 40 (Val): 100%|██████████████| 14/14 [00:00<00:00, 82.56it/s, loss=0.7924]
Epoch 41 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.68it/s, loss=0.7787]
Epoch 41 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.21it/s, loss=0.6562]
Epoch 40/100 - Time: 1.6s - Train loss: 0.8142, Val loss: 0.7924, Learning rate: 0.000095
  Multiclass: Train acc: 0.5708, Val acc: 0.5508, Val F1: 0.5609
  Contralateral: Train acc: 0.7603, Val acc: 0.7269, Val F1: 0.5694
  Ipsilateral: Train acc: 0.8159, Val acc: 0.7968, Val F1: 0.2742
No improvement in validation score: 1/7
Epoch 42 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.54it/s, loss=0.7153]
Epoch 42 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.62it/s, loss=0.6007]
Epoch 43 (Train):   0%|                                  | 0/64 [00:00<?, ?it/s]
Epoch 41/100 - Time: 1.6s - Train loss: 0.7787, Val loss: 0.6562, Learning rate: 0.000094
  Multiclass: Train acc: 0.5952, Val acc: 0.4831, Val F1: 0.4965
  Contralateral: Train acc: 0.7603, Val acc: 0.7607, Val F1: 0.5351
  Ipsilateral: Train acc: 0.8145, Val acc: 0.7585, Val F1: 0.3955
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.6562)
Validation score improved from 0.7265 to 0.6562
Epoch 42/100 - Time: 1.8s - Train loss: 0.7153, Val loss: 0.6007, Learning rate: 0.000093
  Multiclass: Train acc: 0.5854, Val acc: 0.5485, Val F1: 0.5584
  Contralateral: Train acc: 0.7759, Val acc: 0.7178, Val F1: 0.5981
  Ipsilateral: Train acc: 0.8076, Val acc: 0.7991, Val F1: 0.2261
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.6007)
Epoch 43 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.77it/s, loss=0.7618]
Epoch 43 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.15it/s, loss=0.6357]
Epoch 44 (Train):  25%|███         | 16/64 [00:00<00:00, 53.19it/s, loss=0.6690]
Epoch 43/100 - Time: 1.7s - Train loss: 0.7618, Val loss: 0.6357, Learning rate: 0.000092
  Multiclass: Train acc: 0.6045, Val acc: 0.5237, Val F1: 0.5405
  Contralateral: Train acc: 0.7778, Val acc: 0.7630, Val F1: 0.5850
  Ipsilateral: Train acc: 0.8164, Val acc: 0.7607, Val F1: 0.3765
Epoch 44 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.03it/s, loss=0.7768]
Epoch 44 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.82it/s, loss=0.7606]
Epoch 45 (Train):  69%|████████▎   | 44/64 [00:00<00:00, 61.24it/s, loss=0.7012]
Epoch 44/100 - Time: 1.6s - Train loss: 0.7768, Val loss: 0.7606, Learning rate: 0.000090
  Multiclass: Train acc: 0.5938, Val acc: 0.5237, Val F1: 0.5322
  Contralateral: Train acc: 0.7852, Val acc: 0.7381, Val F1: 0.5887
  Ipsilateral: Train acc: 0.8164, Val acc: 0.7810, Val F1: 0.3899
Epoch 45 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.82it/s, loss=0.6989]
Epoch 45 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.45it/s, loss=0.7797]
Epoch 46 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.53it/s, loss=0.7074]
Epoch 46 (Val):   0%|                                    | 0/14 [00:00<?, ?it/s]
Epoch 45/100 - Time: 1.6s - Train loss: 0.6989, Val loss: 0.7797, Learning rate: 0.000089
  Multiclass: Train acc: 0.6006, Val acc: 0.5079, Val F1: 0.5248
  Contralateral: Train acc: 0.7812, Val acc: 0.7788, Val F1: 0.5847
  Ipsilateral: Train acc: 0.8145, Val acc: 0.7720, Val F1: 0.4162
Epoch 46 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.61it/s, loss=0.5943]
Epoch 47 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.28it/s, loss=0.6532]
Epoch 47 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.05it/s, loss=0.6193]
Epoch 46/100 - Time: 1.6s - Train loss: 0.7074, Val loss: 0.5943, Learning rate: 0.000088
  Multiclass: Train acc: 0.6304, Val acc: 0.5508, Val F1: 0.5520
  Contralateral: Train acc: 0.7969, Val acc: 0.7223, Val F1: 0.6070
  Ipsilateral: Train acc: 0.8188, Val acc: 0.8014, Val F1: 0.3016
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.5943)
Validation score improved from 0.6007 to 0.5943
Epoch 48 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.85it/s, loss=0.5702]
Epoch 48 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.49it/s, loss=0.4937]
Epoch 49 (Train):   3%|▍            | 2/64 [00:00<00:03, 18.75it/s, loss=0.5588]
Epoch 47/100 - Time: 1.6s - Train loss: 0.6532, Val loss: 0.6193, Learning rate: 0.000086
  Multiclass: Train acc: 0.6416, Val acc: 0.5553, Val F1: 0.5695
  Contralateral: Train acc: 0.7896, Val acc: 0.7675, Val F1: 0.5896
  Ipsilateral: Train acc: 0.8164, Val acc: 0.7856, Val F1: 0.4172
No improvement in validation score: 1/7
Epoch 48/100 - Time: 1.6s - Train loss: 0.5702, Val loss: 0.4937, Learning rate: 0.000085
  Multiclass: Train acc: 0.6328, Val acc: 0.5621, Val F1: 0.5638
  Contralateral: Train acc: 0.7944, Val acc: 0.7223, Val F1: 0.5967
  Ipsilateral: Train acc: 0.8247, Val acc: 0.7630, Val F1: 0.3787
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.4937)
Epoch 49 (Train): 100%|████████████| 64/64 [00:01<00:00, 51.51it/s, loss=0.6005]
Epoch 49 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.72it/s, loss=0.5750]
Epoch 50 (Train):  23%|██▊         | 15/64 [00:00<00:00, 51.72it/s, loss=0.5661]
Epoch 49/100 - Time: 1.8s - Train loss: 0.6005, Val loss: 0.5750, Learning rate: 0.000083
  Multiclass: Train acc: 0.6382, Val acc: 0.5847, Val F1: 0.5920
  Contralateral: Train acc: 0.7964, Val acc: 0.7720, Val F1: 0.6160
  Ipsilateral: Train acc: 0.8281, Val acc: 0.7675, Val F1: 0.4246
Epoch 50 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.67it/s, loss=0.6850]
Epoch 50 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.29it/s, loss=0.5400]
Epoch 51 (Train):  67%|████████    | 43/64 [00:00<00:00, 61.46it/s, loss=0.5555]
Epoch 50/100 - Time: 1.6s - Train loss: 0.6850, Val loss: 0.5400, Learning rate: 0.000081
  Multiclass: Train acc: 0.6538, Val acc: 0.5576, Val F1: 0.5545
  Contralateral: Train acc: 0.7876, Val acc: 0.7269, Val F1: 0.6231
  Ipsilateral: Train acc: 0.8306, Val acc: 0.7946, Val F1: 0.3974
Epoch 52 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.26it/s, loss=0.5505]
Epoch 51 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.31it/s, loss=0.5631]
Epoch 52 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.26it/s, loss=0.5505]
Epoch 52 (Val):   0%|                                    | 0/14 [00:00<?, ?it/s]
Epoch 51/100 - Time: 1.7s - Train loss: 0.5546, Val loss: 0.5631, Learning rate: 0.000079
  Multiclass: Train acc: 0.6636, Val acc: 0.5711, Val F1: 0.5783
  Contralateral: Train acc: 0.8086, Val acc: 0.7788, Val F1: 0.6172
  Ipsilateral: Train acc: 0.8306, Val acc: 0.7788, Val F1: 0.4432
Epoch 52 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.60it/s, loss=0.4964]
Epoch 53 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.97it/s, loss=0.5397]
Epoch 53 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.65it/s, loss=0.5202]
Epoch 52 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.60it/s, loss=0.4964]
Epoch 52/100 - Time: 1.6s - Train loss: 0.5505, Val loss: 0.4964, Learning rate: 0.000078
  Multiclass: Train acc: 0.6465, Val acc: 0.6050, Val F1: 0.6129
  Contralateral: Train acc: 0.8052, Val acc: 0.7923, Val F1: 0.6378
  Ipsilateral: Train acc: 0.8218, Val acc: 0.7923, Val F1: 0.4250
Epoch 54 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.71it/s, loss=0.5225]
Epoch 54 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.23it/s, loss=0.4529]
Epoch 55 (Train):  14%|█▊           | 9/64 [00:00<00:01, 44.21it/s, loss=0.5573]
Epoch 54 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.71it/s, loss=0.5225]
Epoch 53/100 - Time: 1.6s - Train loss: 0.5397, Val loss: 0.5202, Learning rate: 0.000076
  Multiclass: Train acc: 0.6582, Val acc: 0.6117, Val F1: 0.6201
  Contralateral: Train acc: 0.8145, Val acc: 0.7810, Val F1: 0.6421
  Ipsilateral: Train acc: 0.8306, Val acc: 0.7720, Val F1: 0.3952
No improvement in validation score: 5/7
Epoch 54/100 - Time: 1.6s - Train loss: 0.5225, Val loss: 0.4529, Learning rate: 0.000074
  Multiclass: Train acc: 0.6562, Val acc: 0.5688, Val F1: 0.5644
  Contralateral: Train acc: 0.8145, Val acc: 0.7494, Val F1: 0.6520
  Ipsilateral: Train acc: 0.8428, Val acc: 0.7946, Val F1: 0.4485
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.4529)
Epoch 55 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.20it/s, loss=0.4664]
Epoch 56 (Train):  23%|██▊         | 15/64 [00:00<00:01, 32.41it/s, loss=0.5173]
Epoch 55 (Val): 100%|██████████████| 14/14 [00:00<00:00, 89.20it/s, loss=0.4664]
Epoch 55/100 - Time: 1.6s - Train loss: 0.5192, Val loss: 0.4664, Learning rate: 0.000072
  Multiclass: Train acc: 0.6860, Val acc: 0.5959, Val F1: 0.6052
  Contralateral: Train acc: 0.8184, Val acc: 0.7765, Val F1: 0.6320
  Ipsilateral: Train acc: 0.8398, Val acc: 0.7562, Val F1: 0.5046
Epoch 57 (Train):  36%|████▎       | 23/64 [00:00<00:00, 57.68it/s, loss=0.4899]
Epoch 57 (Train):  36%|████▎       | 23/64 [00:00<00:00, 57.68it/s, loss=0.4899]
Epoch 56/100 - Time: 2.1s - Train loss: 0.5359, Val loss: 0.4083, Learning rate: 0.000070
  Multiclass: Train acc: 0.6821, Val acc: 0.6253, Val F1: 0.6344
  Contralateral: Train acc: 0.8115, Val acc: 0.7946, Val F1: 0.6513
  Ipsilateral: Train acc: 0.8320, Val acc: 0.7856, Val F1: 0.4633
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.4083)
Epoch 57 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.65it/s, loss=0.4879]
Epoch 57 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.65it/s, loss=0.4879]
Epoch 57/100 - Time: 1.6s - Train loss: 0.4879, Val loss: 0.4415, Learning rate: 0.000068
  Multiclass: Train acc: 0.6772, Val acc: 0.6095, Val F1: 0.6171
  Contralateral: Train acc: 0.8242, Val acc: 0.7923, Val F1: 0.6378
  Ipsilateral: Train acc: 0.8594, Val acc: 0.7878, Val F1: 0.4778
Epoch 58 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.49it/s, loss=0.4740]
Epoch 58 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.49it/s, loss=0.4740]
Epoch 58/100 - Time: 1.6s - Train loss: 0.4876, Val loss: 0.4740, Learning rate: 0.000065
  Multiclass: Train acc: 0.6855, Val acc: 0.6163, Val F1: 0.6130
  Contralateral: Train acc: 0.8232, Val acc: 0.7427, Val F1: 0.6627
  Ipsilateral: Train acc: 0.8545, Val acc: 0.8036, Val F1: 0.4238
Epoch 60 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.68it/s, loss=0.4760]
Epoch 60 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.68it/s, loss=0.4760]
Epoch 59/100 - Time: 1.6s - Train loss: 0.5291, Val loss: 0.4098, Learning rate: 0.000063
  Multiclass: Train acc: 0.6973, Val acc: 0.6321, Val F1: 0.6311
  Contralateral: Train acc: 0.8047, Val acc: 0.7630, Val F1: 0.6749
  Ipsilateral: Train acc: 0.8569, Val acc: 0.8014, Val F1: 0.4359
Epoch 61 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.70it/s, loss=0.4233]
Epoch 61 (Val): 100%|██████████████| 14/14 [00:00<00:00, 88.70it/s, loss=0.4233]
Epoch 60/100 - Time: 1.6s - Train loss: 0.4760, Val loss: 0.3564, Learning rate: 0.000061
  Multiclass: Train acc: 0.6968, Val acc: 0.6637, Val F1: 0.6670
  Contralateral: Train acc: 0.8252, Val acc: 0.7856, Val F1: 0.6906
  Ipsilateral: Train acc: 0.8403, Val acc: 0.8375, Val F1: 0.4627
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.3564)
Epoch 63 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.54it/s, loss=0.4071]
Epoch 63 (Train):  47%|█████▋      | 30/64 [00:00<00:00, 59.54it/s, loss=0.4071]
Epoch 61/100 - Time: 1.8s - Train loss: 0.4364, Val loss: 0.4233, Learning rate: 0.000059
  Multiclass: Train acc: 0.7109, Val acc: 0.6433, Val F1: 0.6449
  Contralateral: Train acc: 0.8276, Val acc: 0.7381, Val F1: 0.6548
  Ipsilateral: Train acc: 0.8564, Val acc: 0.8194, Val F1: 0.5122
No improvement in validation score: 1/7
Epoch 62/100 - Time: 1.6s - Train loss: 0.4104, Val loss: 0.3972, Learning rate: 0.000057
  Multiclass: Train acc: 0.7168, Val acc: 0.6524, Val F1: 0.6578
  Contralateral: Train acc: 0.8311, Val acc: 0.7968, Val F1: 0.6786
  Ipsilateral: Train acc: 0.8604, Val acc: 0.8149, Val F1: 0.5233
Epoch 63 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.32it/s, loss=0.4197]
Epoch 63 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.32it/s, loss=0.4197]
Epoch 63/100 - Time: 1.6s - Train loss: 0.4197, Val loss: 0.3774, Learning rate: 0.000054
  Multiclass: Train acc: 0.7104, Val acc: 0.6343, Val F1: 0.6389
  Contralateral: Train acc: 0.8374, Val acc: 0.8126, Val F1: 0.7128
  Ipsilateral: Train acc: 0.8564, Val acc: 0.7991, Val F1: 0.5389
Epoch 64 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.52it/s, loss=0.3827]
Epoch 64 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.52it/s, loss=0.3827]
Epoch 64/100 - Time: 1.6s - Train loss: 0.4332, Val loss: 0.3827, Learning rate: 0.000052
  Multiclass: Train acc: 0.7231, Val acc: 0.6479, Val F1: 0.6526
  Contralateral: Train acc: 0.8442, Val acc: 0.7946, Val F1: 0.7036
  Ipsilateral: Train acc: 0.8789, Val acc: 0.8126, Val F1: 0.5146
Epoch 66 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.53it/s, loss=0.4097]
Epoch 66 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.53it/s, loss=0.4097]
Epoch 65/100 - Time: 1.6s - Train loss: 0.4290, Val loss: 0.4139, Learning rate: 0.000050
  Multiclass: Train acc: 0.7310, Val acc: 0.6569, Val F1: 0.6584
  Contralateral: Train acc: 0.8462, Val acc: 0.7946, Val F1: 0.7111
  Ipsilateral: Train acc: 0.8750, Val acc: 0.7968, Val F1: 0.4643
Epoch 67 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.62it/s, loss=0.3580]
Epoch 67 (Val): 100%|██████████████| 14/14 [00:00<00:00, 87.62it/s, loss=0.3580]
Epoch 66/100 - Time: 1.6s - Train loss: 0.4097, Val loss: 0.3166, Learning rate: 0.000048
  Multiclass: Train acc: 0.7402, Val acc: 0.6366, Val F1: 0.6429
  Contralateral: Train acc: 0.8442, Val acc: 0.8059, Val F1: 0.6972
  Ipsilateral: Train acc: 0.8735, Val acc: 0.7878, Val F1: 0.5566
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/hybrid/best_model.pth
New best model saved (val_loss: 0.3166)
Validation score improved from 0.3564 to 0.3166
Epoch 67/100 - Time: 1.6s - Train loss: 0.3881, Val loss: 0.3580, Learning rate: 0.000045
  Multiclass: Train acc: 0.7383, Val acc: 0.6050, Val F1: 0.5949
  Contralateral: Train acc: 0.8296, Val acc: 0.7698, Val F1: 0.6946
  Ipsilateral: Train acc: 0.8774, Val acc: 0.8126, Val F1: 0.5608
Epoch 69 (Train):  58%|██████▉     | 37/64 [00:00<00:00, 61.13it/s, loss=0.3715]
Epoch 69 (Train):  58%|██████▉     | 37/64 [00:00<00:00, 61.13it/s, loss=0.3715]
Epoch 68/100 - Time: 1.7s - Train loss: 0.4032, Val loss: 0.3750, Learning rate: 0.000043
  Multiclass: Train acc: 0.7446, Val acc: 0.6433, Val F1: 0.6413
  Contralateral: Train acc: 0.8442, Val acc: 0.7765, Val F1: 0.7009
  Ipsilateral: Train acc: 0.8809, Val acc: 0.8194, Val F1: 0.5402
Epoch 69 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.98it/s, loss=0.3822]
Epoch 69 (Train): 100%|████████████| 64/64 [00:01<00:00, 57.98it/s, loss=0.3822]
Epoch 69/100 - Time: 1.6s - Train loss: 0.3822, Val loss: 0.3666, Learning rate: 0.000041
  Multiclass: Train acc: 0.7544, Val acc: 0.6546, Val F1: 0.6574
  Contralateral: Train acc: 0.8535, Val acc: 0.7901, Val F1: 0.7048
  Ipsilateral: Train acc: 0.8809, Val acc: 0.8126, Val F1: 0.5414
Epoch 70 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.52it/s, loss=0.3261]
Epoch 70 (Val): 100%|██████████████| 14/14 [00:00<00:00, 86.52it/s, loss=0.3261]
Epoch 70/100 - Time: 1.6s - Train loss: 0.4059, Val loss: 0.3261, Learning rate: 0.000039
  Multiclass: Train acc: 0.7476, Val acc: 0.6727, Val F1: 0.6733
  Contralateral: Train acc: 0.8628, Val acc: 0.8104, Val F1: 0.7290
  Ipsilateral: Train acc: 0.8740, Val acc: 0.8172, Val F1: 0.5371
Epoch 72 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.07it/s, loss=0.3811]
Epoch 72 (Train): 100%|████████████| 64/64 [00:01<00:00, 58.07it/s, loss=0.3811]
Epoch 71/100 - Time: 1.6s - Train loss: 0.3614, Val loss: 0.3263, Learning rate: 0.000037
  Multiclass: Train acc: 0.7529, Val acc: 0.6546, Val F1: 0.6523
  Contralateral: Train acc: 0.8584, Val acc: 0.8059, Val F1: 0.7226
  Ipsilateral: Train acc: 0.8652, Val acc: 0.8014, Val F1: 0.5556
Epoch 73 (Val): 100%|██████████████| 14/14 [00:00<00:00, 83.59it/s, loss=0.3491]
Epoch 73 (Val): 100%|██████████████| 14/14 [00:00<00:00, 83.59it/s, loss=0.3491]
Epoch 72/100 - Time: 1.6s - Train loss: 0.3811, Val loss: 0.3264, Learning rate: 0.000035
  Multiclass: Train acc: 0.7495, Val acc: 0.6817, Val F1: 0.6848
  Contralateral: Train acc: 0.8564, Val acc: 0.8059, Val F1: 0.7226
  Ipsilateral: Train acc: 0.8823, Val acc: 0.8239, Val F1: 0.5568
No improvement in validation score: 6/7
Epoch 73/100 - Time: 1.6s - Train loss: 0.3555, Val loss: 0.3491, Learning rate: 0.000032
  Multiclass: Train acc: 0.7637, Val acc: 0.6840, Val F1: 0.6871
  Contralateral: Train acc: 0.8652, Val acc: 0.8126, Val F1: 0.7261
  Ipsilateral: Train acc: 0.8853, Val acc: 0.8239, Val F1: 0.5667
No improvement in validation score: 7/7
Early stopping triggered after 7 epochs without improvement
Early stopping triggered after 73 epochs
Best model was at epoch 66
Training completed in 123.7s. Best validation loss: 0.3166
Loaded model from checkpoint (epoch 66)
Evaluating model on test set...
Multiclass Test Metrics:
  accuracy: 0.6726
  precision: 0.7362
  recall: 0.6726
  f1: 0.6787
Contralateral Test Metrics:
  accuracy: 0.8151
  precision: 0.6643
  recall: 0.7308
  f1: 0.6960
Ipsilateral Test Metrics:
  accuracy: 0.8174
  precision: 0.5285
  recall: 0.7303
  f1: 0.6132
Overall Test Accuracy: 0.7684
Generating visualizations...
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/ipsilateral_roc_curves.png
Saved neural activity visualization to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/visualizations/neural_activity_figure4.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/hybrid/test_results.json