Epoch 1 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 123.17it/s, loss=0.6555]
Epoch 1 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 112.53it/s, loss=0.6495]
WandB initialized successfully!
Starting training for lstm model...
Using device: cuda
Model parameters: 71,111 total, 71,111 trainable
Epoch 2 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.43it/s, loss=0.6399]
Epoch 2 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 120.08it/s, loss=0.6305]
Epoch 1/100 - Time: 1.3s - Train loss: 0.6555, Val loss: 0.6495, Learning rate: 0.000100
  Multiclass: Train acc: 0.5383, Val acc: 0.5663, Val F1: 0.4101
  Contralateral: Train acc: 0.5595, Val acc: 0.7371, Val F1: 0.6553
  Ipsilateral: Train acc: 0.6625, Val acc: 0.7955, Val F1: 0.7188
New best model saved (val_loss: 0.6495)
Epoch 3 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.07it/s, loss=0.6141]
Epoch 3 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 110.97it/s, loss=0.5989]
Epoch 4 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.86it/s, loss=0.5753]
Epoch 4 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 109.91it/s, loss=0.5683]
Epoch 5 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.26it/s, loss=0.5522]
Epoch 5 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 113.59it/s, loss=0.5573]
Epoch 2/100 - Time: 1.0s - Train loss: 0.6399, Val loss: 0.6305, Learning rate: 0.000100
  Multiclass: Train acc: 0.5652, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7309, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.6305)
Epoch 3/100 - Time: 0.9s - Train loss: 0.6141, Val loss: 0.5989, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5989)
Epoch 4/100 - Time: 1.2s - Train loss: 0.5753, Val loss: 0.5683, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5683)
Epoch 6 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.84it/s, loss=0.5395]
Epoch 6 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 107.62it/s, loss=0.5457]
Epoch 7 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.35it/s, loss=0.5228]
Epoch 7 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 114.26it/s, loss=0.5305]
Epoch 8 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.25it/s, loss=0.5049]
Epoch 8 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 115.85it/s, loss=0.5121]
Epoch 9 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.09it/s, loss=0.4797]
Epoch 9 (Val): 100%|████████████████████| 14/14 [00:00<00:00, 112.49it/s, loss=0.4942]
Epoch 10 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.38it/s, loss=0.4571]
Epoch 10 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.25it/s, loss=0.4749]
Epoch 11 (Train):  38%|██████▌          | 25/65 [00:00<00:00, 134.24it/s, loss=0.4412]
Epoch 5/100 - Time: 0.9s - Train loss: 0.5522, Val loss: 0.5573, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5573)
Epoch 6/100 - Time: 0.9s - Train loss: 0.5395, Val loss: 0.5457, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5457)
Epoch 7/100 - Time: 0.8s - Train loss: 0.5228, Val loss: 0.5305, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5305)
Epoch 8/100 - Time: 0.9s - Train loss: 0.5049, Val loss: 0.5121, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.5121)
Epoch 9/100 - Time: 0.8s - Train loss: 0.4797, Val loss: 0.4942, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.4942)
Epoch 10/100 - Time: 0.9s - Train loss: 0.4571, Val loss: 0.4749, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
Epoch 11 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.28it/s, loss=0.4333]
Epoch 11 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.24it/s, loss=0.4544]
Epoch 12 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.45it/s, loss=0.4086]
Epoch 12 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 117.30it/s, loss=0.4316]
Epoch 11/100 - Time: 0.9s - Train loss: 0.4333, Val loss: 0.4544, Learning rate: 0.000100
  Multiclass: Train acc: 0.5657, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.7267
New best model saved (val_loss: 0.4544)
Epoch 13 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.82it/s, loss=0.3854]
Epoch 13 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 122.68it/s, loss=0.4074]
Epoch 12/100 - Time: 2.1s - Train loss: 0.4086, Val loss: 0.4316, Learning rate: 0.000100
  Multiclass: Train acc: 0.5686, Val acc: 0.5730, Val F1: 0.4283
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8315, Val F1: 0.7773
New best model saved (val_loss: 0.4316)
Epoch 14 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 154.68it/s, loss=0.3541]
Epoch 14 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.56it/s, loss=0.3850]
Epoch 13/100 - Time: 0.8s - Train loss: 0.3854, Val loss: 0.4074, Learning rate: 0.000100
  Multiclass: Train acc: 0.6086, Val acc: 0.6022, Val F1: 0.5148
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8503, Val acc: 0.8472, Val F1: 0.8287
New best model saved (val_loss: 0.4074)
Epoch 15 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.16it/s, loss=0.3299]
Epoch 15 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.26it/s, loss=0.3564]
Epoch 14/100 - Time: 0.9s - Train loss: 0.3541, Val loss: 0.3850, Learning rate: 0.000100
  Multiclass: Train acc: 0.6721, Val acc: 0.6562, Val F1: 0.6150
  Contralateral: Train acc: 0.7443, Val acc: 0.7551, Val F1: 0.6497
  Ipsilateral: Train acc: 0.8883, Val acc: 0.8629, Val F1: 0.8523
New best model saved (val_loss: 0.3850)
Epoch 16 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.51it/s, loss=0.2977]
Epoch 16 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 119.20it/s, loss=0.3471]
Epoch 15/100 - Time: 0.8s - Train loss: 0.3299, Val loss: 0.3564, Learning rate: 0.000100
  Multiclass: Train acc: 0.7130, Val acc: 0.6921, Val F1: 0.6793
  Contralateral: Train acc: 0.7646, Val acc: 0.7820, Val F1: 0.7196
  Ipsilateral: Train acc: 0.9042, Val acc: 0.8809, Val F1: 0.8789
New best model saved (val_loss: 0.3564)
Epoch 17 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.19it/s, loss=0.2723]
Epoch 17 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 108.35it/s, loss=0.3160]
Epoch 16/100 - Time: 0.9s - Train loss: 0.2977, Val loss: 0.3471, Learning rate: 0.000100
  Multiclass: Train acc: 0.7641, Val acc: 0.6944, Val F1: 0.6863
  Contralateral: Train acc: 0.7906, Val acc: 0.8022, Val F1: 0.7713
  Ipsilateral: Train acc: 0.9297, Val acc: 0.8764, Val F1: 0.8709
New best model saved (val_loss: 0.3471)
Epoch 18 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 152.43it/s, loss=0.2499]
Epoch 18 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.51it/s, loss=0.2917]
Epoch 17/100 - Time: 0.8s - Train loss: 0.2723, Val loss: 0.3160, Learning rate: 0.000100
  Multiclass: Train acc: 0.7877, Val acc: 0.7258, Val F1: 0.7221
  Contralateral: Train acc: 0.8103, Val acc: 0.8292, Val F1: 0.8192
  Ipsilateral: Train acc: 0.9283, Val acc: 0.8899, Val F1: 0.8874
New best model saved (val_loss: 0.3160)
Epoch 19 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.17it/s, loss=0.2270]
Epoch 19 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.89it/s, loss=0.2756]
Epoch 18/100 - Time: 0.9s - Train loss: 0.2499, Val loss: 0.2917, Learning rate: 0.000100
  Multiclass: Train acc: 0.8026, Val acc: 0.7416, Val F1: 0.7403
  Contralateral: Train acc: 0.8416, Val acc: 0.8449, Val F1: 0.8377
  Ipsilateral: Train acc: 0.9364, Val acc: 0.8989, Val F1: 0.8986
New best model saved (val_loss: 0.2917)
Epoch 20 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.04it/s, loss=0.2104]
Epoch 20 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 122.32it/s, loss=0.2609]
Epoch 19/100 - Time: 0.9s - Train loss: 0.2270, Val loss: 0.2756, Learning rate: 0.000100
  Multiclass: Train acc: 0.8223, Val acc: 0.7663, Val F1: 0.7643
  Contralateral: Train acc: 0.8498, Val acc: 0.8562, Val F1: 0.8491
  Ipsilateral: Train acc: 0.9427, Val acc: 0.9034, Val F1: 0.9040
New best model saved (val_loss: 0.2756)
Epoch 21 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 152.20it/s, loss=0.1894]
Epoch 21 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 115.89it/s, loss=0.2473]
Epoch 20/100 - Time: 0.9s - Train loss: 0.2104, Val loss: 0.2609, Learning rate: 0.000100
  Multiclass: Train acc: 0.8305, Val acc: 0.7730, Val F1: 0.7726
  Contralateral: Train acc: 0.8618, Val acc: 0.8584, Val F1: 0.8547
  Ipsilateral: Train acc: 0.9499, Val acc: 0.9079, Val F1: 0.9093
New best model saved (val_loss: 0.2609)
Epoch 22 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 146.79it/s, loss=0.1753]
Epoch 22 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 102.41it/s, loss=0.2400]
Epoch 21/100 - Time: 0.9s - Train loss: 0.1894, Val loss: 0.2473, Learning rate: 0.000100
  Multiclass: Train acc: 0.8430, Val acc: 0.7820, Val F1: 0.7828
  Contralateral: Train acc: 0.8772, Val acc: 0.8787, Val F1: 0.8775
  Ipsilateral: Train acc: 0.9576, Val acc: 0.9124, Val F1: 0.9140
New best model saved (val_loss: 0.2473)
Epoch 23 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 154.93it/s, loss=0.1668]
Epoch 23 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.37it/s, loss=0.2340]
Epoch 22/100 - Time: 1.1s - Train loss: 0.1753, Val loss: 0.2400, Learning rate: 0.000100
  Multiclass: Train acc: 0.8560, Val acc: 0.7910, Val F1: 0.7907
  Contralateral: Train acc: 0.8912, Val acc: 0.8831, Val F1: 0.8808
  Ipsilateral: Train acc: 0.9571, Val acc: 0.9213, Val F1: 0.9219
New best model saved (val_loss: 0.2400)
Epoch 24 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.97it/s, loss=0.1569]
Epoch 24 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.00it/s, loss=0.2249]
Epoch 23/100 - Time: 0.9s - Train loss: 0.1668, Val loss: 0.2340, Learning rate: 0.000100
  Multiclass: Train acc: 0.8719, Val acc: 0.8045, Val F1: 0.8032
  Contralateral: Train acc: 0.8974, Val acc: 0.8787, Val F1: 0.8748
  Ipsilateral: Train acc: 0.9620, Val acc: 0.9169, Val F1: 0.9174
New best model saved (val_loss: 0.2340)
Epoch 25 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.95it/s, loss=0.1439]
Epoch 25 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 120.56it/s, loss=0.2164]
Epoch 24/100 - Time: 0.9s - Train loss: 0.1569, Val loss: 0.2249, Learning rate: 0.000100
  Multiclass: Train acc: 0.8772, Val acc: 0.7978, Val F1: 0.7961
  Contralateral: Train acc: 0.9023, Val acc: 0.8876, Val F1: 0.8845
  Ipsilateral: Train acc: 0.9639, Val acc: 0.9146, Val F1: 0.9146
New best model saved (val_loss: 0.2249)
Epoch 25/100 - Time: 0.8s - Train loss: 0.1439, Val loss: 0.2164, Learning rate: 0.000100
  Multiclass: Train acc: 0.8801, Val acc: 0.8045, Val F1: 0.8038
  Contralateral: Train acc: 0.9037, Val acc: 0.8921, Val F1: 0.8903
  Ipsilateral: Train acc: 0.9639, Val acc: 0.9101, Val F1: 0.9105
New best model saved (val_loss: 0.2164)
Epoch 26 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.60it/s, loss=0.1353]
Epoch 26 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.50it/s, loss=0.2123]
Epoch 27 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.37it/s, loss=0.1244]
Epoch 27 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 108.89it/s, loss=0.1982]
Epoch 26/100 - Time: 0.9s - Train loss: 0.1353, Val loss: 0.2123, Learning rate: 0.000100
  Multiclass: Train acc: 0.8941, Val acc: 0.8202, Val F1: 0.8195
  Contralateral: Train acc: 0.9148, Val acc: 0.9011, Val F1: 0.9005
  Ipsilateral: Train acc: 0.9658, Val acc: 0.9169, Val F1: 0.9174
New best model saved (val_loss: 0.2123)
Epoch 27/100 - Time: 0.9s - Train loss: 0.1244, Val loss: 0.1982, Learning rate: 0.000100
  Multiclass: Train acc: 0.8936, Val acc: 0.8404, Val F1: 0.8404
  Contralateral: Train acc: 0.9210, Val acc: 0.9146, Val F1: 0.9141
  Ipsilateral: Train acc: 0.9663, Val acc: 0.9258, Val F1: 0.9273
New best model saved (val_loss: 0.1982)
Epoch 28 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.89it/s, loss=0.1160]
Epoch 28 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 106.32it/s, loss=0.1936]
Epoch 28/100 - Time: 0.9s - Train loss: 0.1160, Val loss: 0.1936, Learning rate: 0.000100
  Multiclass: Train acc: 0.9076, Val acc: 0.8449, Val F1: 0.8450
  Contralateral: Train acc: 0.9302, Val acc: 0.9124, Val F1: 0.9117
  Ipsilateral: Train acc: 0.9697, Val acc: 0.9281, Val F1: 0.9301
New best model saved (val_loss: 0.1936)
Epoch 29 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.46it/s, loss=0.1129]
Epoch 29 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.82it/s, loss=0.1997]
Epoch 29/100 - Time: 0.9s - Train loss: 0.1129, Val loss: 0.1997, Learning rate: 0.000100
  Multiclass: Train acc: 0.9066, Val acc: 0.8382, Val F1: 0.8368
  Contralateral: Train acc: 0.9336, Val acc: 0.9101, Val F1: 0.9069
  Ipsilateral: Train acc: 0.9745, Val acc: 0.9303, Val F1: 0.9308
Epoch 30 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.68it/s, loss=0.1079]
Epoch 30 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.31it/s, loss=0.1923]
Epoch 30/100 - Time: 0.8s - Train loss: 0.1079, Val loss: 0.1923, Learning rate: 0.000100
  Multiclass: Train acc: 0.9138, Val acc: 0.8427, Val F1: 0.8417
  Contralateral: Train acc: 0.9331, Val acc: 0.9146, Val F1: 0.9119
  Ipsilateral: Train acc: 0.9745, Val acc: 0.9303, Val F1: 0.9317
New best model saved (val_loss: 0.1923)
Epoch 31 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.49it/s, loss=0.1015]
Epoch 31 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.24it/s, loss=0.1859]
Epoch 32 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 157.94it/s, loss=0.0961]
Epoch 32 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 120.05it/s, loss=0.1899]
Epoch 31/100 - Time: 0.9s - Train loss: 0.1015, Val loss: 0.1859, Learning rate: 0.000100
  Multiclass: Train acc: 0.9148, Val acc: 0.8607, Val F1: 0.8608
  Contralateral: Train acc: 0.9393, Val acc: 0.9236, Val F1: 0.9231
  Ipsilateral: Train acc: 0.9754, Val acc: 0.9303, Val F1: 0.9311
New best model saved (val_loss: 0.1859)
Epoch 32/100 - Time: 0.8s - Train loss: 0.0961, Val loss: 0.1899, Learning rate: 0.000100
  Multiclass: Train acc: 0.9292, Val acc: 0.8472, Val F1: 0.8476
  Contralateral: Train acc: 0.9432, Val acc: 0.9146, Val F1: 0.9135
  Ipsilateral: Train acc: 0.9716, Val acc: 0.9348, Val F1: 0.9368
Epoch 33 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 158.62it/s, loss=0.0935]
Epoch 33 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 118.95it/s, loss=0.1927]
Epoch 33/100 - Time: 0.8s - Train loss: 0.0935, Val loss: 0.1927, Learning rate: 0.000100
  Multiclass: Train acc: 0.9292, Val acc: 0.8404, Val F1: 0.8401
  Contralateral: Train acc: 0.9485, Val acc: 0.9146, Val F1: 0.9125
  Ipsilateral: Train acc: 0.9745, Val acc: 0.9326, Val F1: 0.9350
Epoch 34 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 154.77it/s, loss=0.0902]
Epoch 34 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 112.80it/s, loss=0.1876]
Epoch 34/100 - Time: 0.9s - Train loss: 0.0902, Val loss: 0.1876, Learning rate: 0.000100
  Multiclass: Train acc: 0.9287, Val acc: 0.8584, Val F1: 0.8586
  Contralateral: Train acc: 0.9466, Val acc: 0.9236, Val F1: 0.9223
  Ipsilateral: Train acc: 0.9730, Val acc: 0.9371, Val F1: 0.9391
Epoch 35 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.82it/s, loss=0.0843]
Epoch 35 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.67it/s, loss=0.1815]
Epoch 35/100 - Time: 0.9s - Train loss: 0.0843, Val loss: 0.1815, Learning rate: 0.000100
  Multiclass: Train acc: 0.9268, Val acc: 0.8472, Val F1: 0.8474
  Contralateral: Train acc: 0.9533, Val acc: 0.9236, Val F1: 0.9234
  Ipsilateral: Train acc: 0.9769, Val acc: 0.9326, Val F1: 0.9337
New best model saved (val_loss: 0.1815)
Epoch 36 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.23it/s, loss=0.0839]
Epoch 36 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 114.30it/s, loss=0.1780]
Epoch 37 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.51it/s, loss=0.0801]
Epoch 37 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.58it/s, loss=0.1843]
Epoch 36/100 - Time: 0.9s - Train loss: 0.0839, Val loss: 0.1780, Learning rate: 0.000100
  Multiclass: Train acc: 0.9350, Val acc: 0.8472, Val F1: 0.8476
  Contralateral: Train acc: 0.9523, Val acc: 0.9213, Val F1: 0.9210
  Ipsilateral: Train acc: 0.9726, Val acc: 0.9348, Val F1: 0.9366
New best model saved (val_loss: 0.1780)
Epoch 38 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.22it/s, loss=0.0758]
Epoch 38 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 109.61it/s, loss=0.1765]
Epoch 37/100 - Time: 0.9s - Train loss: 0.0801, Val loss: 0.1843, Learning rate: 0.000100
  Multiclass: Train acc: 0.9292, Val acc: 0.8607, Val F1: 0.8606
  Contralateral: Train acc: 0.9528, Val acc: 0.9281, Val F1: 0.9269
  Ipsilateral: Train acc: 0.9788, Val acc: 0.9393, Val F1: 0.9412
Epoch 39 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.48it/s, loss=0.0754]
Epoch 39 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 109.20it/s, loss=0.1767]
Epoch 38/100 - Time: 0.9s - Train loss: 0.0758, Val loss: 0.1765, Learning rate: 0.000100
  Multiclass: Train acc: 0.9355, Val acc: 0.8562, Val F1: 0.8564
  Contralateral: Train acc: 0.9567, Val acc: 0.9191, Val F1: 0.9191
  Ipsilateral: Train acc: 0.9740, Val acc: 0.9371, Val F1: 0.9391
New best model saved (val_loss: 0.1765)
Epoch 40 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.02it/s, loss=0.0725]
Epoch 40 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.78it/s, loss=0.1831]
Epoch 39/100 - Time: 0.8s - Train loss: 0.0754, Val loss: 0.1767, Learning rate: 0.000100
  Multiclass: Train acc: 0.9437, Val acc: 0.8607, Val F1: 0.8608
  Contralateral: Train acc: 0.9581, Val acc: 0.9213, Val F1: 0.9207
  Ipsilateral: Train acc: 0.9759, Val acc: 0.9393, Val F1: 0.9409
Epoch 41 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 155.53it/s, loss=0.0715]
Epoch 41 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 110.69it/s, loss=0.1822]
Epoch 40/100 - Time: 0.9s - Train loss: 0.0725, Val loss: 0.1831, Learning rate: 0.000100
  Multiclass: Train acc: 0.9422, Val acc: 0.8719, Val F1: 0.8714
  Contralateral: Train acc: 0.9624, Val acc: 0.9326, Val F1: 0.9304
  Ipsilateral: Train acc: 0.9726, Val acc: 0.9438, Val F1: 0.9451
Epoch 42 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 156.21it/s, loss=0.0653]
Epoch 42 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 111.52it/s, loss=0.1820]
Epoch 41/100 - Time: 0.9s - Train loss: 0.0715, Val loss: 0.1822, Learning rate: 0.000100
  Multiclass: Train acc: 0.9427, Val acc: 0.8652, Val F1: 0.8650
  Contralateral: Train acc: 0.9629, Val acc: 0.9236, Val F1: 0.9229
  Ipsilateral: Train acc: 0.9774, Val acc: 0.9393, Val F1: 0.9405
Epoch 43 (Train): 100%|█████████████████| 65/65 [00:00<00:00, 153.92it/s, loss=0.0670]
Epoch 43 (Val): 100%|███████████████████| 14/14 [00:00<00:00, 113.53it/s, loss=0.1826]
Epoch 42/100 - Time: 0.9s - Train loss: 0.0653, Val loss: 0.1820, Learning rate: 0.000100
  Multiclass: Train acc: 0.9504, Val acc: 0.8607, Val F1: 0.8605
  Contralateral: Train acc: 0.9610, Val acc: 0.9258, Val F1: 0.9245
  Ipsilateral: Train acc: 0.9817, Val acc: 0.9393, Val F1: 0.9402
Evaluating: 100%|████████████████████████████████████| 14/14 [00:00<00:00, 120.93it/s]
Epoch 43/100 - Time: 0.9s - Train loss: 0.0670, Val loss: 0.1826, Learning rate: 0.000100
  Multiclass: Train acc: 0.9422, Val acc: 0.8674, Val F1: 0.8668
  Contralateral: Train acc: 0.9600, Val acc: 0.9303, Val F1: 0.9285
  Ipsilateral: Train acc: 0.9783, Val acc: 0.9438, Val F1: 0.9447
Early stopping triggered after 43 epochs
Best model was at epoch 38
Training completed in 39.8s. Best validation loss: 0.1765
Loaded model from checkpoint (epoch 38)
Evaluating model on test set...
Multiclass Metrics:
  accuracy: 0.8139
  precision: 0.8227
  recall: 0.8139
  f1: 0.8163
Contralateral Metrics:
  accuracy: 0.8879
  precision: 0.8923
  recall: 0.8879
  f1: 0.8896
Ipsilateral Metrics:
  accuracy: 0.9215
  precision: 0.9266
  recall: 0.9215
  f1: 0.9235
Overall Accuracy: 0.8744
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Saved combined metrics to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/combined_metrics.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json