Epoch 1 (Train): 100%|█████████████| 32/32 [00:00<00:00, 84.08it/s, loss=0.2523]
Epoch 1 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 62.94it/s, loss=0.2457]
Epoch 2 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.24it/s, loss=0.2484]
Epoch 2 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 61.61it/s, loss=0.2439]
WandB initialized successfully!
Starting training...
Starting training for lstm model...
Using device: cuda
Model parameters: 164,551 total, 164,551 trainable
Epoch 1/30 - Time: 1.2s - Train loss: 0.2523, Val loss: 0.2457, Learning rate: 0.000100
  Multiclass: Train acc: 0.4224, Val acc: 0.3624, Val F1: 0.3830
  Contralateral: Train acc: 0.6875, Val acc: 0.6197, Val F1: 0.2130
  Ipsilateral: Train acc: 0.3384, Val acc: 0.6823, Val F1: 0.2198
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2457)
Epoch 3 (Train): 100%|████████████| 32/32 [00:00<00:00, 114.32it/s, loss=0.2448]
Epoch 3 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 61.64it/s, loss=0.2415]
Epoch 4 (Train): 100%|████████████| 32/32 [00:00<00:00, 116.47it/s, loss=0.2416]
Epoch 4 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 61.46it/s, loss=0.2396]
Epoch 5 (Train):   9%|█▎            | 3/32 [00:00<00:00, 29.90it/s, loss=0.2436]
Epoch 2/30 - Time: 0.8s - Train loss: 0.2484, Val loss: 0.2439, Learning rate: 0.000100
  Multiclass: Train acc: 0.3711, Val acc: 0.4139, Val F1: 0.4290
  Contralateral: Train acc: 0.6714, Val acc: 0.6689, Val F1: 0.2128
  Ipsilateral: Train acc: 0.4497, Val acc: 0.5884, Val F1: 0.2333
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2439)
Validation score improved from 0.2457 to 0.2439
Epoch 3/30 - Time: 0.8s - Train loss: 0.2448, Val loss: 0.2415, Learning rate: 0.000100
  Multiclass: Train acc: 0.3813, Val acc: 0.4072, Val F1: 0.4299
  Contralateral: Train acc: 0.6479, Val acc: 0.6667, Val F1: 0.2359
  Ipsilateral: Train acc: 0.5498, Val acc: 0.6957, Val F1: 0.1807
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2415)
Validation score improved from 0.2439 to 0.2415
Epoch 4/30 - Time: 0.8s - Train loss: 0.2416, Val loss: 0.2396, Learning rate: 0.000100
  Multiclass: Train acc: 0.3779, Val acc: 0.3937, Val F1: 0.4131
  Contralateral: Train acc: 0.6567, Val acc: 0.7002, Val F1: 0.3021
  Ipsilateral: Train acc: 0.6348, Val acc: 0.7539, Val F1: 0.1538
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2396)
Epoch 5 (Train): 100%|████████████| 32/32 [00:00<00:00, 116.36it/s, loss=0.2399]
Epoch 5 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 60.50it/s, loss=0.2377]
Epoch 6 (Train): 100%|████████████| 32/32 [00:00<00:00, 116.75it/s, loss=0.2361]
Epoch 6 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 60.92it/s, loss=0.2356]
Epoch 7 (Train): 100%|████████████| 32/32 [00:00<00:00, 114.30it/s, loss=0.2340]
Epoch 7 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 59.37it/s, loss=0.2332]
Epoch 5/30 - Time: 0.8s - Train loss: 0.2399, Val loss: 0.2377, Learning rate: 0.000100
  Multiclass: Train acc: 0.3799, Val acc: 0.3960, Val F1: 0.4127
  Contralateral: Train acc: 0.6494, Val acc: 0.6935, Val F1: 0.3382
  Ipsilateral: Train acc: 0.6733, Val acc: 0.7830, Val F1: 0.1101
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2377)
Validation score improved from 0.2396 to 0.2377
Epoch 6/30 - Time: 0.8s - Train loss: 0.2361, Val loss: 0.2356, Learning rate: 0.000100
  Multiclass: Train acc: 0.4121, Val acc: 0.3960, Val F1: 0.4100
  Contralateral: Train acc: 0.6670, Val acc: 0.7069, Val F1: 0.3350
  Ipsilateral: Train acc: 0.7104, Val acc: 0.7830, Val F1: 0.0202
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2356)
Validation score improved from 0.2377 to 0.2356
Epoch 8 (Train): 100%|████████████| 32/32 [00:00<00:00, 114.15it/s, loss=0.2306]
Epoch 8 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 59.48it/s, loss=0.2307]
Epoch 9 (Train): 100%|████████████| 32/32 [00:00<00:00, 115.47it/s, loss=0.2271]
Epoch 9 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 59.79it/s, loss=0.2275]
Epoch 10 (Train):   9%|█▏           | 3/32 [00:00<00:00, 29.49it/s, loss=0.2219]
Epoch 7/30 - Time: 0.9s - Train loss: 0.2340, Val loss: 0.2332, Learning rate: 0.000100
  Multiclass: Train acc: 0.4136, Val acc: 0.4206, Val F1: 0.4346
  Contralateral: Train acc: 0.6670, Val acc: 0.7204, Val F1: 0.3655
  Ipsilateral: Train acc: 0.7285, Val acc: 0.8076, Val F1: 0.0227
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2332)
Validation score improved from 0.2356 to 0.2332
Epoch 8/30 - Time: 0.8s - Train loss: 0.2306, Val loss: 0.2307, Learning rate: 0.000100
  Multiclass: Train acc: 0.4146, Val acc: 0.4273, Val F1: 0.4380
  Contralateral: Train acc: 0.7095, Val acc: 0.7383, Val F1: 0.4236
  Ipsilateral: Train acc: 0.7617, Val acc: 0.8233, Val F1: 0.0247
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2307)
Validation score improved from 0.2332 to 0.2307
Epoch 9/30 - Time: 0.8s - Train loss: 0.2271, Val loss: 0.2275, Learning rate: 0.000100
  Multiclass: Train acc: 0.4585, Val acc: 0.4474, Val F1: 0.4571
  Contralateral: Train acc: 0.7012, Val acc: 0.7584, Val F1: 0.4490
  Ipsilateral: Train acc: 0.7744, Val acc: 0.8210, Val F1: 0.0244
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2275)
Epoch 10 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.96it/s, loss=0.2248]
Epoch 10 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.34it/s, loss=0.2238]
Epoch 11 (Train): 100%|███████████| 32/32 [00:00<00:00, 115.12it/s, loss=0.2187]
Epoch 11 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.37it/s, loss=0.2195]
Epoch 12 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.88it/s, loss=0.2137]
Epoch 12 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.92it/s, loss=0.2144]
Epoch 10/30 - Time: 0.8s - Train loss: 0.2248, Val loss: 0.2238, Learning rate: 0.000100
  Multiclass: Train acc: 0.4702, Val acc: 0.4564, Val F1: 0.4650
  Contralateral: Train acc: 0.7173, Val acc: 0.7629, Val F1: 0.4646
  Ipsilateral: Train acc: 0.7744, Val acc: 0.8210, Val F1: 0.0244
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2238)
Validation score improved from 0.2275 to 0.2238
Epoch 11/30 - Time: 0.8s - Train loss: 0.2187, Val loss: 0.2195, Learning rate: 0.000100
  Multiclass: Train acc: 0.4785, Val acc: 0.4698, Val F1: 0.4756
  Contralateral: Train acc: 0.7285, Val acc: 0.7785, Val F1: 0.5123
  Ipsilateral: Train acc: 0.7822, Val acc: 0.8188, Val F1: 0.0000
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2195)
Validation score improved from 0.2238 to 0.2195
Epoch 13 (Train): 100%|███████████| 32/32 [00:00<00:00, 110.13it/s, loss=0.2068]
Epoch 13 (Val): 100%|████████████████| 7/7 [00:00<00:00, 56.66it/s, loss=0.2086]
Epoch 14 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.27it/s, loss=0.1990]
Epoch 14 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.47it/s, loss=0.2011]
Epoch 15 (Train):   0%|                                  | 0/32 [00:00<?, ?it/s]
Epoch 12/30 - Time: 0.8s - Train loss: 0.2137, Val loss: 0.2144, Learning rate: 0.000100
  Multiclass: Train acc: 0.5186, Val acc: 0.4966, Val F1: 0.4990
  Contralateral: Train acc: 0.7456, Val acc: 0.7830, Val F1: 0.5359
  Ipsilateral: Train acc: 0.7852, Val acc: 0.8188, Val F1: 0.0000
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2144)
Validation score improved from 0.2195 to 0.2144
Epoch 13/30 - Time: 1.0s - Train loss: 0.2068, Val loss: 0.2086, Learning rate: 0.000100
  Multiclass: Train acc: 0.5327, Val acc: 0.4989, Val F1: 0.5023
  Contralateral: Train acc: 0.7534, Val acc: 0.7942, Val F1: 0.5660
  Ipsilateral: Train acc: 0.7837, Val acc: 0.8166, Val F1: 0.0000
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2086)
Epoch 15 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.53it/s, loss=0.1907]
Epoch 15 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.40it/s, loss=0.1926]
Epoch 16 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.60it/s, loss=0.1776]
Epoch 16 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.19it/s, loss=0.1834]
Epoch 17 (Train): 100%|███████████| 32/32 [00:00<00:00, 115.12it/s, loss=0.1726]
Epoch 17 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.68it/s, loss=0.1743]
Epoch 14/30 - Time: 0.8s - Train loss: 0.1990, Val loss: 0.2011, Learning rate: 0.000100
  Multiclass: Train acc: 0.5630, Val acc: 0.5190, Val F1: 0.5215
  Contralateral: Train acc: 0.7832, Val acc: 0.8054, Val F1: 0.6266
  Ipsilateral: Train acc: 0.7861, Val acc: 0.8121, Val F1: 0.0233
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2011)
Validation score improved from 0.2086 to 0.2011
Epoch 15/30 - Time: 0.8s - Train loss: 0.1907, Val loss: 0.1926, Learning rate: 0.000100
  Multiclass: Train acc: 0.5786, Val acc: 0.5638, Val F1: 0.5656
  Contralateral: Train acc: 0.7988, Val acc: 0.8166, Val F1: 0.6612
  Ipsilateral: Train acc: 0.7871, Val acc: 0.8054, Val F1: 0.1031
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1926)
Validation score improved from 0.2011 to 0.1926
Epoch 16/30 - Time: 0.8s - Train loss: 0.1776, Val loss: 0.1834, Learning rate: 0.000100
  Multiclass: Train acc: 0.6113, Val acc: 0.5682, Val F1: 0.5652
  Contralateral: Train acc: 0.8228, Val acc: 0.8031, Val F1: 0.6562
  Ipsilateral: Train acc: 0.7905, Val acc: 0.8054, Val F1: 0.2018
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1834)
Validation score improved from 0.1926 to 0.1834
Epoch 18 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.18it/s, loss=0.1579]
Epoch 18 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.80it/s, loss=0.1646]
Epoch 19 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.29it/s, loss=0.1493]
Epoch 19 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.74it/s, loss=0.1564]
Epoch 20 (Train):  69%|███████▌   | 22/32 [00:00<00:00, 118.78it/s, loss=0.1382]
Epoch 17/30 - Time: 0.8s - Train loss: 0.1726, Val loss: 0.1743, Learning rate: 0.000100
  Multiclass: Train acc: 0.6084, Val acc: 0.5839, Val F1: 0.5808
  Contralateral: Train acc: 0.8252, Val acc: 0.8076, Val F1: 0.6692
  Ipsilateral: Train acc: 0.7837, Val acc: 0.7919, Val F1: 0.2439
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1743)
Validation score improved from 0.1834 to 0.1743
Epoch 18/30 - Time: 0.8s - Train loss: 0.1579, Val loss: 0.1646, Learning rate: 0.000100
  Multiclass: Train acc: 0.6494, Val acc: 0.5928, Val F1: 0.5888
  Contralateral: Train acc: 0.8408, Val acc: 0.8054, Val F1: 0.6692
  Ipsilateral: Train acc: 0.7886, Val acc: 0.7919, Val F1: 0.3673
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1646)
Validation score improved from 0.1743 to 0.1646
Epoch 19/30 - Time: 0.8s - Train loss: 0.1493, Val loss: 0.1564, Learning rate: 0.000100
  Multiclass: Train acc: 0.6782, Val acc: 0.5996, Val F1: 0.5947
  Contralateral: Train acc: 0.8604, Val acc: 0.8054, Val F1: 0.6766
  Ipsilateral: Train acc: 0.7915, Val acc: 0.7875, Val F1: 0.4444
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1564)
Epoch 20 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.94it/s, loss=0.1372]
Epoch 20 (Val): 100%|████████████████| 7/7 [00:00<00:00, 60.47it/s, loss=0.1479]
Epoch 21 (Train): 100%|███████████| 32/32 [00:00<00:00, 113.29it/s, loss=0.1326]
Epoch 21 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.25it/s, loss=0.1408]
Epoch 22 (Train): 100%|███████████| 32/32 [00:00<00:00, 112.65it/s, loss=0.1209]
Epoch 22 (Val): 100%|████████████████| 7/7 [00:00<00:00, 57.81it/s, loss=0.1318]
Epoch 20/30 - Time: 0.9s - Train loss: 0.1372, Val loss: 0.1479, Learning rate: 0.000100
  Multiclass: Train acc: 0.6968, Val acc: 0.6286, Val F1: 0.6272
  Contralateral: Train acc: 0.8652, Val acc: 0.8233, Val F1: 0.6902
  Ipsilateral: Train acc: 0.7993, Val acc: 0.8009, Val F1: 0.5083
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1479)
Validation score improved from 0.1564 to 0.1479
Epoch 21/30 - Time: 0.8s - Train loss: 0.1326, Val loss: 0.1408, Learning rate: 0.000100
  Multiclass: Train acc: 0.7114, Val acc: 0.6443, Val F1: 0.6477
  Contralateral: Train acc: 0.8701, Val acc: 0.8345, Val F1: 0.7063
  Ipsilateral: Train acc: 0.7998, Val acc: 0.8210, Val F1: 0.5699
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1408)
Validation score improved from 0.1479 to 0.1408
Epoch 23 (Train): 100%|███████████| 32/32 [00:00<00:00, 115.39it/s, loss=0.1120]
Epoch 23 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.45it/s, loss=0.1257]
Epoch 24 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.05it/s, loss=0.1028]
Epoch 24 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.45it/s, loss=0.1220]
Epoch 25 (Train):   9%|█▏           | 3/32 [00:00<00:00, 29.36it/s, loss=0.0995]
Epoch 22/30 - Time: 0.8s - Train loss: 0.1209, Val loss: 0.1318, Learning rate: 0.000100
  Multiclass: Train acc: 0.7305, Val acc: 0.6644, Val F1: 0.6679
  Contralateral: Train acc: 0.8735, Val acc: 0.8367, Val F1: 0.7160
  Ipsilateral: Train acc: 0.8188, Val acc: 0.8434, Val F1: 0.6237
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1318)
Validation score improved from 0.1408 to 0.1318
Epoch 23/30 - Time: 0.8s - Train loss: 0.1120, Val loss: 0.1257, Learning rate: 0.000100
  Multiclass: Train acc: 0.7422, Val acc: 0.7002, Val F1: 0.7045
  Contralateral: Train acc: 0.8843, Val acc: 0.8479, Val F1: 0.7280
  Ipsilateral: Train acc: 0.8271, Val acc: 0.8501, Val F1: 0.6339
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1257)
Validation score improved from 0.1318 to 0.1257
Epoch 24/30 - Time: 0.8s - Train loss: 0.1028, Val loss: 0.1220, Learning rate: 0.000100
  Multiclass: Train acc: 0.7563, Val acc: 0.7025, Val F1: 0.7075
  Contralateral: Train acc: 0.8955, Val acc: 0.8568, Val F1: 0.7440
  Ipsilateral: Train acc: 0.8486, Val acc: 0.8523, Val F1: 0.6526
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1220)
Epoch 25 (Train): 100%|███████████| 32/32 [00:00<00:00, 110.86it/s, loss=0.0988]
Epoch 25 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.33it/s, loss=0.1154]
Epoch 26 (Train): 100%|███████████| 32/32 [00:00<00:00, 109.24it/s, loss=0.0908]
Epoch 26 (Val): 100%|████████████████| 7/7 [00:00<00:00, 57.58it/s, loss=0.1101]
Epoch 27 (Train): 100%|███████████| 32/32 [00:00<00:00, 110.32it/s, loss=0.0860]
Epoch 27 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.22it/s, loss=0.1047]
Epoch 25/30 - Time: 0.8s - Train loss: 0.0988, Val loss: 0.1154, Learning rate: 0.000100
  Multiclass: Train acc: 0.7812, Val acc: 0.7114, Val F1: 0.7156
  Contralateral: Train acc: 0.9043, Val acc: 0.8591, Val F1: 0.7529
  Ipsilateral: Train acc: 0.8462, Val acc: 0.8680, Val F1: 0.6878
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1154)
Validation score improved from 0.1220 to 0.1154
Epoch 26/30 - Time: 0.9s - Train loss: 0.0908, Val loss: 0.1101, Learning rate: 0.000100
  Multiclass: Train acc: 0.7920, Val acc: 0.7204, Val F1: 0.7241
  Contralateral: Train acc: 0.9067, Val acc: 0.8591, Val F1: 0.7623
  Ipsilateral: Train acc: 0.8560, Val acc: 0.8725, Val F1: 0.6919
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1101)
Validation score improved from 0.1154 to 0.1101
Epoch 28 (Train): 100%|███████████| 32/32 [00:00<00:00, 111.50it/s, loss=0.0816]
Epoch 28 (Val): 100%|████████████████| 7/7 [00:00<00:00, 59.12it/s, loss=0.1023]
Epoch 29 (Train): 100%|███████████| 32/32 [00:00<00:00, 111.35it/s, loss=0.0767]
Epoch 29 (Val): 100%|████████████████| 7/7 [00:00<00:00, 58.49it/s, loss=0.1011]
Epoch 30 (Train):   9%|█▏           | 3/32 [00:00<00:00, 29.23it/s, loss=0.0720]
Epoch 27/30 - Time: 0.8s - Train loss: 0.0860, Val loss: 0.1047, Learning rate: 0.000100
  Multiclass: Train acc: 0.8047, Val acc: 0.7226, Val F1: 0.7247
  Contralateral: Train acc: 0.9185, Val acc: 0.8568, Val F1: 0.7612
  Ipsilateral: Train acc: 0.8652, Val acc: 0.8680, Val F1: 0.6811
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1047)
Validation score improved from 0.1101 to 0.1047
Epoch 28/30 - Time: 0.8s - Train loss: 0.0816, Val loss: 0.1023, Learning rate: 0.000100
  Multiclass: Train acc: 0.8184, Val acc: 0.7427, Val F1: 0.7486
  Contralateral: Train acc: 0.9131, Val acc: 0.8747, Val F1: 0.7686
  Ipsilateral: Train acc: 0.8760, Val acc: 0.8635, Val F1: 0.6806
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1023)
Validation score improved from 0.1047 to 0.1023
Epoch 29/30 - Time: 0.8s - Train loss: 0.0767, Val loss: 0.1011, Learning rate: 0.000100
  Multiclass: Train acc: 0.8174, Val acc: 0.7629, Val F1: 0.7694
  Contralateral: Train acc: 0.9233, Val acc: 0.8747, Val F1: 0.7705
  Ipsilateral: Train acc: 0.8931, Val acc: 0.8680, Val F1: 0.6911
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.1011)
Epoch 30 (Train): 100%|███████████| 32/32 [00:00<00:00, 114.92it/s, loss=0.0724]
Epoch 30 (Val): 100%|████████████████| 7/7 [00:00<00:00, 56.62it/s, loss=0.0950]
Evaluating: 100%|████████████████████| 8/8 [00:00<00:00, 60.73it/s, loss=0.0562]
Epoch 30/30 - Time: 0.8s - Train loss: 0.0724, Val loss: 0.0950, Learning rate: 0.000100
  Multiclass: Train acc: 0.8447, Val acc: 0.7629, Val F1: 0.7675
  Contralateral: Train acc: 0.9219, Val acc: 0.8859, Val F1: 0.7935
  Ipsilateral: Train acc: 0.8950, Val acc: 0.8702, Val F1: 0.6947
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.0950)
Validation score improved from 0.1011 to 0.0950
Training completed in 24.5s. Best validation loss: 0.0950
Loaded model from checkpoint (epoch 30)
Evaluating model on test set...
Multiclass Test Metrics:
  accuracy: 0.7916
  precision: 0.8169
  recall: 0.7916
  f1: 0.7936
Contralateral Test Metrics:
  accuracy: 0.8670
  precision: 0.6897
  recall: 0.8696
  f1: 0.7692
Ipsilateral Test Metrics:
  accuracy: 0.9002
  precision: 0.6842
  recall: 0.8125
  f1: 0.7429
Overall Test Accuracy: 0.8529
Generating visualizations...
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json