Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 108.55it/s, loss=1.1949]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.29it/s]
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 156.45it/s, loss=1.0907]
Epoch 2 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 138.45it/s]
Epoch 3 (Train):  75%|██████████████▎    | 49/65 [00:00<00:00, 175.87it/s, loss=0.9911]
Starting training for lstm model...
Epoch 1/100 - Train loss: 1.1949, Val loss: 1.0924, Learning rate: 0.001000
  Multiclass: Train acc: 0.5099, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6803, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7853, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0924)
Epoch 2/100 - Train loss: 1.0907, Val loss: 1.0276, Learning rate: 0.001000
  Multiclass: Train acc: 0.5662, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0276)
Epoch 3/100 - Train loss: 0.9867, Val loss: 0.9140, Learning rate: 0.001000
  Multiclass: Train acc: 0.5778, Val acc: 0.6045, Val F1: 0.4987
  Contralateral: Train acc: 0.7439, Val acc: 0.7820, Val F1: 0.2240
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9140)
Epoch 4/100 - Train loss: 0.8367, Val loss: 0.7161, Learning rate: 0.001000
  Multiclass: Train acc: 0.6143, Val acc: 0.6427, Val F1: 0.5746
  Contralateral: Train acc: 0.7737, Val acc: 0.8247, Val F1: 0.5938
  Ipsilateral: Train acc: 0.8252, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7161)
Epoch 5/100 - Train loss: 0.6484, Val loss: 0.5684, Learning rate: 0.001000
  Multiclass: Train acc: 0.6923, Val acc: 0.7573, Val F1: 0.7530
  Contralateral: Train acc: 0.8291, Val acc: 0.8562, Val F1: 0.6981
  Ipsilateral: Train acc: 0.8459, Val acc: 0.8652, Val F1: 0.5455
New best model saved (val_loss: 0.5684)
Epoch 6/100 - Train loss: 0.5190, Val loss: 0.5120, Learning rate: 0.001000
  Multiclass: Train acc: 0.7655, Val acc: 0.7685, Val F1: 0.7698
  Contralateral: Train acc: 0.8700, Val acc: 0.8809, Val F1: 0.7512
  Ipsilateral: Train acc: 0.8719, Val acc: 0.8809, Val F1: 0.7196
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 167.14it/s, loss=0.9867]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 138.14it/s]
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.01it/s, loss=0.8367]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.06it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.09it/s, loss=0.6484]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.78it/s]
Epoch 6 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.09it/s, loss=0.5190]
Epoch 6 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 129.05it/s]
Epoch 7 (Train):  43%|████████▏          | 28/65 [00:00<00:00, 148.61it/s, loss=0.4464]
Epoch 7/100 - Train loss: 0.4490, Val loss: 0.4433, Learning rate: 0.001000
  Multiclass: Train acc: 0.7915, Val acc: 0.7955, Val F1: 0.7962
  Contralateral: Train acc: 0.8883, Val acc: 0.8831, Val F1: 0.7679
  Ipsilateral: Train acc: 0.8830, Val acc: 0.9056, Val F1: 0.7586
New best model saved (val_loss: 0.4433)
Epoch 8/100 - Train loss: 0.4122, Val loss: 0.4744, Learning rate: 0.001000
  Multiclass: Train acc: 0.8156, Val acc: 0.7775, Val F1: 0.7785
  Contralateral: Train acc: 0.8907, Val acc: 0.8652, Val F1: 0.7414
  Ipsilateral: Train acc: 0.9047, Val acc: 0.8989, Val F1: 0.7305
Epoch 9/100 - Train loss: 0.3589, Val loss: 0.4315, Learning rate: 0.001000
  Multiclass: Train acc: 0.8503, Val acc: 0.7978, Val F1: 0.7985
  Contralateral: Train acc: 0.9148, Val acc: 0.8742, Val F1: 0.7565
  Ipsilateral: Train acc: 0.9138, Val acc: 0.9258, Val F1: 0.8000
New best model saved (val_loss: 0.4315)
Epoch 10/100 - Train loss: 0.3562, Val loss: 0.4628, Learning rate: 0.001000
  Multiclass: Train acc: 0.8681, Val acc: 0.8270, Val F1: 0.8279
  Contralateral: Train acc: 0.9220, Val acc: 0.8921, Val F1: 0.8000
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 166.31it/s, loss=0.4490]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 127.97it/s]
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.86it/s, loss=0.4122]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 130.78it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 163.61it/s, loss=0.3589]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 128.93it/s]
Epoch 10 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 167.76it/s, loss=0.3562]
Epoch 10 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 137.97it/s]
Epoch 11 (Train):  42%|███████▍          | 27/65 [00:00<00:00, 143.83it/s, loss=0.2601]
Epoch 11/100 - Train loss: 0.2802, Val loss: 0.4330, Learning rate: 0.001000
  Multiclass: Train acc: 0.8888, Val acc: 0.8090, Val F1: 0.8103
  Contralateral: Train acc: 0.9374, Val acc: 0.8787, Val F1: 0.7652
  Ipsilateral: Train acc: 0.9475, Val acc: 0.9213, Val F1: 0.8045
Epoch 12/100 - Train loss: 0.2818, Val loss: 0.4013, Learning rate: 0.001000
  Multiclass: Train acc: 0.8907, Val acc: 0.8315, Val F1: 0.8319
  Contralateral: Train acc: 0.9307, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.9543, Val acc: 0.9348, Val F1: 0.8362
New best model saved (val_loss: 0.4013)
Epoch 13/100 - Train loss: 0.2538, Val loss: 0.4507, Learning rate: 0.001000
  Multiclass: Train acc: 0.9167, Val acc: 0.8449, Val F1: 0.8448
  Contralateral: Train acc: 0.9490, Val acc: 0.9079, Val F1: 0.8075
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9416, Val F1: 0.8471
Epoch 14/100 - Train loss: 0.2336, Val loss: 0.4511, Learning rate: 0.001000
  Multiclass: Train acc: 0.9191, Val acc: 0.8472, Val F1: 0.8474
  Contralateral: Train acc: 0.9504, Val acc: 0.9079, Val F1: 0.8210
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.56it/s, loss=0.2802]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.71it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.61it/s, loss=0.2818]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.61it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.14it/s, loss=0.2538]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.42it/s]
Epoch 14 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.31it/s, loss=0.2336]
Epoch 14 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.98it/s]
Epoch 15 (Train):  43%|███████▊          | 28/65 [00:00<00:00, 148.53it/s, loss=0.1916]
Epoch 15/100 - Train loss: 0.2270, Val loss: 0.4458, Learning rate: 0.001000
  Multiclass: Train acc: 0.9177, Val acc: 0.8360, Val F1: 0.8367
  Contralateral: Train acc: 0.9475, Val acc: 0.9011, Val F1: 0.8103
  Ipsilateral: Train acc: 0.9653, Val acc: 0.9348, Val F1: 0.8343
Epoch 16/100 - Train loss: 0.2012, Val loss: 0.4498, Learning rate: 0.001000
  Multiclass: Train acc: 0.9350, Val acc: 0.8539, Val F1: 0.8539
  Contralateral: Train acc: 0.9591, Val acc: 0.9124, Val F1: 0.8186
  Ipsilateral: Train acc: 0.9754, Val acc: 0.9416, Val F1: 0.8506
Epoch 17/100 - Train loss: 0.2128, Val loss: 0.4404, Learning rate: 0.001000
  Multiclass: Train acc: 0.9249, Val acc: 0.8629, Val F1: 0.8633
  Contralateral: Train acc: 0.9576, Val acc: 0.9079, Val F1: 0.8178
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.67it/s, loss=0.2270]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 129.06it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.77it/s, loss=0.2012]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.00it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.62it/s, loss=0.2128]
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 130.24it/s]
Epoch 18 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.98it/s, loss=0.2019]
Epoch 18 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.69it/s]
Epoch 19 (Train):   9%|█▊                  | 6/65 [00:00<00:00, 59.11it/s, loss=0.1119]
Epoch 00018: reducing learning rate of group 0 to 5.0000e-04.
Epoch 18/100 - Train loss: 0.2019, Val loss: 0.4296, Learning rate: 0.000500
  Multiclass: Train acc: 0.9312, Val acc: 0.8584, Val F1: 0.8587
  Contralateral: Train acc: 0.9571, Val acc: 0.9303, Val F1: 0.8584
  Ipsilateral: Train acc: 0.9701, Val acc: 0.9303, Val F1: 0.8187
Epoch 19/100 - Train loss: 0.1327, Val loss: 0.4443, Learning rate: 0.000500
  Multiclass: Train acc: 0.9456, Val acc: 0.8607, Val F1: 0.8612
  Contralateral: Train acc: 0.9644, Val acc: 0.9281, Val F1: 0.8571
  Ipsilateral: Train acc: 0.9783, Val acc: 0.9303, Val F1: 0.8229
Early stopping triggered after 19 epochs
Best model was at epoch 12
Training completed. Best validation loss: 0.4013
Evaluating on test set...
[2025-04-09 16:19:24,809][HYDRA] 	#1 : model=lstm model.hidden_size=32 model.num_layers=1 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, batch_first=True)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 62727
Starting training for lstm model...
Epoch 1/100 - Train loss: 1.3150, Val loss: 1.2790, Learning rate: 0.000100
  Multiclass: Train acc: 0.3495, Val acc: 0.4787, Val F1: 0.4178
  Contralateral: Train acc: 0.4892, Val acc: 0.5393, Val F1: 0.2807
  Ipsilateral: Train acc: 0.6837, Val acc: 0.8022, Val F1: 0.0222
New best model saved (val_loss: 1.2790)
Epoch 2/100 - Train loss: 1.2835, Val loss: 1.2407, Learning rate: 0.000100
  Multiclass: Train acc: 0.4343, Val acc: 0.5596, Val F1: 0.4216
  Contralateral: Train acc: 0.5407, Val acc: 0.6809, Val F1: 0.1647
  Ipsilateral: Train acc: 0.7443, Val acc: 0.8112, Val F1: 0.0000
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.40it/s, loss=0.1327]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 135.08it/s]
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 128.07it/s]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 167.45it/s, loss=1.3150]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.25it/s]
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.27it/s, loss=1.2835]
Epoch 2 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.53it/s]
Epoch 3 (Train):  40%|███████▌           | 26/65 [00:00<00:00, 141.06it/s, loss=1.2424]
Epoch 3/100 - Train loss: 1.2356, Val loss: 1.2072, Learning rate: 0.000100
  Multiclass: Train acc: 0.4988, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6115, Val acc: 0.7416, Val F1: 0.0650
  Ipsilateral: Train acc: 0.7747, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.2072)
Epoch 4/100 - Train loss: 1.2116, Val loss: 1.1784, Learning rate: 0.000100
  Multiclass: Train acc: 0.5243, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6668, Val acc: 0.7506, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8007, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1784)
Epoch 5/100 - Train loss: 1.1920, Val loss: 1.1582, Learning rate: 0.000100
  Multiclass: Train acc: 0.5412, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6644, Val acc: 0.7528, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8113, Val acc: 0.8112, Val F1: 0.0000
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 162.59it/s, loss=1.2356]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.96it/s]
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 166.84it/s, loss=1.2116]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 119.37it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.22it/s, loss=1.1920]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.93it/s]
Epoch 6 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 165.53it/s, loss=1.1696]
Epoch 6 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.25it/s]
Epoch 7 (Train):  12%|██▌                  | 8/65 [00:00<00:00, 76.90it/s, loss=1.1536]
Epoch 6/100 - Train loss: 1.1696, Val loss: 1.1391, Learning rate: 0.000100
  Multiclass: Train acc: 0.5484, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6967, Val acc: 0.7528, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8132, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1391)
Epoch 7/100 - Train loss: 1.1570, Val loss: 1.1199, Learning rate: 0.000100
  Multiclass: Train acc: 0.5518, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7164, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8146, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1199)
Epoch 8/100 - Train loss: 1.1394, Val loss: 1.1097, Learning rate: 0.000100
  Multiclass: Train acc: 0.5633, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7097, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1097)
Epoch 9/100 - Train loss: 1.1229, Val loss: 1.0958, Learning rate: 0.000100
  Multiclass: Train acc: 0.5623, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7236, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 168.47it/s, loss=1.1570]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 129.25it/s]
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.74it/s, loss=1.1394]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 121.90it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 160.02it/s, loss=1.1229]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 127.63it/s]
Epoch 10 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.73it/s, loss=1.1169]
Epoch 10 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.34it/s]
Epoch 11 (Train):   9%|█▊                  | 6/65 [00:00<00:01, 57.85it/s, loss=1.1271]
Epoch 10/100 - Train loss: 1.1169, Val loss: 1.0847, Learning rate: 0.000100
  Multiclass: Train acc: 0.5623, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7198, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0847)
Epoch 11/100 - Train loss: 1.0956, Val loss: 1.0753, Learning rate: 0.000100
  Multiclass: Train acc: 0.5667, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0753)
Epoch 12/100 - Train loss: 1.0769, Val loss: 1.0673, Learning rate: 0.000100
  Multiclass: Train acc: 0.5643, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7342, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0673)
Epoch 13/100 - Train loss: 1.0715, Val loss: 1.0543, Learning rate: 0.000100
  Multiclass: Train acc: 0.5686, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7246, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.64it/s, loss=1.0956]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.35it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.26it/s, loss=1.0769]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.25it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.21it/s, loss=1.0715]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 116.09it/s]
Epoch 14 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.34it/s, loss=1.0600]
Epoch 14 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.71it/s]
Epoch 15 (Train):   0%|                            | 0/65 [00:00<?, ?it/s, loss=1.0514]
Epoch 14/100 - Train loss: 1.0600, Val loss: 1.0441, Learning rate: 0.000100
  Multiclass: Train acc: 0.5686, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7434, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0441)
Epoch 15/100 - Train loss: 1.0462, Val loss: 1.0329, Learning rate: 0.000100
  Multiclass: Train acc: 0.5681, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7419, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0329)
Epoch 16/100 - Train loss: 1.0271, Val loss: 1.0188, Learning rate: 0.000100
  Multiclass: Train acc: 0.5710, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7443, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0188)
Epoch 17/100 - Train loss: 1.0175, Val loss: 1.0034, Learning rate: 0.000100
  Multiclass: Train acc: 0.5787, Val acc: 0.5708, Val F1: 0.4195
  Contralateral: Train acc: 0.7357, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.40it/s, loss=1.0462]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.55it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.66it/s, loss=1.0271]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.46it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.85it/s, loss=1.0175]
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.61it/s]
Epoch 18 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.84it/s, loss=1.0134]
Epoch 18 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.76it/s]
Epoch 19 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 18/100 - Train loss: 1.0134, Val loss: 0.9896, Learning rate: 0.000100
  Multiclass: Train acc: 0.5763, Val acc: 0.5775, Val F1: 0.4339
  Contralateral: Train acc: 0.7410, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9896)
Epoch 19/100 - Train loss: 0.9861, Val loss: 0.9754, Learning rate: 0.000100
  Multiclass: Train acc: 0.5749, Val acc: 0.5798, Val F1: 0.4386
  Contralateral: Train acc: 0.7429, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9754)
Epoch 20/100 - Train loss: 0.9781, Val loss: 0.9559, Learning rate: 0.000100
  Multiclass: Train acc: 0.5845, Val acc: 0.5865, Val F1: 0.4522
  Contralateral: Train acc: 0.7453, Val acc: 0.7618, Val F1: 0.0536
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9559)
Epoch 21/100 - Train loss: 0.9483, Val loss: 0.9355, Learning rate: 0.000100
  Multiclass: Train acc: 0.5927, Val acc: 0.5865, Val F1: 0.4581
  Contralateral: Train acc: 0.7578, Val acc: 0.7640, Val F1: 0.0870
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.09it/s, loss=0.9861]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 131.50it/s]
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.37it/s, loss=0.9781]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.73it/s]
Epoch 21 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.56it/s, loss=0.9483]
Epoch 21 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.37it/s]
Epoch 22 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.59it/s, loss=0.9373]
Epoch 22 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.77it/s]
Epoch 22/100 - Train loss: 0.9373, Val loss: 0.9160, Learning rate: 0.000100
  Multiclass: Train acc: 0.5946, Val acc: 0.5933, Val F1: 0.4803
  Contralateral: Train acc: 0.7535, Val acc: 0.7708, Val F1: 0.1356
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9160)
Epoch 23/100 - Train loss: 0.9076, Val loss: 0.8987, Learning rate: 0.000100
  Multiclass: Train acc: 0.6023, Val acc: 0.6135, Val F1: 0.5127
  Contralateral: Train acc: 0.7578, Val acc: 0.7775, Val F1: 0.1818
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8987)
Epoch 24/100 - Train loss: 0.8776, Val loss: 0.8721, Learning rate: 0.000100
  Multiclass: Train acc: 0.6153, Val acc: 0.6225, Val F1: 0.5304
  Contralateral: Train acc: 0.7684, Val acc: 0.7865, Val F1: 0.2520
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8721)
Epoch 23 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.02it/s, loss=0.9076]
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.17it/s]
Epoch 24 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.47it/s, loss=0.8776]
Epoch 24 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.82it/s]
Epoch 25 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.13it/s, loss=0.8494]
Epoch 25 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 25/100 - Train loss: 0.8494, Val loss: 0.8467, Learning rate: 0.000100
  Multiclass: Train acc: 0.6201, Val acc: 0.6292, Val F1: 0.5462
  Contralateral: Train acc: 0.7838, Val acc: 0.7978, Val F1: 0.3478
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8467)
Epoch 26/100 - Train loss: 0.8406, Val loss: 0.8249, Learning rate: 0.000100
  Multiclass: Train acc: 0.6196, Val acc: 0.6337, Val F1: 0.5552
  Contralateral: Train acc: 0.7824, Val acc: 0.8045, Val F1: 0.4314
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8249)
Epoch 27/100 - Train loss: 0.8143, Val loss: 0.7990, Learning rate: 0.000100
  Multiclass: Train acc: 0.6365, Val acc: 0.6292, Val F1: 0.5554
  Contralateral: Train acc: 0.7954, Val acc: 0.8202, Val F1: 0.5506
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7990)
Epoch 28/100 - Train loss: 0.7922, Val loss: 0.7733, Learning rate: 0.000100
  Multiclass: Train acc: 0.6394, Val acc: 0.6315, Val F1: 0.5579
  Contralateral: Train acc: 0.7915, Val acc: 0.8202, Val F1: 0.5604
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8112, Val F1: 0.0000
Epoch 25 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.47it/s]
Epoch 26 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.69it/s, loss=0.8406]
Epoch 26 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.29it/s]
Epoch 27 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.12it/s, loss=0.8143]
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.17it/s]
Epoch 28 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.16it/s, loss=0.7922]
Epoch 28 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.82it/s]
Epoch 29 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.61it/s, loss=0.7604]
Epoch 29 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.72it/s]
Epoch 30 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.20it/s, loss=0.7306]
Epoch 30 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.42it/s]
Epoch 31 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.26it/s, loss=0.7023]
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.75it/s]
Epoch 32 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.11it/s, loss=0.6786]
Epoch 32 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.46it/s]
Epoch 33 (Train):  75%|█████████████▌    | 49/65 [00:00<00:00, 175.17it/s, loss=0.6710]
Epoch 29/100 - Train loss: 0.7604, Val loss: 0.7481, Learning rate: 0.000100
  Multiclass: Train acc: 0.6481, Val acc: 0.6315, Val F1: 0.5595
  Contralateral: Train acc: 0.8065, Val acc: 0.8315, Val F1: 0.6114
  Ipsilateral: Train acc: 0.8257, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7481)
Epoch 30/100 - Train loss: 0.7306, Val loss: 0.7247, Learning rate: 0.000100
  Multiclass: Train acc: 0.6562, Val acc: 0.6427, Val F1: 0.5706
  Contralateral: Train acc: 0.8065, Val acc: 0.8270, Val F1: 0.6010
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7247)
Epoch 31/100 - Train loss: 0.7023, Val loss: 0.7030, Learning rate: 0.000100
  Multiclass: Train acc: 0.6707, Val acc: 0.6562, Val F1: 0.5857
  Contralateral: Train acc: 0.8146, Val acc: 0.8449, Val F1: 0.6601
  Ipsilateral: Train acc: 0.8272, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7030)
Epoch 32/100 - Train loss: 0.6786, Val loss: 0.6830, Learning rate: 0.000100
  Multiclass: Train acc: 0.6856, Val acc: 0.6562, Val F1: 0.5862
  Contralateral: Train acc: 0.8334, Val acc: 0.8360, Val F1: 0.6473
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8112, Val F1: 0.0000
Epoch 36 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.57it/s]
Epoch 33 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.96it/s]
Epoch 34 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.63it/s, loss=0.6198]
Epoch 34 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.21it/s]
Epoch 35 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.68it/s, loss=0.6181]
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.06it/s]
Epoch 36 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.77it/s, loss=0.5929]
Epoch 36 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.57it/s]
Epoch 37 (Train):  74%|█████████████▎    | 48/65 [00:00<00:00, 173.04it/s, loss=0.5364]
Epoch 33/100 - Train loss: 0.6673, Val loss: 0.6620, Learning rate: 0.000100
  Multiclass: Train acc: 0.6899, Val acc: 0.6539, Val F1: 0.5833
  Contralateral: Train acc: 0.8416, Val acc: 0.8382, Val F1: 0.6471
  Ipsilateral: Train acc: 0.8291, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6620)
Epoch 34/100 - Train loss: 0.6198, Val loss: 0.6414, Learning rate: 0.000100
  Multiclass: Train acc: 0.6962, Val acc: 0.6719, Val F1: 0.6010
  Contralateral: Train acc: 0.8406, Val acc: 0.8517, Val F1: 0.6944
  Ipsilateral: Train acc: 0.8315, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6414)
Epoch 35/100 - Train loss: 0.6181, Val loss: 0.6262, Learning rate: 0.000100
  Multiclass: Train acc: 0.7174, Val acc: 0.6629, Val F1: 0.5926
  Contralateral: Train acc: 0.8503, Val acc: 0.8539, Val F1: 0.6977
  Ipsilateral: Train acc: 0.8344, Val acc: 0.8135, Val F1: 0.0235
New best model saved (val_loss: 0.6262)
Epoch 36/100 - Train loss: 0.5929, Val loss: 0.6036, Learning rate: 0.000100
  Multiclass: Train acc: 0.7121, Val acc: 0.6876, Val F1: 0.6275
  Contralateral: Train acc: 0.8580, Val acc: 0.8607, Val F1: 0.7130
  Ipsilateral: Train acc: 0.8402, Val acc: 0.8180, Val F1: 0.0690
Epoch 41 (Train):  42%|███████▍          | 27/65 [00:00<00:00, 145.14it/s, loss=0.4660]
Epoch 37 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.12it/s]
Epoch 38 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.70it/s, loss=0.5378]
Epoch 38 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.06it/s]
Epoch 39 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.74it/s, loss=0.5461]
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.15it/s]
Epoch 40 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.73it/s, loss=0.5077]
Epoch 40 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.25it/s]
Epoch 41 (Train):  42%|███████▍          | 27/65 [00:00<00:00, 145.14it/s, loss=0.4660]
Epoch 37/100 - Train loss: 0.5566, Val loss: 0.5933, Learning rate: 0.000100
  Multiclass: Train acc: 0.7439, Val acc: 0.6899, Val F1: 0.6378
  Contralateral: Train acc: 0.8671, Val acc: 0.8629, Val F1: 0.7289
  Ipsilateral: Train acc: 0.8483, Val acc: 0.8270, Val F1: 0.1538
New best model saved (val_loss: 0.5933)
Epoch 38/100 - Train loss: 0.5378, Val loss: 0.5695, Learning rate: 0.000100
  Multiclass: Train acc: 0.7496, Val acc: 0.7101, Val F1: 0.6680
  Contralateral: Train acc: 0.8729, Val acc: 0.8674, Val F1: 0.7256
  Ipsilateral: Train acc: 0.8455, Val acc: 0.8225, Val F1: 0.1505
New best model saved (val_loss: 0.5695)
Epoch 39/100 - Train loss: 0.5461, Val loss: 0.5502, Learning rate: 0.000100
  Multiclass: Train acc: 0.7419, Val acc: 0.7326, Val F1: 0.7130
  Contralateral: Train acc: 0.8748, Val acc: 0.8787, Val F1: 0.7568
  Ipsilateral: Train acc: 0.8479, Val acc: 0.8427, Val F1: 0.3137
New best model saved (val_loss: 0.5502)
Epoch 40/100 - Train loss: 0.5077, Val loss: 0.5300, Learning rate: 0.000100
  Multiclass: Train acc: 0.7670, Val acc: 0.7573, Val F1: 0.7442
  Contralateral: Train acc: 0.8710, Val acc: 0.8787, Val F1: 0.7611
  Ipsilateral: Train acc: 0.8483, Val acc: 0.8449, Val F1: 0.3551
Epoch 45 (Train):  40%|███████▏          | 26/65 [00:00<00:00, 141.50it/s, loss=0.4431]
Epoch 41 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.15it/s]
Epoch 42 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.70it/s, loss=0.4721]
Epoch 42 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.53it/s]
Epoch 43 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.82it/s, loss=0.4541]
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.72it/s]
Epoch 44 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.04it/s, loss=0.4387]
Epoch 44 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.92it/s]
Epoch 45 (Train):  40%|███████▏          | 26/65 [00:00<00:00, 141.50it/s, loss=0.4431]
Epoch 41/100 - Train loss: 0.4867, Val loss: 0.5204, Learning rate: 0.000100
  Multiclass: Train acc: 0.7703, Val acc: 0.7708, Val F1: 0.7604
  Contralateral: Train acc: 0.8912, Val acc: 0.8854, Val F1: 0.7692
  Ipsilateral: Train acc: 0.8647, Val acc: 0.8584, Val F1: 0.4522
New best model saved (val_loss: 0.5204)
Epoch 42/100 - Train loss: 0.4721, Val loss: 0.5086, Learning rate: 0.000100
  Multiclass: Train acc: 0.7882, Val acc: 0.7730, Val F1: 0.7689
  Contralateral: Train acc: 0.8960, Val acc: 0.8809, Val F1: 0.7665
  Ipsilateral: Train acc: 0.8628, Val acc: 0.8831, Val F1: 0.6000
New best model saved (val_loss: 0.5086)
Epoch 43/100 - Train loss: 0.4541, Val loss: 0.4983, Learning rate: 0.000100
  Multiclass: Train acc: 0.7992, Val acc: 0.7798, Val F1: 0.7757
  Contralateral: Train acc: 0.8873, Val acc: 0.8854, Val F1: 0.7733
  Ipsilateral: Train acc: 0.8734, Val acc: 0.8944, Val F1: 0.6519
New best model saved (val_loss: 0.4983)
Epoch 44/100 - Train loss: 0.4387, Val loss: 0.4913, Learning rate: 0.000100
  Multiclass: Train acc: 0.8031, Val acc: 0.7775, Val F1: 0.7748
  Contralateral: Train acc: 0.8955, Val acc: 0.8809, Val F1: 0.7706
  Ipsilateral: Train acc: 0.8830, Val acc: 0.9011, Val F1: 0.6857
Epoch 49 (Train):   8%|█▌                  | 5/65 [00:00<00:01, 49.68it/s, loss=0.3542]
Epoch 45 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.94it/s]
Epoch 46 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.80it/s, loss=0.4144]
Epoch 46 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.77it/s]
Epoch 47 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.14it/s, loss=0.4083]
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.56it/s]
Epoch 48 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.68it/s, loss=0.3888]
Epoch 48 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.55it/s]
Epoch 49 (Train):   8%|█▌                  | 5/65 [00:00<00:01, 49.68it/s, loss=0.3542]
Epoch 45/100 - Train loss: 0.4416, Val loss: 0.4740, Learning rate: 0.000100
  Multiclass: Train acc: 0.8065, Val acc: 0.7843, Val F1: 0.7823
  Contralateral: Train acc: 0.9013, Val acc: 0.8854, Val F1: 0.7773
  Ipsilateral: Train acc: 0.8681, Val acc: 0.9034, Val F1: 0.6993
New best model saved (val_loss: 0.4740)
Epoch 46/100 - Train loss: 0.4144, Val loss: 0.4710, Learning rate: 0.000100
  Multiclass: Train acc: 0.8151, Val acc: 0.8022, Val F1: 0.8018
  Contralateral: Train acc: 0.9047, Val acc: 0.8966, Val F1: 0.7946
  Ipsilateral: Train acc: 0.8844, Val acc: 0.9146, Val F1: 0.7595
New best model saved (val_loss: 0.4710)
Epoch 47/100 - Train loss: 0.4083, Val loss: 0.4666, Learning rate: 0.000100
  Multiclass: Train acc: 0.8204, Val acc: 0.7955, Val F1: 0.7947
  Contralateral: Train acc: 0.9018, Val acc: 0.8921, Val F1: 0.7876
  Ipsilateral: Train acc: 0.8873, Val acc: 0.9101, Val F1: 0.7333
Epoch 53 (Train):  11%|██▏                 | 7/65 [00:00<00:00, 68.34it/s, loss=0.3486]
Epoch 49 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.54it/s]
Epoch 50 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.09it/s, loss=0.3617]
Epoch 50 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.29it/s]
Epoch 51 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.92it/s, loss=0.3448]
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.13it/s]
Epoch 52 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 167.50it/s, loss=0.3538]
Epoch 52 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.05it/s]
Epoch 53 (Train):  11%|██▏                 | 7/65 [00:00<00:00, 68.34it/s, loss=0.3486]
Epoch 48/100 - Train loss: 0.3888, Val loss: 0.4512, Learning rate: 0.000100
  Multiclass: Train acc: 0.8349, Val acc: 0.8135, Val F1: 0.8137
  Contralateral: Train acc: 0.9148, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.8965, Val acc: 0.9169, Val F1: 0.7811
New best model saved (val_loss: 0.4512)
Epoch 49/100 - Train loss: 0.3800, Val loss: 0.4509, Learning rate: 0.000100
  Multiclass: Train acc: 0.8310, Val acc: 0.8090, Val F1: 0.8086
  Contralateral: Train acc: 0.9100, Val acc: 0.8921, Val F1: 0.7857
  Ipsilateral: Train acc: 0.9032, Val acc: 0.9169, Val F1: 0.7702
New best model saved (val_loss: 0.4509)
Epoch 50/100 - Train loss: 0.3617, Val loss: 0.4519, Learning rate: 0.000100
  Multiclass: Train acc: 0.8445, Val acc: 0.7933, Val F1: 0.7932
  Contralateral: Train acc: 0.9095, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.8994, Val acc: 0.9079, Val F1: 0.7515
Epoch 51/100 - Train loss: 0.3448, Val loss: 0.4475, Learning rate: 0.000100
  Multiclass: Train acc: 0.8503, Val acc: 0.8000, Val F1: 0.8006
  Contralateral: Train acc: 0.9157, Val acc: 0.8831, Val F1: 0.7759
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9124, Val F1: 0.7692
Epoch 57 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 53 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.55it/s]
Epoch 54 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.19it/s, loss=0.3303]
Epoch 54 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 108.00it/s]
Epoch 55 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.09it/s, loss=0.3085]
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.20it/s]
Epoch 56 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.37it/s, loss=0.3120]
Epoch 56 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.38it/s]
Epoch 57 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 52/100 - Train loss: 0.3538, Val loss: 0.4458, Learning rate: 0.000100
  Multiclass: Train acc: 0.8483, Val acc: 0.8000, Val F1: 0.8004
  Contralateral: Train acc: 0.9167, Val acc: 0.8854, Val F1: 0.7713
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9124, Val F1: 0.7771
New best model saved (val_loss: 0.4458)
Epoch 53/100 - Train loss: 0.3369, Val loss: 0.4388, Learning rate: 0.000100
  Multiclass: Train acc: 0.8637, Val acc: 0.7978, Val F1: 0.7984
  Contralateral: Train acc: 0.9133, Val acc: 0.8876, Val F1: 0.7826
  Ipsilateral: Train acc: 0.9133, Val acc: 0.9124, Val F1: 0.7719
New best model saved (val_loss: 0.4388)
Epoch 54/100 - Train loss: 0.3303, Val loss: 0.4355, Learning rate: 0.000100
  Multiclass: Train acc: 0.8613, Val acc: 0.8112, Val F1: 0.8116
  Contralateral: Train acc: 0.9254, Val acc: 0.8921, Val F1: 0.7778
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9169, Val F1: 0.7861
New best model saved (val_loss: 0.4355)
Epoch 55/100 - Train loss: 0.3085, Val loss: 0.4251, Learning rate: 0.000100
  Multiclass: Train acc: 0.8633, Val acc: 0.8090, Val F1: 0.8098
  Contralateral: Train acc: 0.9297, Val acc: 0.8831, Val F1: 0.7739
  Ipsilateral: Train acc: 0.9244, Val acc: 0.9281, Val F1: 0.8161
Epoch 57 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.81it/s, loss=0.2774]
Epoch 57 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.21it/s]
Epoch 58 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.50it/s, loss=0.2831]
Epoch 58 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.60it/s]
Epoch 59 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.00it/s, loss=0.2776]
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.77it/s]
Epoch 60 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.52it/s, loss=0.2562]
Epoch 60 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 57 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.81it/s, loss=0.2774]
Epoch 56/100 - Train loss: 0.3120, Val loss: 0.4310, Learning rate: 0.000100
  Multiclass: Train acc: 0.8748, Val acc: 0.8202, Val F1: 0.8203
  Contralateral: Train acc: 0.9307, Val acc: 0.8944, Val F1: 0.7854
  Ipsilateral: Train acc: 0.9220, Val acc: 0.9236, Val F1: 0.8046
Epoch 57/100 - Train loss: 0.2774, Val loss: 0.4224, Learning rate: 0.000100
  Multiclass: Train acc: 0.8820, Val acc: 0.8157, Val F1: 0.8163
  Contralateral: Train acc: 0.9336, Val acc: 0.8876, Val F1: 0.7768
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9281, Val F1: 0.8118
New best model saved (val_loss: 0.4224)
Epoch 58/100 - Train loss: 0.2831, Val loss: 0.4205, Learning rate: 0.000100
  Multiclass: Train acc: 0.8796, Val acc: 0.8180, Val F1: 0.8186
  Contralateral: Train acc: 0.9287, Val acc: 0.8876, Val F1: 0.7768
  Ipsilateral: Train acc: 0.9316, Val acc: 0.9303, Val F1: 0.8208
New best model saved (val_loss: 0.4205)
Epoch 59/100 - Train loss: 0.2776, Val loss: 0.4102, Learning rate: 0.000100
  Multiclass: Train acc: 0.8849, Val acc: 0.8292, Val F1: 0.8297
  Contralateral: Train acc: 0.9292, Val acc: 0.8966, Val F1: 0.7928
  Ipsilateral: Train acc: 0.9422, Val acc: 0.9326, Val F1: 0.8315
Epoch 61 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.02it/s, loss=0.2626]
Epoch 61 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.18it/s]
Epoch 62 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.02it/s, loss=0.2580]
Epoch 62 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.62it/s]
Epoch 63 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.58it/s, loss=0.2715]
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.59it/s]
Epoch 64 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.71it/s, loss=0.2479]
Epoch 64 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 61 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.02it/s, loss=0.2626]
Epoch 60/100 - Train loss: 0.2562, Val loss: 0.4199, Learning rate: 0.000100
  Multiclass: Train acc: 0.8936, Val acc: 0.8180, Val F1: 0.8183
  Contralateral: Train acc: 0.9413, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.9355, Val acc: 0.9348, Val F1: 0.8304
Epoch 61/100 - Train loss: 0.2626, Val loss: 0.4081, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8270, Val F1: 0.8279
  Contralateral: Train acc: 0.9364, Val acc: 0.8921, Val F1: 0.7931
  Ipsilateral: Train acc: 0.9432, Val acc: 0.9371, Val F1: 0.8372
New best model saved (val_loss: 0.4081)
Epoch 62/100 - Train loss: 0.2580, Val loss: 0.4101, Learning rate: 0.000100
  Multiclass: Train acc: 0.8941, Val acc: 0.8292, Val F1: 0.8301
  Contralateral: Train acc: 0.9384, Val acc: 0.8854, Val F1: 0.7792
  Ipsilateral: Train acc: 0.9466, Val acc: 0.9393, Val F1: 0.8457
Epoch 63/100 - Train loss: 0.2715, Val loss: 0.4263, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8292, Val F1: 0.8295
  Contralateral: Train acc: 0.9364, Val acc: 0.8921, Val F1: 0.7838
Epoch 65 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.06it/s, loss=0.2459]
Epoch 65 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.22it/s]
Epoch 66 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.78it/s, loss=0.2443]
Epoch 66 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.85it/s]
Epoch 67 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.46it/s, loss=0.2313]
Epoch 67 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.63it/s]
Epoch 68 (Train):  74%|█████████████▎    | 48/65 [00:00<00:00, 174.59it/s, loss=0.2284]
Epoch 65 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.06it/s, loss=0.2459]
Epoch 64/100 - Train loss: 0.2479, Val loss: 0.4121, Learning rate: 0.000100
  Multiclass: Train acc: 0.8960, Val acc: 0.8315, Val F1: 0.8320
  Contralateral: Train acc: 0.9384, Val acc: 0.8944, Val F1: 0.7892
  Ipsilateral: Train acc: 0.9389, Val acc: 0.9348, Val F1: 0.8343
Epoch 65/100 - Train loss: 0.2459, Val loss: 0.4196, Learning rate: 0.000100
  Multiclass: Train acc: 0.9008, Val acc: 0.8382, Val F1: 0.8387
  Contralateral: Train acc: 0.9490, Val acc: 0.8989, Val F1: 0.7964
  Ipsilateral: Train acc: 0.9393, Val acc: 0.9326, Val F1: 0.8295
Epoch 66/100 - Train loss: 0.2443, Val loss: 0.4215, Learning rate: 0.000100
  Multiclass: Train acc: 0.8994, Val acc: 0.8315, Val F1: 0.8322
  Contralateral: Train acc: 0.9456, Val acc: 0.8876, Val F1: 0.7788
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 120.37it/s]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 151.44it/s, loss=1.2028]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 118.04it/s]
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 160.09it/s, loss=1.1079]
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 120.37it/s]
Epoch 00067: reducing learning rate of group 0 to 5.0000e-05.
Epoch 67/100 - Train loss: 0.2313, Val loss: 0.4184, Learning rate: 0.000050
  Multiclass: Train acc: 0.9018, Val acc: 0.8292, Val F1: 0.8296
  Contralateral: Train acc: 0.9442, Val acc: 0.8899, Val F1: 0.7822
  Ipsilateral: Train acc: 0.9446, Val acc: 0.9371, Val F1: 0.8409
Epoch 68/100 - Train loss: 0.2284, Val loss: 0.4193, Learning rate: 0.000050
  Multiclass: Train acc: 0.9018, Val acc: 0.8292, Val F1: 0.8295
  Contralateral: Train acc: 0.9413, Val acc: 0.8854, Val F1: 0.7692
  Ipsilateral: Train acc: 0.9490, Val acc: 0.9371, Val F1: 0.8372
Early stopping triggered after 68 epochs
Best model was at epoch 61
Training completed. Best validation loss: 0.4081
Evaluating on test set...
[2025-04-09 16:20:00,981][HYDRA] 	#2 : model=lstm model.hidden_size=32 model.num_layers=2 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 100
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 71175
Starting training for lstm model...
Epoch 1/100 - Train loss: 1.2028, Val loss: 1.1015, Learning rate: 0.001000
  Multiclass: Train acc: 0.5128, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6635, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7747, Val acc: 0.8112, Val F1: 0.0000
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.59it/s, loss=1.0127]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 118.42it/s]
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 157.96it/s, loss=0.8626]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 117.70it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.00it/s, loss=0.7592]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.21it/s]
Epoch 6 (Train):  38%|███████▎           | 25/65 [00:00<00:00, 135.69it/s, loss=0.6395]
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.59it/s, loss=1.0127]
Epoch 2/100 - Train loss: 1.1079, Val loss: 1.0449, Learning rate: 0.001000
  Multiclass: Train acc: 0.5725, Val acc: 0.5685, Val F1: 0.4225
  Contralateral: Train acc: 0.7338, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0449)
Epoch 3/100 - Train loss: 1.0127, Val loss: 0.9263, Learning rate: 0.001000
  Multiclass: Train acc: 0.5840, Val acc: 0.6225, Val F1: 0.5364
  Contralateral: Train acc: 0.7434, Val acc: 0.7775, Val F1: 0.2326
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9263)
Epoch 4/100 - Train loss: 0.8626, Val loss: 0.8001, Learning rate: 0.001000
  Multiclass: Train acc: 0.6442, Val acc: 0.6337, Val F1: 0.5572
  Contralateral: Train acc: 0.8012, Val acc: 0.8180, Val F1: 0.5668
  Ipsilateral: Train acc: 0.8243, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8001)
Epoch 5/100 - Train loss: 0.7592, Val loss: 0.6777, Learning rate: 0.001000
  Multiclass: Train acc: 0.6668, Val acc: 0.6494, Val F1: 0.5854
  Contralateral: Train acc: 0.8175, Val acc: 0.8360, Val F1: 0.6697
  Ipsilateral: Train acc: 0.8262, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 160.19it/s, loss=0.5590]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.03it/s]
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.97it/s, loss=0.5170]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.18it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 158.66it/s, loss=0.4473]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 118.76it/s]
Epoch 10 (Train):   6%|█▏                  | 4/65 [00:00<00:01, 39.80it/s, loss=0.4102]
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 160.19it/s, loss=0.5590]
Epoch 6/100 - Train loss: 0.6495, Val loss: 0.5964, Learning rate: 0.001000
  Multiclass: Train acc: 0.7000, Val acc: 0.7416, Val F1: 0.7389
  Contralateral: Train acc: 0.8517, Val acc: 0.8607, Val F1: 0.7373
  Ipsilateral: Train acc: 0.8291, Val acc: 0.8090, Val F1: 0.0000
New best model saved (val_loss: 0.5964)
Epoch 7/100 - Train loss: 0.5590, Val loss: 0.5389, Learning rate: 0.001000
  Multiclass: Train acc: 0.7545, Val acc: 0.7663, Val F1: 0.7673
  Contralateral: Train acc: 0.8743, Val acc: 0.8674, Val F1: 0.7446
  Ipsilateral: Train acc: 0.8580, Val acc: 0.8697, Val F1: 0.6234
New best model saved (val_loss: 0.5389)
Epoch 8/100 - Train loss: 0.5170, Val loss: 0.4759, Learning rate: 0.001000
  Multiclass: Train acc: 0.7790, Val acc: 0.7685, Val F1: 0.7710
  Contralateral: Train acc: 0.8806, Val acc: 0.8831, Val F1: 0.7719
  Ipsilateral: Train acc: 0.8695, Val acc: 0.8831, Val F1: 0.7263
New best model saved (val_loss: 0.4759)
Epoch 9/100 - Train loss: 0.4473, Val loss: 0.4778, Learning rate: 0.001000
  Multiclass: Train acc: 0.8132, Val acc: 0.7798, Val F1: 0.7810
  Contralateral: Train acc: 0.8926, Val acc: 0.8809, Val F1: 0.7801
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 156.84it/s, loss=0.3899]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.06it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.43it/s, loss=0.3737]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.29it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.15it/s, loss=0.3435]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.66it/s]
Epoch 14 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 156.84it/s, loss=0.3899]
Epoch 10/100 - Train loss: 0.4249, Val loss: 0.5082, Learning rate: 0.001000
  Multiclass: Train acc: 0.8156, Val acc: 0.7573, Val F1: 0.7590
  Contralateral: Train acc: 0.9042, Val acc: 0.8719, Val F1: 0.7635
  Ipsilateral: Train acc: 0.9047, Val acc: 0.8787, Val F1: 0.6932
Epoch 11/100 - Train loss: 0.3899, Val loss: 0.4570, Learning rate: 0.001000
  Multiclass: Train acc: 0.8349, Val acc: 0.7865, Val F1: 0.7879
  Contralateral: Train acc: 0.9119, Val acc: 0.8742, Val F1: 0.7522
  Ipsilateral: Train acc: 0.9100, Val acc: 0.9034, Val F1: 0.7543
New best model saved (val_loss: 0.4570)
Epoch 12/100 - Train loss: 0.3737, Val loss: 0.4554, Learning rate: 0.001000
  Multiclass: Train acc: 0.8435, Val acc: 0.8247, Val F1: 0.8257
  Contralateral: Train acc: 0.9210, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9234, Val acc: 0.9191, Val F1: 0.7978
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.12it/s, loss=0.3253]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.86it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.16it/s, loss=0.3336]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.86it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.64it/s, loss=0.2713]
Epoch 17 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.12it/s, loss=0.3253]
Epoch 13/100 - Train loss: 0.3435, Val loss: 0.4068, Learning rate: 0.001000
  Multiclass: Train acc: 0.8532, Val acc: 0.8135, Val F1: 0.8149
  Contralateral: Train acc: 0.9177, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9244, Val acc: 0.9101, Val F1: 0.7895
New best model saved (val_loss: 0.4068)
Epoch 14/100 - Train loss: 0.3653, Val loss: 0.4728, Learning rate: 0.001000
  Multiclass: Train acc: 0.8671, Val acc: 0.8292, Val F1: 0.8285
  Contralateral: Train acc: 0.9191, Val acc: 0.9056, Val F1: 0.8037
  Ipsilateral: Train acc: 0.9403, Val acc: 0.9213, Val F1: 0.7826
Epoch 15/100 - Train loss: 0.3253, Val loss: 0.3535, Learning rate: 0.001000
  Multiclass: Train acc: 0.8729, Val acc: 0.8225, Val F1: 0.8226
  Contralateral: Train acc: 0.9287, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9336, Val acc: 0.9191, Val F1: 0.7857
New best model saved (val_loss: 0.3535)
Epoch 16/100 - Train loss: 0.3336, Val loss: 0.3867, Learning rate: 0.001000
  Multiclass: Train acc: 0.8792, Val acc: 0.8382, Val F1: 0.8387
  Contralateral: Train acc: 0.9321, Val acc: 0.9079, Val F1: 0.8145
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 156.75it/s, loss=0.2947]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.70it/s]
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.81it/s, loss=0.2587]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.60it/s]
Epoch 21 (Train):  69%|████████████▍     | 45/65 [00:00<00:00, 164.93it/s, loss=0.2675]
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 156.75it/s, loss=0.2947]
Epoch 17/100 - Train loss: 0.2713, Val loss: 0.4270, Learning rate: 0.001000
  Multiclass: Train acc: 0.8994, Val acc: 0.8247, Val F1: 0.8258
  Contralateral: Train acc: 0.9393, Val acc: 0.9011, Val F1: 0.8070
  Ipsilateral: Train acc: 0.9504, Val acc: 0.9191, Val F1: 0.8065
Epoch 18/100 - Train loss: 0.2579, Val loss: 0.4358, Learning rate: 0.001000
  Multiclass: Train acc: 0.9080, Val acc: 0.8315, Val F1: 0.8326
  Contralateral: Train acc: 0.9422, Val acc: 0.9169, Val F1: 0.8426
  Ipsilateral: Train acc: 0.9547, Val acc: 0.9101, Val F1: 0.7826
Epoch 19/100 - Train loss: 0.2947, Val loss: 0.3795, Learning rate: 0.001000
  Multiclass: Train acc: 0.8974, Val acc: 0.8315, Val F1: 0.8325
  Contralateral: Train acc: 0.9345, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9543, Val acc: 0.9236, Val F1: 0.8132
Epoch 20/100 - Train loss: 0.2587, Val loss: 0.4142, Learning rate: 0.001000
  Multiclass: Train acc: 0.9095, Val acc: 0.8337, Val F1: 0.8340
  Contralateral: Train acc: 0.9393, Val acc: 0.9101, Val F1: 0.8305
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 125.80it/s]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 154.95it/s, loss=1.3087]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 128.22it/s]
Epoch 2 (Train):  71%|█████████████▍     | 46/65 [00:00<00:00, 165.58it/s, loss=1.2637]
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 125.80it/s]
Epoch 00021: reducing learning rate of group 0 to 5.0000e-04.
Epoch 21/100 - Train loss: 0.2661, Val loss: 0.4197, Learning rate: 0.000500
  Multiclass: Train acc: 0.8984, Val acc: 0.8472, Val F1: 0.8476
  Contralateral: Train acc: 0.9413, Val acc: 0.9056, Val F1: 0.8125
  Ipsilateral: Train acc: 0.9519, Val acc: 0.9326, Val F1: 0.8235
Epoch 22/100 - Train loss: 0.1939, Val loss: 0.4316, Learning rate: 0.000500
  Multiclass: Train acc: 0.9273, Val acc: 0.8382, Val F1: 0.8388
  Contralateral: Train acc: 0.9576, Val acc: 0.9079, Val F1: 0.8194
  Ipsilateral: Train acc: 0.9615, Val acc: 0.9303, Val F1: 0.8166
Early stopping triggered after 22 epochs
Best model was at epoch 15
Training completed. Best validation loss: 0.3535
Evaluating on test set...
[2025-04-09 16:20:13,293][HYDRA] 	#3 : model=lstm model.hidden_size=32 model.num_layers=2 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 71175
Starting training for lstm model...
Epoch 1/100 - Train loss: 1.3087, Val loss: 1.2694, Learning rate: 0.000100
  Multiclass: Train acc: 0.3866, Val acc: 0.5371, Val F1: 0.4617
  Contralateral: Train acc: 0.4810, Val acc: 0.6787, Val F1: 0.2513
  Ipsilateral: Train acc: 0.6230, Val acc: 0.8022, Val F1: 0.1020
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.75it/s, loss=1.2307]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.15it/s]
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 157.85it/s, loss=1.1928]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 127.28it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 160.40it/s, loss=1.1767]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.67it/s]
Epoch 6 (Train):  38%|███████▎           | 25/65 [00:00<00:00, 134.23it/s, loss=1.1592]
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.75it/s, loss=1.2307]
Epoch 2/100 - Train loss: 1.2618, Val loss: 1.2273, Learning rate: 0.000100
  Multiclass: Train acc: 0.4641, Val acc: 0.5618, Val F1: 0.4485
  Contralateral: Train acc: 0.5503, Val acc: 0.7483, Val F1: 0.1765
  Ipsilateral: Train acc: 0.7039, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.2273)
Epoch 3/100 - Train loss: 1.2307, Val loss: 1.1934, Learning rate: 0.000100
  Multiclass: Train acc: 0.5113, Val acc: 0.5685, Val F1: 0.4221
  Contralateral: Train acc: 0.6062, Val acc: 0.7573, Val F1: 0.0357
  Ipsilateral: Train acc: 0.7573, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1934)
Epoch 4/100 - Train loss: 1.1928, Val loss: 1.1633, Learning rate: 0.000100
  Multiclass: Train acc: 0.5311, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.6562, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7780, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1633)
Epoch 5/100 - Train loss: 1.1767, Val loss: 1.1410, Learning rate: 0.000100
  Multiclass: Train acc: 0.5296, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.6663, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7978, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 156.48it/s, loss=1.1477]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 127.34it/s]
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 157.79it/s, loss=1.1374]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 126.41it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 158.31it/s, loss=1.1315]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 126.79it/s]
Epoch 10 (Train):   9%|█▊                  | 6/65 [00:00<00:01, 57.57it/s, loss=1.1248]
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 156.48it/s, loss=1.1477]
Epoch 6/100 - Train loss: 1.1648, Val loss: 1.1228, Learning rate: 0.000100
  Multiclass: Train acc: 0.5518, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6851, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8103, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1228)
Epoch 7/100 - Train loss: 1.1477, Val loss: 1.1119, Learning rate: 0.000100
  Multiclass: Train acc: 0.5575, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6875, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8069, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1119)
Epoch 8/100 - Train loss: 1.1374, Val loss: 1.0994, Learning rate: 0.000100
  Multiclass: Train acc: 0.5595, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6996, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8122, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.63it/s, loss=1.1019]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.79it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.23it/s, loss=1.0884]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.64it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.77it/s, loss=1.0786]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.68it/s]
Epoch 14 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.63it/s, loss=1.1019]
Epoch 9/100 - Train loss: 1.1315, Val loss: 1.0879, Learning rate: 0.000100
  Multiclass: Train acc: 0.5571, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7010, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8175, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0879)
Epoch 10/100 - Train loss: 1.1148, Val loss: 1.0779, Learning rate: 0.000100
  Multiclass: Train acc: 0.5691, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.7058, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8161, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0779)
Epoch 11/100 - Train loss: 1.1019, Val loss: 1.0683, Learning rate: 0.000100
  Multiclass: Train acc: 0.5619, Val acc: 0.5708, Val F1: 0.4195
  Contralateral: Train acc: 0.7232, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0683)
Epoch 12/100 - Train loss: 1.0884, Val loss: 1.0560, Learning rate: 0.000100
  Multiclass: Train acc: 0.5734, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.7193, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8180, Val acc: 0.8112, Val F1: 0.0000
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.39it/s, loss=1.0560]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.23it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.17it/s, loss=1.0347]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.17it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.34it/s, loss=1.0320]
Epoch 17 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.39it/s, loss=1.0560]
Epoch 13/100 - Train loss: 1.0786, Val loss: 1.0473, Learning rate: 0.000100
  Multiclass: Train acc: 0.5739, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.7275, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0473)
Epoch 14/100 - Train loss: 1.0795, Val loss: 1.0331, Learning rate: 0.000100
  Multiclass: Train acc: 0.5782, Val acc: 0.5798, Val F1: 0.4386
  Contralateral: Train acc: 0.7130, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0331)
Epoch 15/100 - Train loss: 1.0560, Val loss: 1.0195, Learning rate: 0.000100
  Multiclass: Train acc: 0.5831, Val acc: 0.5798, Val F1: 0.4419
  Contralateral: Train acc: 0.7362, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0195)
Epoch 16/100 - Train loss: 1.0347, Val loss: 1.0086, Learning rate: 0.000100
  Multiclass: Train acc: 0.5936, Val acc: 0.5843, Val F1: 0.4508
  Contralateral: Train acc: 0.7260, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.20it/s, loss=0.9970]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.28it/s]
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.70it/s, loss=0.9646]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 105.76it/s]
Epoch 21 (Train):  63%|███████████▎      | 41/65 [00:00<00:00, 150.74it/s, loss=0.9376]
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.20it/s, loss=0.9970]
Epoch 17/100 - Train loss: 1.0320, Val loss: 0.9890, Learning rate: 0.000100
  Multiclass: Train acc: 0.5845, Val acc: 0.6000, Val F1: 0.4873
  Contralateral: Train acc: 0.7448, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9890)
Epoch 18/100 - Train loss: 1.0003, Val loss: 0.9702, Learning rate: 0.000100
  Multiclass: Train acc: 0.5989, Val acc: 0.6112, Val F1: 0.5057
  Contralateral: Train acc: 0.7429, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9702)
Epoch 19/100 - Train loss: 0.9970, Val loss: 0.9493, Learning rate: 0.000100
  Multiclass: Train acc: 0.6042, Val acc: 0.6180, Val F1: 0.5195
  Contralateral: Train acc: 0.7520, Val acc: 0.7640, Val F1: 0.0870
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
Epoch 23 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.77it/s, loss=0.9010]
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.20it/s]
Epoch 24 (Train):   0%|                            | 0/65 [00:00<?, ?it/s, loss=0.9698]
Epoch 23 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.77it/s, loss=0.9010]
Epoch 20/100 - Train loss: 0.9646, Val loss: 0.9334, Learning rate: 0.000100
  Multiclass: Train acc: 0.6148, Val acc: 0.6292, Val F1: 0.5419
  Contralateral: Train acc: 0.7496, Val acc: 0.7708, Val F1: 0.1500
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9334)
Epoch 21/100 - Train loss: 0.9365, Val loss: 0.9077, Learning rate: 0.000100
  Multiclass: Train acc: 0.6196, Val acc: 0.6315, Val F1: 0.5479
  Contralateral: Train acc: 0.7703, Val acc: 0.8045, Val F1: 0.3650
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9077)
Epoch 22/100 - Train loss: 0.9237, Val loss: 0.8878, Learning rate: 0.000100
  Multiclass: Train acc: 0.6341, Val acc: 0.6494, Val F1: 0.5731
  Contralateral: Train acc: 0.7795, Val acc: 0.8090, Val F1: 0.4371
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8878)
Epoch 23/100 - Train loss: 0.9010, Val loss: 0.8670, Learning rate: 0.000100
  Multiclass: Train acc: 0.6259, Val acc: 0.6562, Val F1: 0.5806
  Contralateral: Train acc: 0.7857, Val acc: 0.8337, Val F1: 0.5542
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
Epoch 27 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.18it/s, loss=0.8177]
Epoch 27 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 27 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.18it/s, loss=0.8177]
Epoch 24/100 - Train loss: 0.8753, Val loss: 0.8452, Learning rate: 0.000100
  Multiclass: Train acc: 0.6432, Val acc: 0.6539, Val F1: 0.5806
  Contralateral: Train acc: 0.7838, Val acc: 0.8292, Val F1: 0.5824
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8452)
Epoch 25/100 - Train loss: 0.8548, Val loss: 0.8277, Learning rate: 0.000100
  Multiclass: Train acc: 0.6495, Val acc: 0.6562, Val F1: 0.5811
  Contralateral: Train acc: 0.7901, Val acc: 0.8404, Val F1: 0.6034
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8277)
Epoch 26/100 - Train loss: 0.8377, Val loss: 0.8008, Learning rate: 0.000100
  Multiclass: Train acc: 0.6461, Val acc: 0.6562, Val F1: 0.5831
  Contralateral: Train acc: 0.7968, Val acc: 0.8539, Val F1: 0.6667
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
Epoch 31 (Train):  68%|████████████▏     | 44/65 [00:00<00:00, 159.86it/s, loss=0.7389]
Epoch 31 (Train):  68%|████████████▏     | 44/65 [00:00<00:00, 159.86it/s, loss=0.7389]
Epoch 27/100 - Train loss: 0.8177, Val loss: 0.7809, Learning rate: 0.000100
  Multiclass: Train acc: 0.6644, Val acc: 0.6584, Val F1: 0.5868
  Contralateral: Train acc: 0.8060, Val acc: 0.8562, Val F1: 0.6800
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7809)
Epoch 28/100 - Train loss: 0.7908, Val loss: 0.7607, Learning rate: 0.000100
  Multiclass: Train acc: 0.6644, Val acc: 0.6629, Val F1: 0.5908
  Contralateral: Train acc: 0.8166, Val acc: 0.8562, Val F1: 0.6800
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7607)
Epoch 29/100 - Train loss: 0.7651, Val loss: 0.7417, Learning rate: 0.000100
  Multiclass: Train acc: 0.6745, Val acc: 0.6652, Val F1: 0.5937
  Contralateral: Train acc: 0.8214, Val acc: 0.8494, Val F1: 0.6825
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7417)
Epoch 30/100 - Train loss: 0.7574, Val loss: 0.7268, Learning rate: 0.000100
  Multiclass: Train acc: 0.6784, Val acc: 0.6742, Val F1: 0.6015
  Contralateral: Train acc: 0.8257, Val acc: 0.8607, Val F1: 0.7019
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
Epoch 35 (Train):   9%|█▊                  | 6/65 [00:00<00:01, 58.28it/s, loss=0.7450]
Epoch 35 (Train):   9%|█▊                  | 6/65 [00:00<00:01, 58.28it/s, loss=0.7450]
Epoch 31/100 - Train loss: 0.7444, Val loss: 0.7063, Learning rate: 0.000100
  Multiclass: Train acc: 0.6760, Val acc: 0.6674, Val F1: 0.5960
  Contralateral: Train acc: 0.8190, Val acc: 0.8584, Val F1: 0.7042
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7063)
Epoch 32/100 - Train loss: 0.7149, Val loss: 0.6961, Learning rate: 0.000100
  Multiclass: Train acc: 0.6981, Val acc: 0.6697, Val F1: 0.5982
  Contralateral: Train acc: 0.8392, Val acc: 0.8607, Val F1: 0.7156
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6961)
Epoch 33/100 - Train loss: 0.7126, Val loss: 0.6841, Learning rate: 0.000100
  Multiclass: Train acc: 0.6890, Val acc: 0.6719, Val F1: 0.6004
  Contralateral: Train acc: 0.8402, Val acc: 0.8607, Val F1: 0.7182
  Ipsilateral: Train acc: 0.8262, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6841)
Epoch 34/100 - Train loss: 0.7009, Val loss: 0.6675, Learning rate: 0.000100
  Multiclass: Train acc: 0.6938, Val acc: 0.6787, Val F1: 0.6069
  Contralateral: Train acc: 0.8377, Val acc: 0.8652, Val F1: 0.7273
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8112, Val F1: 0.0000
Epoch 35 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.05it/s, loss=0.6869]
Epoch 35 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.05it/s, loss=0.6869]
Epoch 35/100 - Train loss: 0.6869, Val loss: 0.6455, Learning rate: 0.000100
  Multiclass: Train acc: 0.6943, Val acc: 0.6809, Val F1: 0.6087
  Contralateral: Train acc: 0.8435, Val acc: 0.8652, Val F1: 0.7248
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6455)
Epoch 36/100 - Train loss: 0.6496, Val loss: 0.6316, Learning rate: 0.000100
  Multiclass: Train acc: 0.7034, Val acc: 0.6831, Val F1: 0.6113
  Contralateral: Train acc: 0.8536, Val acc: 0.8719, Val F1: 0.7397
  Ipsilateral: Train acc: 0.8247, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6316)
Epoch 37/100 - Train loss: 0.6395, Val loss: 0.6128, Learning rate: 0.000100
  Multiclass: Train acc: 0.7174, Val acc: 0.6809, Val F1: 0.6094
  Contralateral: Train acc: 0.8599, Val acc: 0.8674, Val F1: 0.7378
  Ipsilateral: Train acc: 0.8281, Val acc: 0.8112, Val F1: 0.0000
Epoch 39 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.11it/s, loss=0.5987]
Epoch 39 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.11it/s, loss=0.5987]
Epoch 38/100 - Train loss: 0.6408, Val loss: 0.5981, Learning rate: 0.000100
  Multiclass: Train acc: 0.7121, Val acc: 0.6787, Val F1: 0.6076
  Contralateral: Train acc: 0.8450, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5981)
Epoch 39/100 - Train loss: 0.5987, Val loss: 0.5772, Learning rate: 0.000100
  Multiclass: Train acc: 0.7333, Val acc: 0.6921, Val F1: 0.6323
  Contralateral: Train acc: 0.8739, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8339, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5772)
Epoch 40/100 - Train loss: 0.6132, Val loss: 0.5660, Learning rate: 0.000100
  Multiclass: Train acc: 0.7092, Val acc: 0.6899, Val F1: 0.6412
  Contralateral: Train acc: 0.8666, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8368, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5660)
Epoch 41/100 - Train loss: 0.5739, Val loss: 0.5551, Learning rate: 0.000100
  Multiclass: Train acc: 0.7227, Val acc: 0.7146, Val F1: 0.6870
  Contralateral: Train acc: 0.8719, Val acc: 0.8764, Val F1: 0.7598
  Ipsilateral: Train acc: 0.8329, Val acc: 0.8112, Val F1: 0.0000
Epoch 43 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.53it/s, loss=0.5715]
Epoch 43 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.53it/s, loss=0.5715]
Epoch 42/100 - Train loss: 0.5822, Val loss: 0.5395, Learning rate: 0.000100
  Multiclass: Train acc: 0.7285, Val acc: 0.7236, Val F1: 0.7061
  Contralateral: Train acc: 0.8652, Val acc: 0.8742, Val F1: 0.7477
  Ipsilateral: Train acc: 0.8329, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5395)
Epoch 43/100 - Train loss: 0.5715, Val loss: 0.5243, Learning rate: 0.000100
  Multiclass: Train acc: 0.7352, Val acc: 0.7461, Val F1: 0.7372
  Contralateral: Train acc: 0.8734, Val acc: 0.8809, Val F1: 0.7644
  Ipsilateral: Train acc: 0.8382, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5243)
Epoch 44/100 - Train loss: 0.5599, Val loss: 0.5156, Learning rate: 0.000100
  Multiclass: Train acc: 0.7520, Val acc: 0.7393, Val F1: 0.7292
  Contralateral: Train acc: 0.8816, Val acc: 0.8742, Val F1: 0.7522
  Ipsilateral: Train acc: 0.8459, Val acc: 0.8112, Val F1: 0.0000
Epoch 47 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.00it/s, loss=0.5191]
Epoch 47 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.00it/s, loss=0.5191]
Epoch 45/100 - Train loss: 0.5369, Val loss: 0.5049, Learning rate: 0.000100
  Multiclass: Train acc: 0.7559, Val acc: 0.7528, Val F1: 0.7476
  Contralateral: Train acc: 0.8796, Val acc: 0.8809, Val F1: 0.7644
  Ipsilateral: Train acc: 0.8551, Val acc: 0.8135, Val F1: 0.0235
New best model saved (val_loss: 0.5049)
Epoch 46/100 - Train loss: 0.5191, Val loss: 0.4965, Learning rate: 0.000100
  Multiclass: Train acc: 0.7583, Val acc: 0.7596, Val F1: 0.7562
  Contralateral: Train acc: 0.8854, Val acc: 0.8831, Val F1: 0.7699
  Ipsilateral: Train acc: 0.8464, Val acc: 0.8337, Val F1: 0.2600
New best model saved (val_loss: 0.4965)
Epoch 47/100 - Train loss: 0.5191, Val loss: 0.4850, Learning rate: 0.000100
  Multiclass: Train acc: 0.7545, Val acc: 0.7730, Val F1: 0.7715
  Contralateral: Train acc: 0.8902, Val acc: 0.8831, Val F1: 0.7797
  Ipsilateral: Train acc: 0.8426, Val acc: 0.8472, Val F1: 0.3929
New best model saved (val_loss: 0.4850)
Epoch 48/100 - Train loss: 0.5019, Val loss: 0.4688, Learning rate: 0.000100
  Multiclass: Train acc: 0.7727, Val acc: 0.7775, Val F1: 0.7760
  Contralateral: Train acc: 0.8801, Val acc: 0.8899, Val F1: 0.7860
  Ipsilateral: Train acc: 0.8474, Val acc: 0.8674, Val F1: 0.5354
Epoch 51 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.16it/s, loss=0.4689]
Epoch 51 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.16it/s, loss=0.4689]
Epoch 49/100 - Train loss: 0.4931, Val loss: 0.4660, Learning rate: 0.000100
  Multiclass: Train acc: 0.7761, Val acc: 0.7708, Val F1: 0.7712
  Contralateral: Train acc: 0.8873, Val acc: 0.8787, Val F1: 0.7652
  Ipsilateral: Train acc: 0.8536, Val acc: 0.8809, Val F1: 0.6395
New best model saved (val_loss: 0.4660)
Epoch 50/100 - Train loss: 0.4878, Val loss: 0.4619, Learning rate: 0.000100
  Multiclass: Train acc: 0.7670, Val acc: 0.7820, Val F1: 0.7816
  Contralateral: Train acc: 0.8897, Val acc: 0.8854, Val F1: 0.7866
  Ipsilateral: Train acc: 0.8464, Val acc: 0.8787, Val F1: 0.6250
New best model saved (val_loss: 0.4619)
Epoch 51/100 - Train loss: 0.4689, Val loss: 0.4514, Learning rate: 0.000100
  Multiclass: Train acc: 0.7877, Val acc: 0.7933, Val F1: 0.7927
  Contralateral: Train acc: 0.8999, Val acc: 0.8921, Val F1: 0.7966
  Ipsilateral: Train acc: 0.8527, Val acc: 0.8809, Val F1: 0.6395
Epoch 55 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 149.61it/s, loss=0.4366]
Epoch 55 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 149.61it/s, loss=0.4366]
Epoch 52/100 - Train loss: 0.4717, Val loss: 0.4413, Learning rate: 0.000100
  Multiclass: Train acc: 0.7776, Val acc: 0.7843, Val F1: 0.7834
  Contralateral: Train acc: 0.8970, Val acc: 0.8831, Val F1: 0.7719
  Ipsilateral: Train acc: 0.8575, Val acc: 0.8899, Val F1: 0.6711
New best model saved (val_loss: 0.4413)
Epoch 53/100 - Train loss: 0.4582, Val loss: 0.4489, Learning rate: 0.000100
  Multiclass: Train acc: 0.7949, Val acc: 0.7955, Val F1: 0.7963
  Contralateral: Train acc: 0.9056, Val acc: 0.8809, Val F1: 0.7745
  Ipsilateral: Train acc: 0.8681, Val acc: 0.9079, Val F1: 0.7389
Epoch 54/100 - Train loss: 0.4612, Val loss: 0.4395, Learning rate: 0.000100
  Multiclass: Train acc: 0.7983, Val acc: 0.7955, Val F1: 0.7961
  Contralateral: Train acc: 0.9027, Val acc: 0.8854, Val F1: 0.7733
  Ipsilateral: Train acc: 0.8609, Val acc: 0.9101, Val F1: 0.7468
New best model saved (val_loss: 0.4395)
Epoch 55/100 - Train loss: 0.4366, Val loss: 0.4301, Learning rate: 0.000100
  Multiclass: Train acc: 0.7983, Val acc: 0.8022, Val F1: 0.8035
  Contralateral: Train acc: 0.9114, Val acc: 0.8876, Val F1: 0.7826
  Ipsilateral: Train acc: 0.8714, Val acc: 0.8966, Val F1: 0.7229
Epoch 59 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.82it/s, loss=0.4147]
Epoch 59 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.82it/s, loss=0.4147]
Epoch 56/100 - Train loss: 0.4395, Val loss: 0.4166, Learning rate: 0.000100
  Multiclass: Train acc: 0.8007, Val acc: 0.7888, Val F1: 0.7900
  Contralateral: Train acc: 0.8999, Val acc: 0.8876, Val F1: 0.7788
  Ipsilateral: Train acc: 0.8724, Val acc: 0.9011, Val F1: 0.7349
New best model saved (val_loss: 0.4166)
Epoch 57/100 - Train loss: 0.4318, Val loss: 0.4079, Learning rate: 0.000100
  Multiclass: Train acc: 0.8108, Val acc: 0.8045, Val F1: 0.8050
  Contralateral: Train acc: 0.9109, Val acc: 0.8989, Val F1: 0.7926
  Ipsilateral: Train acc: 0.8806, Val acc: 0.9079, Val F1: 0.7630
New best model saved (val_loss: 0.4079)
Epoch 58/100 - Train loss: 0.4381, Val loss: 0.4025, Learning rate: 0.000100
  Multiclass: Train acc: 0.8036, Val acc: 0.8090, Val F1: 0.8095
  Contralateral: Train acc: 0.9008, Val acc: 0.8989, Val F1: 0.7982
  Ipsilateral: Train acc: 0.8763, Val acc: 0.9079, Val F1: 0.7574
New best model saved (val_loss: 0.4025)
Epoch 59/100 - Train loss: 0.4147, Val loss: 0.3947, Learning rate: 0.000100
  Multiclass: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.8118
  Contralateral: Train acc: 0.9090, Val acc: 0.8966, Val F1: 0.7965
  Ipsilateral: Train acc: 0.8888, Val acc: 0.9079, Val F1: 0.7574
Epoch 63 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.04it/s, loss=0.3836]
Epoch 63 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.04it/s, loss=0.3836]
Epoch 60/100 - Train loss: 0.4110, Val loss: 0.3878, Learning rate: 0.000100
  Multiclass: Train acc: 0.8344, Val acc: 0.8022, Val F1: 0.8026
  Contralateral: Train acc: 0.9148, Val acc: 0.8989, Val F1: 0.7982
  Ipsilateral: Train acc: 0.8864, Val acc: 0.9101, Val F1: 0.7647
New best model saved (val_loss: 0.3878)
Epoch 61/100 - Train loss: 0.3961, Val loss: 0.3774, Learning rate: 0.000100
  Multiclass: Train acc: 0.8291, Val acc: 0.8135, Val F1: 0.8143
  Contralateral: Train acc: 0.9186, Val acc: 0.9011, Val F1: 0.8018
  Ipsilateral: Train acc: 0.8844, Val acc: 0.9169, Val F1: 0.7886
New best model saved (val_loss: 0.3774)
Epoch 62/100 - Train loss: 0.4257, Val loss: 0.3767, Learning rate: 0.000100
  Multiclass: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.8117
  Contralateral: Train acc: 0.9052, Val acc: 0.8989, Val F1: 0.8000
  Ipsilateral: Train acc: 0.8849, Val acc: 0.9146, Val F1: 0.7765
  File "/home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/scripts/train.py", line 112, in maina
    ret = sweeper.sweep(arguments=task_overrides)
  File "/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_sweeper.py", line 177, in sweep
    results = self.launcher.launch(batch, initial_job_idx=initial_job_idx)
  File "/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py", line 74, in launch
    ret = run_job(
  File "/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/scripts/train.py", line 112, in maina
    predictions, targets = trainer.train()
  File "/home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/src/training/trainer.py", line 134, in train
    train_loss, train_metrics = self._train_epoch(epoch)
  File "/home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/src/training/trainer.py", line 252, in _train_epoch
    inputs = inputs.to(self.device)
KeyboardInterrupt
Epoch 63/100 - Train loss: 0.3836, Val loss: 0.3764, Learning rate: 0.000100
  Multiclass: Train acc: 0.8344, Val acc: 0.8337, Val F1: 0.8346
  Contralateral: Train acc: 0.9182, Val acc: 0.9079, Val F1: 0.8210
  Ipsilateral: Train acc: 0.8955, Val acc: 0.9236, Val F1: 0.8046
New best model saved (val_loss: 0.3764)