Starting training for lstm model...
Epoch 1/500 - Train loss: 1.1949, Val loss: 1.0924, Learning rate: 0.001000
  Multiclass: Train acc: 0.5099, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6803, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7853, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0924)
Epoch 2/500 - Train loss: 1.0907, Val loss: 1.0276, Learning rate: 0.001000
  Multiclass: Train acc: 0.5662, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0276)
Epoch 3/500 - Train loss: 0.9867, Val loss: 0.9140, Learning rate: 0.001000
  Multiclass: Train acc: 0.5778, Val acc: 0.6045, Val F1: 0.4987
  Contralateral: Train acc: 0.7439, Val acc: 0.7820, Val F1: 0.2240
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9140)
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 124.24it/s, loss=1.1949]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.42it/s]
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.31it/s, loss=1.0907]
Epoch 2 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.70it/s]
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 165.89it/s, loss=0.9867]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 129.28it/s]
Epoch 4 (Train):   0%|                                          | 0/65 [00:00<?, ?it/s]
Epoch 4/500 - Train loss: 0.8367, Val loss: 0.7161, Learning rate: 0.001000
  Multiclass: Train acc: 0.6143, Val acc: 0.6427, Val F1: 0.5746
  Contralateral: Train acc: 0.7737, Val acc: 0.8247, Val F1: 0.5938
  Ipsilateral: Train acc: 0.8252, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7161)
Epoch 5/500 - Train loss: 0.6484, Val loss: 0.5684, Learning rate: 0.001000
  Multiclass: Train acc: 0.6923, Val acc: 0.7573, Val F1: 0.7530
  Contralateral: Train acc: 0.8291, Val acc: 0.8562, Val F1: 0.6981
  Ipsilateral: Train acc: 0.8459, Val acc: 0.8652, Val F1: 0.5455
New best model saved (val_loss: 0.5684)
Epoch 6/500 - Train loss: 0.5190, Val loss: 0.5120, Learning rate: 0.001000
  Multiclass: Train acc: 0.7655, Val acc: 0.7685, Val F1: 0.7698
  Contralateral: Train acc: 0.8700, Val acc: 0.8809, Val F1: 0.7512
  Ipsilateral: Train acc: 0.8719, Val acc: 0.8809, Val F1: 0.7196
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 167.33it/s, loss=0.8367]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.57it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.45it/s, loss=0.6484]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.08it/s]
Epoch 6 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 162.73it/s, loss=0.5190]
Epoch 6 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.19it/s]
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 163.63it/s, loss=0.4490]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 128.15it/s]
Epoch 7/500 - Train loss: 0.4490, Val loss: 0.4433, Learning rate: 0.001000
  Multiclass: Train acc: 0.7915, Val acc: 0.7955, Val F1: 0.7962
  Contralateral: Train acc: 0.8883, Val acc: 0.8831, Val F1: 0.7679
  Ipsilateral: Train acc: 0.8830, Val acc: 0.9056, Val F1: 0.7586
New best model saved (val_loss: 0.4433)
Epoch 8/500 - Train loss: 0.4122, Val loss: 0.4744, Learning rate: 0.001000
  Multiclass: Train acc: 0.8156, Val acc: 0.7775, Val F1: 0.7785
  Contralateral: Train acc: 0.8907, Val acc: 0.8652, Val F1: 0.7414
  Ipsilateral: Train acc: 0.9047, Val acc: 0.8989, Val F1: 0.7305
Epoch 9/500 - Train loss: 0.3589, Val loss: 0.4315, Learning rate: 0.001000
  Multiclass: Train acc: 0.8503, Val acc: 0.7978, Val F1: 0.7985
  Contralateral: Train acc: 0.9148, Val acc: 0.8742, Val F1: 0.7565
  Ipsilateral: Train acc: 0.9138, Val acc: 0.9258, Val F1: 0.8000
New best model saved (val_loss: 0.4315)
Epoch 10/500 - Train loss: 0.3562, Val loss: 0.4628, Learning rate: 0.001000
  Multiclass: Train acc: 0.8681, Val acc: 0.8270, Val F1: 0.8279
  Contralateral: Train acc: 0.9220, Val acc: 0.8921, Val F1: 0.8000
  Ipsilateral: Train acc: 0.9331, Val acc: 0.9236, Val F1: 0.8000
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 166.06it/s, loss=0.4122]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.11it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.11it/s, loss=0.3589]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 130.14it/s]
Epoch 10 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.44it/s, loss=0.3562]
Epoch 10 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.54it/s]
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.28it/s, loss=0.2802]
Epoch 11 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 11/500 - Train loss: 0.2802, Val loss: 0.4330, Learning rate: 0.001000
  Multiclass: Train acc: 0.8888, Val acc: 0.8090, Val F1: 0.8103
  Contralateral: Train acc: 0.9374, Val acc: 0.8787, Val F1: 0.7652
  Ipsilateral: Train acc: 0.9475, Val acc: 0.9213, Val F1: 0.8045
Epoch 12/500 - Train loss: 0.2818, Val loss: 0.4013, Learning rate: 0.001000
  Multiclass: Train acc: 0.8907, Val acc: 0.8315, Val F1: 0.8319
  Contralateral: Train acc: 0.9307, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.9543, Val acc: 0.9348, Val F1: 0.8362
New best model saved (val_loss: 0.4013)
Epoch 13/500 - Train loss: 0.2538, Val loss: 0.4507, Learning rate: 0.001000
  Multiclass: Train acc: 0.9167, Val acc: 0.8449, Val F1: 0.8448
  Contralateral: Train acc: 0.9490, Val acc: 0.9079, Val F1: 0.8075
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9416, Val F1: 0.8471
Epoch 14/500 - Train loss: 0.2336, Val loss: 0.4511, Learning rate: 0.001000
  Multiclass: Train acc: 0.9191, Val acc: 0.8472, Val F1: 0.8474
  Contralateral: Train acc: 0.9504, Val acc: 0.9079, Val F1: 0.8210
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 130.24it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.45it/s, loss=0.2818]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 129.07it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.28it/s, loss=0.2538]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.43it/s]
Epoch 14 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.74it/s, loss=0.2336]
Epoch 14 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.06it/s]
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.15it/s, loss=0.2270]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.60it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.55it/s, loss=0.2012]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 131.44it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.29it/s, loss=0.2128]
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.20it/s]
Epoch 18 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.79it/s, loss=0.2019]
Epoch 18 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.84it/s]
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 166.78it/s, loss=0.1327]
Epoch 19 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 15/500 - Train loss: 0.2270, Val loss: 0.4458, Learning rate: 0.001000
  Multiclass: Train acc: 0.9177, Val acc: 0.8360, Val F1: 0.8367
  Contralateral: Train acc: 0.9475, Val acc: 0.9011, Val F1: 0.8103
  Ipsilateral: Train acc: 0.9653, Val acc: 0.9348, Val F1: 0.8343
Epoch 16/500 - Train loss: 0.2012, Val loss: 0.4498, Learning rate: 0.001000
  Multiclass: Train acc: 0.9350, Val acc: 0.8539, Val F1: 0.8539
  Contralateral: Train acc: 0.9591, Val acc: 0.9124, Val F1: 0.8186
  Ipsilateral: Train acc: 0.9754, Val acc: 0.9416, Val F1: 0.8506
Epoch 17/500 - Train loss: 0.2128, Val loss: 0.4404, Learning rate: 0.001000
  Multiclass: Train acc: 0.9249, Val acc: 0.8629, Val F1: 0.8633
  Contralateral: Train acc: 0.9576, Val acc: 0.9079, Val F1: 0.8178
  Ipsilateral: Train acc: 0.9653, Val acc: 0.9506, Val F1: 0.8690
Epoch 00018: reducing learning rate of group 0 to 5.0000e-04.
Epoch 18/500 - Train loss: 0.2019, Val loss: 0.4296, Learning rate: 0.000500
  Multiclass: Train acc: 0.9312, Val acc: 0.8584, Val F1: 0.8587
  Contralateral: Train acc: 0.9571, Val acc: 0.9303, Val F1: 0.8584
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 130.11it/s]
Testing: 100%|████████████████████████████████████████| 14/14 [00:00<00:00, 118.50it/s]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 163.86it/s, loss=1.3150]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 126.39it/s]
Epoch 2 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 166.63it/s, loss=1.2835]
Epoch 2 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 131.93it/s]
Epoch 3 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.98it/s, loss=1.2356]
Epoch 3 (Val):   0%|                                            | 0/14 [00:00<?, ?it/s]
Epoch 19/500 - Train loss: 0.1327, Val loss: 0.4443, Learning rate: 0.000500
  Multiclass: Train acc: 0.9456, Val acc: 0.8607, Val F1: 0.8612
  Contralateral: Train acc: 0.9644, Val acc: 0.9281, Val F1: 0.8571
  Ipsilateral: Train acc: 0.9783, Val acc: 0.9303, Val F1: 0.8229
Early stopping triggered after 19 epochs
Best model was at epoch 12
Training completed. Best validation loss: 0.4013
Evaluating on test set...
[2025-04-09 16:21:29,106][HYDRA] 	#1 : model=lstm model.hidden_size=32 model.num_layers=1 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, batch_first=True)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 62727
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.3150, Val loss: 1.2790, Learning rate: 0.000100
  Multiclass: Train acc: 0.3495, Val acc: 0.4787, Val F1: 0.4178
  Contralateral: Train acc: 0.4892, Val acc: 0.5393, Val F1: 0.2807
  Ipsilateral: Train acc: 0.6837, Val acc: 0.8022, Val F1: 0.0222
New best model saved (val_loss: 1.2790)
Epoch 2/500 - Train loss: 1.2835, Val loss: 1.2407, Learning rate: 0.000100
  Multiclass: Train acc: 0.4343, Val acc: 0.5596, Val F1: 0.4216
  Contralateral: Train acc: 0.5407, Val acc: 0.6809, Val F1: 0.1647
  Ipsilateral: Train acc: 0.7443, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.2407)
Epoch 3/500 - Train loss: 1.2356, Val loss: 1.2072, Learning rate: 0.000100
  Multiclass: Train acc: 0.4988, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6115, Val acc: 0.7416, Val F1: 0.0650
  Ipsilateral: Train acc: 0.7747, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.2072)
Epoch 4/500 - Train loss: 1.2116, Val loss: 1.1784, Learning rate: 0.000100
  Multiclass: Train acc: 0.5243, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6668, Val acc: 0.7506, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8007, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1784)
Epoch 5/500 - Train loss: 1.1920, Val loss: 1.1582, Learning rate: 0.000100
  Multiclass: Train acc: 0.5412, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6644, Val acc: 0.7528, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8113, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1582)
Epoch 6/500 - Train loss: 1.1696, Val loss: 1.1391, Learning rate: 0.000100
  Multiclass: Train acc: 0.5484, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6967, Val acc: 0.7528, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8132, Val acc: 0.8112, Val F1: 0.0000
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 121.65it/s]
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 161.04it/s, loss=1.2116]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.23it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.04it/s, loss=1.1920]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.03it/s]
Epoch 6 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 164.23it/s, loss=1.1696]
Epoch 6 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.89it/s]
Epoch 7 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 162.87it/s, loss=1.1570]
Epoch 7 (Val):   0%|                                            | 0/14 [00:00<?, ?it/s]
Epoch 7/500 - Train loss: 1.1570, Val loss: 1.1199, Learning rate: 0.000100
  Multiclass: Train acc: 0.5518, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7164, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8146, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1199)
Epoch 8/500 - Train loss: 1.1394, Val loss: 1.1097, Learning rate: 0.000100
  Multiclass: Train acc: 0.5633, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7097, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1097)
Epoch 9/500 - Train loss: 1.1229, Val loss: 1.0958, Learning rate: 0.000100
  Multiclass: Train acc: 0.5623, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7236, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0958)
Epoch 10/500 - Train loss: 1.1169, Val loss: 1.0847, Learning rate: 0.000100
  Multiclass: Train acc: 0.5623, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7198, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.31it/s]
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 166.68it/s, loss=1.1394]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 135.47it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 167.08it/s, loss=1.1229]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.43it/s]
Epoch 10 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.91it/s, loss=1.1169]
Epoch 10 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.72it/s]
Epoch 11 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.24it/s, loss=1.0956]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 131.89it/s]
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.00it/s, loss=1.0769]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.69it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.05it/s, loss=1.0715]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.29it/s]
Epoch 14 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.86it/s, loss=1.0600]
Epoch 14 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.88it/s]
Epoch 15 (Train):  75%|█████████████▌    | 49/65 [00:00<00:00, 174.21it/s, loss=1.0491]
Epoch 11/500 - Train loss: 1.0956, Val loss: 1.0753, Learning rate: 0.000100
  Multiclass: Train acc: 0.5667, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0753)
Epoch 12/500 - Train loss: 1.0769, Val loss: 1.0673, Learning rate: 0.000100
  Multiclass: Train acc: 0.5643, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7342, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0673)
Epoch 13/500 - Train loss: 1.0715, Val loss: 1.0543, Learning rate: 0.000100
  Multiclass: Train acc: 0.5686, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7246, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0543)
Epoch 14/500 - Train loss: 1.0600, Val loss: 1.0441, Learning rate: 0.000100
  Multiclass: Train acc: 0.5686, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7434, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0441)
Epoch 15/500 - Train loss: 1.0462, Val loss: 1.0329, Learning rate: 0.000100
  Multiclass: Train acc: 0.5681, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7419, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0329)
Epoch 16/500 - Train loss: 1.0271, Val loss: 1.0188, Learning rate: 0.000100
  Multiclass: Train acc: 0.5710, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7443, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0188)
Epoch 17/500 - Train loss: 1.0175, Val loss: 1.0034, Learning rate: 0.000100
  Multiclass: Train acc: 0.5787, Val acc: 0.5708, Val F1: 0.4195
  Contralateral: Train acc: 0.7357, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
Epoch 15 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.73it/s, loss=1.0462]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.27it/s]
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.09it/s, loss=1.0271]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.74it/s]
Epoch 17 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.22it/s, loss=1.0175]
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.72it/s]
Epoch 18 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.06it/s, loss=1.0134]
Epoch 18 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.97it/s]
Epoch 19 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.59it/s, loss=0.9861]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.70it/s]
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.71it/s, loss=0.9781]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 134.94it/s]
Epoch 21 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.27it/s, loss=0.9483]
Epoch 21 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.48it/s]
Epoch 22 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.16it/s, loss=0.9373]
Epoch 22 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 131.76it/s]
Epoch 23 (Train):  11%|██▏                 | 7/65 [00:00<00:00, 67.10it/s, loss=0.9392]
Epoch 18/500 - Train loss: 1.0134, Val loss: 0.9896, Learning rate: 0.000100
  Multiclass: Train acc: 0.5763, Val acc: 0.5775, Val F1: 0.4339
  Contralateral: Train acc: 0.7410, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9896)
Epoch 19/500 - Train loss: 0.9861, Val loss: 0.9754, Learning rate: 0.000100
  Multiclass: Train acc: 0.5749, Val acc: 0.5798, Val F1: 0.4386
  Contralateral: Train acc: 0.7429, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9754)
Epoch 20/500 - Train loss: 0.9781, Val loss: 0.9559, Learning rate: 0.000100
  Multiclass: Train acc: 0.5845, Val acc: 0.5865, Val F1: 0.4522
  Contralateral: Train acc: 0.7453, Val acc: 0.7618, Val F1: 0.0536
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9559)
Epoch 21/500 - Train loss: 0.9483, Val loss: 0.9355, Learning rate: 0.000100
  Multiclass: Train acc: 0.5927, Val acc: 0.5865, Val F1: 0.4581
  Contralateral: Train acc: 0.7578, Val acc: 0.7640, Val F1: 0.0870
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
Epoch 23 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.45it/s, loss=0.9076]
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.78it/s]
Epoch 24 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.88it/s, loss=0.8776]
Epoch 24 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.94it/s]
Epoch 25 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.96it/s, loss=0.8494]
Epoch 25 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 132.67it/s]
Epoch 26 (Train):   6%|█▏                  | 4/65 [00:00<00:01, 39.10it/s, loss=0.8429]
Epoch 22/500 - Train loss: 0.9373, Val loss: 0.9160, Learning rate: 0.000100
  Multiclass: Train acc: 0.5946, Val acc: 0.5933, Val F1: 0.4803
  Contralateral: Train acc: 0.7535, Val acc: 0.7708, Val F1: 0.1356
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9160)
Epoch 23/500 - Train loss: 0.9076, Val loss: 0.8987, Learning rate: 0.000100
  Multiclass: Train acc: 0.6023, Val acc: 0.6135, Val F1: 0.5127
  Contralateral: Train acc: 0.7578, Val acc: 0.7775, Val F1: 0.1818
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8987)
Epoch 24/500 - Train loss: 0.8776, Val loss: 0.8721, Learning rate: 0.000100
  Multiclass: Train acc: 0.6153, Val acc: 0.6225, Val F1: 0.5304
  Contralateral: Train acc: 0.7684, Val acc: 0.7865, Val F1: 0.2520
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8721)
Epoch 25/500 - Train loss: 0.8494, Val loss: 0.8467, Learning rate: 0.000100
  Multiclass: Train acc: 0.6201, Val acc: 0.6292, Val F1: 0.5462
  Contralateral: Train acc: 0.7838, Val acc: 0.7978, Val F1: 0.3478
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
Epoch 26 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.33it/s, loss=0.8406]
Epoch 26 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.50it/s]
Epoch 27 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.60it/s, loss=0.8143]
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 129.08it/s]
Epoch 28 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.46it/s, loss=0.7922]
Epoch 28 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 116.64it/s]
Epoch 29 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.01it/s, loss=0.7604]
Epoch 29 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.60it/s]
Epoch 30 (Train):   0%|                            | 0/65 [00:00<?, ?it/s, loss=0.6556]
Epoch 26/500 - Train loss: 0.8406, Val loss: 0.8249, Learning rate: 0.000100
  Multiclass: Train acc: 0.6196, Val acc: 0.6337, Val F1: 0.5552
  Contralateral: Train acc: 0.7824, Val acc: 0.8045, Val F1: 0.4314
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8249)
Epoch 27/500 - Train loss: 0.8143, Val loss: 0.7990, Learning rate: 0.000100
  Multiclass: Train acc: 0.6365, Val acc: 0.6292, Val F1: 0.5554
  Contralateral: Train acc: 0.7954, Val acc: 0.8202, Val F1: 0.5506
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7990)
Epoch 28/500 - Train loss: 0.7922, Val loss: 0.7733, Learning rate: 0.000100
  Multiclass: Train acc: 0.6394, Val acc: 0.6315, Val F1: 0.5579
  Contralateral: Train acc: 0.7915, Val acc: 0.8202, Val F1: 0.5604
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7733)
Epoch 29/500 - Train loss: 0.7604, Val loss: 0.7481, Learning rate: 0.000100
  Multiclass: Train acc: 0.6481, Val acc: 0.6315, Val F1: 0.5595
  Contralateral: Train acc: 0.8065, Val acc: 0.8315, Val F1: 0.6114
  Ipsilateral: Train acc: 0.8257, Val acc: 0.8112, Val F1: 0.0000
Epoch 30 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 108.55it/s]
Epoch 30 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 108.55it/s]
Epoch 31 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.33it/s, loss=0.7023]
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.18it/s]
Epoch 32 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.40it/s, loss=0.6786]
Epoch 32 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.16it/s]
Epoch 33 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.66it/s, loss=0.6673]
Epoch 33 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 30/500 - Train loss: 0.7306, Val loss: 0.7247, Learning rate: 0.000100
  Multiclass: Train acc: 0.6562, Val acc: 0.6427, Val F1: 0.5706
  Contralateral: Train acc: 0.8065, Val acc: 0.8270, Val F1: 0.6010
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7247)
Epoch 31/500 - Train loss: 0.7023, Val loss: 0.7030, Learning rate: 0.000100
  Multiclass: Train acc: 0.6707, Val acc: 0.6562, Val F1: 0.5857
  Contralateral: Train acc: 0.8146, Val acc: 0.8449, Val F1: 0.6601
  Ipsilateral: Train acc: 0.8272, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7030)
Epoch 32/500 - Train loss: 0.6786, Val loss: 0.6830, Learning rate: 0.000100
  Multiclass: Train acc: 0.6856, Val acc: 0.6562, Val F1: 0.5862
  Contralateral: Train acc: 0.8334, Val acc: 0.8360, Val F1: 0.6473
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8112, Val F1: 0.0000
Epoch 37 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.41it/s, loss=0.5566]
Epoch 34 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.36it/s, loss=0.6198]
Epoch 34 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.17it/s]
Epoch 35 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.50it/s, loss=0.6181]
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.65it/s]
Epoch 36 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.60it/s, loss=0.5929]
Epoch 36 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 132.61it/s]
Epoch 37 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.41it/s, loss=0.5566]
Epoch 37 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]
Epoch 33/500 - Train loss: 0.6673, Val loss: 0.6620, Learning rate: 0.000100
  Multiclass: Train acc: 0.6899, Val acc: 0.6539, Val F1: 0.5833
  Contralateral: Train acc: 0.8416, Val acc: 0.8382, Val F1: 0.6471
  Ipsilateral: Train acc: 0.8291, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6620)
Epoch 34/500 - Train loss: 0.6198, Val loss: 0.6414, Learning rate: 0.000100
  Multiclass: Train acc: 0.6962, Val acc: 0.6719, Val F1: 0.6010
  Contralateral: Train acc: 0.8406, Val acc: 0.8517, Val F1: 0.6944
  Ipsilateral: Train acc: 0.8315, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6414)
Epoch 35/500 - Train loss: 0.6181, Val loss: 0.6262, Learning rate: 0.000100
  Multiclass: Train acc: 0.7174, Val acc: 0.6629, Val F1: 0.5926
  Contralateral: Train acc: 0.8503, Val acc: 0.8539, Val F1: 0.6977
  Ipsilateral: Train acc: 0.8344, Val acc: 0.8135, Val F1: 0.0235
New best model saved (val_loss: 0.6262)
Epoch 36/500 - Train loss: 0.5929, Val loss: 0.6036, Learning rate: 0.000100
  Multiclass: Train acc: 0.7121, Val acc: 0.6876, Val F1: 0.6275
  Contralateral: Train acc: 0.8580, Val acc: 0.8607, Val F1: 0.7130
  Ipsilateral: Train acc: 0.8402, Val acc: 0.8180, Val F1: 0.0690
Epoch 37 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.01it/s]
Epoch 38 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.56it/s, loss=0.5378]
Epoch 38 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.67it/s]
Epoch 39 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 167.43it/s, loss=0.5461]
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.14it/s]
Epoch 40 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.08it/s, loss=0.5077]
Epoch 40 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.87it/s]
Epoch 41 (Train):  74%|█████████████▎    | 48/65 [00:00<00:00, 173.58it/s, loss=0.4882]
Epoch 37 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.01it/s]
Epoch 37/500 - Train loss: 0.5566, Val loss: 0.5933, Learning rate: 0.000100
  Multiclass: Train acc: 0.7439, Val acc: 0.6899, Val F1: 0.6378
  Contralateral: Train acc: 0.8671, Val acc: 0.8629, Val F1: 0.7289
  Ipsilateral: Train acc: 0.8483, Val acc: 0.8270, Val F1: 0.1538
New best model saved (val_loss: 0.5933)
Epoch 38/500 - Train loss: 0.5378, Val loss: 0.5695, Learning rate: 0.000100
  Multiclass: Train acc: 0.7496, Val acc: 0.7101, Val F1: 0.6680
  Contralateral: Train acc: 0.8729, Val acc: 0.8674, Val F1: 0.7256
  Ipsilateral: Train acc: 0.8455, Val acc: 0.8225, Val F1: 0.1505
New best model saved (val_loss: 0.5695)
Epoch 39/500 - Train loss: 0.5461, Val loss: 0.5502, Learning rate: 0.000100
  Multiclass: Train acc: 0.7419, Val acc: 0.7326, Val F1: 0.7130
  Contralateral: Train acc: 0.8748, Val acc: 0.8787, Val F1: 0.7568
  Ipsilateral: Train acc: 0.8479, Val acc: 0.8427, Val F1: 0.3137
New best model saved (val_loss: 0.5502)
Epoch 40/500 - Train loss: 0.5077, Val loss: 0.5300, Learning rate: 0.000100
  Multiclass: Train acc: 0.7670, Val acc: 0.7573, Val F1: 0.7442
  Contralateral: Train acc: 0.8710, Val acc: 0.8787, Val F1: 0.7611
  Ipsilateral: Train acc: 0.8483, Val acc: 0.8449, Val F1: 0.3551
Epoch 41 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.38it/s]
Epoch 42 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.81it/s, loss=0.4721]
Epoch 42 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 132.05it/s]
Epoch 43 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 161.43it/s, loss=0.4541]
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 132.48it/s]
Epoch 44 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.88it/s, loss=0.4387]
Epoch 44 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 127.75it/s]
Epoch 45 (Train):  74%|█████████████▎    | 48/65 [00:00<00:00, 173.25it/s, loss=0.4332]
Epoch 41 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.38it/s]
Epoch 41/500 - Train loss: 0.4867, Val loss: 0.5204, Learning rate: 0.000100
  Multiclass: Train acc: 0.7703, Val acc: 0.7708, Val F1: 0.7604
  Contralateral: Train acc: 0.8912, Val acc: 0.8854, Val F1: 0.7692
  Ipsilateral: Train acc: 0.8647, Val acc: 0.8584, Val F1: 0.4522
New best model saved (val_loss: 0.5204)
Epoch 42/500 - Train loss: 0.4721, Val loss: 0.5086, Learning rate: 0.000100
  Multiclass: Train acc: 0.7882, Val acc: 0.7730, Val F1: 0.7689
  Contralateral: Train acc: 0.8960, Val acc: 0.8809, Val F1: 0.7665
  Ipsilateral: Train acc: 0.8628, Val acc: 0.8831, Val F1: 0.6000
New best model saved (val_loss: 0.5086)
Epoch 43/500 - Train loss: 0.4541, Val loss: 0.4983, Learning rate: 0.000100
  Multiclass: Train acc: 0.7992, Val acc: 0.7798, Val F1: 0.7757
  Contralateral: Train acc: 0.8873, Val acc: 0.8854, Val F1: 0.7733
  Ipsilateral: Train acc: 0.8734, Val acc: 0.8944, Val F1: 0.6519
New best model saved (val_loss: 0.4983)
Epoch 44/500 - Train loss: 0.4387, Val loss: 0.4913, Learning rate: 0.000100
  Multiclass: Train acc: 0.8031, Val acc: 0.7775, Val F1: 0.7748
  Contralateral: Train acc: 0.8955, Val acc: 0.8809, Val F1: 0.7706
  Ipsilateral: Train acc: 0.8830, Val acc: 0.9011, Val F1: 0.6857
Epoch 45 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.25it/s]
Epoch 46 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.09it/s, loss=0.4144]
Epoch 46 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.62it/s]
Epoch 47 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.69it/s, loss=0.4083]
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 131.90it/s]
Epoch 48 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.07it/s, loss=0.3888]
Epoch 48 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.54it/s]
Epoch 49 (Train):  40%|███████▏          | 26/65 [00:00<00:00, 142.23it/s, loss=0.3747]
Epoch 45 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.25it/s]
Epoch 45/500 - Train loss: 0.4416, Val loss: 0.4740, Learning rate: 0.000100
  Multiclass: Train acc: 0.8065, Val acc: 0.7843, Val F1: 0.7823
  Contralateral: Train acc: 0.9013, Val acc: 0.8854, Val F1: 0.7773
  Ipsilateral: Train acc: 0.8681, Val acc: 0.9034, Val F1: 0.6993
New best model saved (val_loss: 0.4740)
Epoch 46/500 - Train loss: 0.4144, Val loss: 0.4710, Learning rate: 0.000100
  Multiclass: Train acc: 0.8151, Val acc: 0.8022, Val F1: 0.8018
  Contralateral: Train acc: 0.9047, Val acc: 0.8966, Val F1: 0.7946
  Ipsilateral: Train acc: 0.8844, Val acc: 0.9146, Val F1: 0.7595
New best model saved (val_loss: 0.4710)
Epoch 47/500 - Train loss: 0.4083, Val loss: 0.4666, Learning rate: 0.000100
  Multiclass: Train acc: 0.8204, Val acc: 0.7955, Val F1: 0.7947
  Contralateral: Train acc: 0.9018, Val acc: 0.8921, Val F1: 0.7876
  Ipsilateral: Train acc: 0.8873, Val acc: 0.9101, Val F1: 0.7333
New best model saved (val_loss: 0.4666)
Epoch 48/500 - Train loss: 0.3888, Val loss: 0.4512, Learning rate: 0.000100
  Multiclass: Train acc: 0.8349, Val acc: 0.8135, Val F1: 0.8137
  Contralateral: Train acc: 0.9148, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.8965, Val acc: 0.9169, Val F1: 0.7811
Epoch 49 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.59it/s]
Epoch 50 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.36it/s, loss=0.3617]
Epoch 50 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.18it/s]
Epoch 51 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.10it/s, loss=0.3448]
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.79it/s]
Epoch 52 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.66it/s, loss=0.3538]
Epoch 52 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.99it/s]
Epoch 53 (Train):   9%|█▊                  | 6/65 [00:00<00:00, 59.55it/s, loss=0.3367]
Epoch 49 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.59it/s]
Epoch 49/500 - Train loss: 0.3800, Val loss: 0.4509, Learning rate: 0.000100
  Multiclass: Train acc: 0.8310, Val acc: 0.8090, Val F1: 0.8086
  Contralateral: Train acc: 0.9100, Val acc: 0.8921, Val F1: 0.7857
  Ipsilateral: Train acc: 0.9032, Val acc: 0.9169, Val F1: 0.7702
New best model saved (val_loss: 0.4509)
Epoch 50/500 - Train loss: 0.3617, Val loss: 0.4519, Learning rate: 0.000100
  Multiclass: Train acc: 0.8445, Val acc: 0.7933, Val F1: 0.7932
  Contralateral: Train acc: 0.9095, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.8994, Val acc: 0.9079, Val F1: 0.7515
Epoch 51/500 - Train loss: 0.3448, Val loss: 0.4475, Learning rate: 0.000100
  Multiclass: Train acc: 0.8503, Val acc: 0.8000, Val F1: 0.8006
  Contralateral: Train acc: 0.9157, Val acc: 0.8831, Val F1: 0.7759
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9124, Val F1: 0.7692
Epoch 53 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.74it/s]
Epoch 54 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.75it/s, loss=0.3303]
Epoch 54 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.35it/s]
Epoch 55 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.11it/s, loss=0.3085]
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 106.18it/s]
Epoch 56 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 153.51it/s, loss=0.3120]
Epoch 56 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 101.40it/s]
Epoch 53 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.74it/s]
Epoch 52/500 - Train loss: 0.3538, Val loss: 0.4458, Learning rate: 0.000100
  Multiclass: Train acc: 0.8483, Val acc: 0.8000, Val F1: 0.8004
  Contralateral: Train acc: 0.9167, Val acc: 0.8854, Val F1: 0.7713
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9124, Val F1: 0.7771
New best model saved (val_loss: 0.4458)
Epoch 53/500 - Train loss: 0.3369, Val loss: 0.4388, Learning rate: 0.000100
  Multiclass: Train acc: 0.8637, Val acc: 0.7978, Val F1: 0.7984
  Contralateral: Train acc: 0.9133, Val acc: 0.8876, Val F1: 0.7826
  Ipsilateral: Train acc: 0.9133, Val acc: 0.9124, Val F1: 0.7719
New best model saved (val_loss: 0.4388)
Epoch 54/500 - Train loss: 0.3303, Val loss: 0.4355, Learning rate: 0.000100
  Multiclass: Train acc: 0.8613, Val acc: 0.8112, Val F1: 0.8116
  Contralateral: Train acc: 0.9254, Val acc: 0.8921, Val F1: 0.7778
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9169, Val F1: 0.7861
New best model saved (val_loss: 0.4355)
Epoch 55/500 - Train loss: 0.3085, Val loss: 0.4251, Learning rate: 0.000100
  Multiclass: Train acc: 0.8633, Val acc: 0.8090, Val F1: 0.8098
  Contralateral: Train acc: 0.9297, Val acc: 0.8831, Val F1: 0.7739
  Ipsilateral: Train acc: 0.9244, Val acc: 0.9281, Val F1: 0.8161
Epoch 57 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.21it/s]
Epoch 58 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 155.83it/s, loss=0.2831]
Epoch 58 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.70it/s]
Epoch 59 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 160.25it/s, loss=0.2776]
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.18it/s]
Epoch 60 (Train):  72%|█████████████     | 47/65 [00:00<00:00, 170.50it/s, loss=0.2510]
Epoch 57 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.21it/s]
Epoch 56/500 - Train loss: 0.3120, Val loss: 0.4310, Learning rate: 0.000100
  Multiclass: Train acc: 0.8748, Val acc: 0.8202, Val F1: 0.8203
  Contralateral: Train acc: 0.9307, Val acc: 0.8944, Val F1: 0.7854
  Ipsilateral: Train acc: 0.9220, Val acc: 0.9236, Val F1: 0.8046
Epoch 57/500 - Train loss: 0.2774, Val loss: 0.4224, Learning rate: 0.000100
  Multiclass: Train acc: 0.8820, Val acc: 0.8157, Val F1: 0.8163
  Contralateral: Train acc: 0.9336, Val acc: 0.8876, Val F1: 0.7768
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9281, Val F1: 0.8118
New best model saved (val_loss: 0.4224)
Epoch 58/500 - Train loss: 0.2831, Val loss: 0.4205, Learning rate: 0.000100
  Multiclass: Train acc: 0.8796, Val acc: 0.8180, Val F1: 0.8186
  Contralateral: Train acc: 0.9287, Val acc: 0.8876, Val F1: 0.7768
  Ipsilateral: Train acc: 0.9316, Val acc: 0.9303, Val F1: 0.8208
Epoch 61 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.50it/s]
Epoch 62 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 164.76it/s, loss=0.2580]
Epoch 62 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 132.21it/s]
Epoch 63 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 165.02it/s, loss=0.2715]
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.81it/s]
Epoch 64 (Train):  45%|████████          | 29/65 [00:00<00:00, 151.92it/s, loss=0.2610]
Epoch 61 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.50it/s]
Epoch 59/500 - Train loss: 0.2776, Val loss: 0.4102, Learning rate: 0.000100
  Multiclass: Train acc: 0.8849, Val acc: 0.8292, Val F1: 0.8297
  Contralateral: Train acc: 0.9292, Val acc: 0.8966, Val F1: 0.7928
  Ipsilateral: Train acc: 0.9422, Val acc: 0.9326, Val F1: 0.8315
New best model saved (val_loss: 0.4102)
Epoch 60/500 - Train loss: 0.2562, Val loss: 0.4199, Learning rate: 0.000100
  Multiclass: Train acc: 0.8936, Val acc: 0.8180, Val F1: 0.8183
  Contralateral: Train acc: 0.9413, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.9355, Val acc: 0.9348, Val F1: 0.8304
Epoch 61/500 - Train loss: 0.2626, Val loss: 0.4081, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8270, Val F1: 0.8279
  Contralateral: Train acc: 0.9364, Val acc: 0.8921, Val F1: 0.7931
  Ipsilateral: Train acc: 0.9432, Val acc: 0.9371, Val F1: 0.8372
New best model saved (val_loss: 0.4081)
Epoch 62/500 - Train loss: 0.2580, Val loss: 0.4101, Learning rate: 0.000100
  Multiclass: Train acc: 0.8941, Val acc: 0.8292, Val F1: 0.8301
  Contralateral: Train acc: 0.9384, Val acc: 0.8854, Val F1: 0.7792
Epoch 65 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.86it/s]
Epoch 66 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 163.09it/s, loss=0.2443]
Epoch 66 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.42it/s]
Epoch 67 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 162.43it/s, loss=0.2313]
Epoch 67 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.58it/s]
Epoch 68 (Train):  42%|███████▍          | 27/65 [00:00<00:00, 144.89it/s, loss=0.2398]
Epoch 65 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.86it/s]
Epoch 63/500 - Train loss: 0.2715, Val loss: 0.4263, Learning rate: 0.000100
  Multiclass: Train acc: 0.8917, Val acc: 0.8292, Val F1: 0.8295
  Contralateral: Train acc: 0.9364, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.9437, Val acc: 0.9303, Val F1: 0.8187
Epoch 64/500 - Train loss: 0.2479, Val loss: 0.4121, Learning rate: 0.000100
  Multiclass: Train acc: 0.8960, Val acc: 0.8315, Val F1: 0.8320
  Contralateral: Train acc: 0.9384, Val acc: 0.8944, Val F1: 0.7892
  Ipsilateral: Train acc: 0.9389, Val acc: 0.9348, Val F1: 0.8343
Epoch 65/500 - Train loss: 0.2459, Val loss: 0.4196, Learning rate: 0.000100
  Multiclass: Train acc: 0.9008, Val acc: 0.8382, Val F1: 0.8387
  Contralateral: Train acc: 0.9490, Val acc: 0.8989, Val F1: 0.7964
  Ipsilateral: Train acc: 0.9393, Val acc: 0.9326, Val F1: 0.8295
Epoch 66/500 - Train loss: 0.2443, Val loss: 0.4215, Learning rate: 0.000100
  Multiclass: Train acc: 0.8994, Val acc: 0.8315, Val F1: 0.8322
  Contralateral: Train acc: 0.9456, Val acc: 0.8876, Val F1: 0.7788
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 157.37it/s, loss=1.2028]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.97it/s]
Epoch 2 (Train):  72%|█████████████▋     | 47/65 [00:00<00:00, 167.68it/s, loss=1.0964]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 00067: reducing learning rate of group 0 to 5.0000e-05.
Epoch 67/500 - Train loss: 0.2313, Val loss: 0.4184, Learning rate: 0.000050
  Multiclass: Train acc: 0.9018, Val acc: 0.8292, Val F1: 0.8296
  Contralateral: Train acc: 0.9442, Val acc: 0.8899, Val F1: 0.7822
  Ipsilateral: Train acc: 0.9446, Val acc: 0.9371, Val F1: 0.8409
Epoch 68/500 - Train loss: 0.2284, Val loss: 0.4193, Learning rate: 0.000050
  Multiclass: Train acc: 0.9018, Val acc: 0.8292, Val F1: 0.8295
  Contralateral: Train acc: 0.9413, Val acc: 0.8854, Val F1: 0.7692
  Ipsilateral: Train acc: 0.9490, Val acc: 0.9371, Val F1: 0.8372
Early stopping triggered after 68 epochs
Best model was at epoch 61
Training completed. Best validation loss: 0.4081
Evaluating on test set...
[2025-04-09 16:22:05,598][HYDRA] 	#2 : model=lstm model.hidden_size=32 model.num_layers=2 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 71175
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.2028, Val loss: 1.1015, Learning rate: 0.001000
  Multiclass: Train acc: 0.5128, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6635, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7747, Val acc: 0.8112, Val F1: 0.0000
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.20it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 158.36it/s, loss=0.8626]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.14it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.55it/s, loss=0.7592]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 119.67it/s]
Epoch 6 (Train):  38%|███████▎           | 25/65 [00:00<00:00, 136.32it/s, loss=0.6409]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 122.20it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 2/500 - Train loss: 1.1079, Val loss: 1.0449, Learning rate: 0.001000
  Multiclass: Train acc: 0.5725, Val acc: 0.5685, Val F1: 0.4225
  Contralateral: Train acc: 0.7338, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0449)
Epoch 3/500 - Train loss: 1.0127, Val loss: 0.9263, Learning rate: 0.001000
  Multiclass: Train acc: 0.5840, Val acc: 0.6225, Val F1: 0.5364
  Contralateral: Train acc: 0.7434, Val acc: 0.7775, Val F1: 0.2326
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9263)
Epoch 4/500 - Train loss: 0.8626, Val loss: 0.8001, Learning rate: 0.001000
  Multiclass: Train acc: 0.6442, Val acc: 0.6337, Val F1: 0.5572
  Contralateral: Train acc: 0.8012, Val acc: 0.8180, Val F1: 0.5668
  Ipsilateral: Train acc: 0.8243, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8001)
Epoch 5/500 - Train loss: 0.7592, Val loss: 0.6777, Learning rate: 0.001000
  Multiclass: Train acc: 0.6668, Val acc: 0.6494, Val F1: 0.5854
  Contralateral: Train acc: 0.8175, Val acc: 0.8360, Val F1: 0.6697
  Ipsilateral: Train acc: 0.8262, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.80it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 155.77it/s, loss=0.5170]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 128.54it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 158.61it/s, loss=0.4473]
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 117.18it/s]
Epoch 10 (Train):   8%|█▌                  | 5/65 [00:00<00:01, 49.78it/s, loss=0.3589]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.80it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 6/500 - Train loss: 0.6495, Val loss: 0.5964, Learning rate: 0.001000
  Multiclass: Train acc: 0.7000, Val acc: 0.7416, Val F1: 0.7389
  Contralateral: Train acc: 0.8517, Val acc: 0.8607, Val F1: 0.7373
  Ipsilateral: Train acc: 0.8291, Val acc: 0.8090, Val F1: 0.0000
New best model saved (val_loss: 0.5964)
Epoch 7/500 - Train loss: 0.5590, Val loss: 0.5389, Learning rate: 0.001000
  Multiclass: Train acc: 0.7545, Val acc: 0.7663, Val F1: 0.7673
  Contralateral: Train acc: 0.8743, Val acc: 0.8674, Val F1: 0.7446
  Ipsilateral: Train acc: 0.8580, Val acc: 0.8697, Val F1: 0.6234
New best model saved (val_loss: 0.5389)
Epoch 8/500 - Train loss: 0.5170, Val loss: 0.4759, Learning rate: 0.001000
  Multiclass: Train acc: 0.7790, Val acc: 0.7685, Val F1: 0.7710
  Contralateral: Train acc: 0.8806, Val acc: 0.8831, Val F1: 0.7719
  Ipsilateral: Train acc: 0.8695, Val acc: 0.8831, Val F1: 0.7263
New best model saved (val_loss: 0.4759)
Epoch 9/500 - Train loss: 0.4473, Val loss: 0.4778, Learning rate: 0.001000
  Multiclass: Train acc: 0.8132, Val acc: 0.7798, Val F1: 0.7810
  Contralateral: Train acc: 0.8926, Val acc: 0.8809, Val F1: 0.7801
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 128.45it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 158.65it/s, loss=0.3737]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.10it/s]
Epoch 13 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.02it/s, loss=0.3435]
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.50it/s]
Epoch 14 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 128.45it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 10/500 - Train loss: 0.4249, Val loss: 0.5082, Learning rate: 0.001000
  Multiclass: Train acc: 0.8156, Val acc: 0.7573, Val F1: 0.7590
  Contralateral: Train acc: 0.9042, Val acc: 0.8719, Val F1: 0.7635
  Ipsilateral: Train acc: 0.9047, Val acc: 0.8787, Val F1: 0.6932
Epoch 11/500 - Train loss: 0.3899, Val loss: 0.4570, Learning rate: 0.001000
  Multiclass: Train acc: 0.8349, Val acc: 0.7865, Val F1: 0.7879
  Contralateral: Train acc: 0.9119, Val acc: 0.8742, Val F1: 0.7522
  Ipsilateral: Train acc: 0.9100, Val acc: 0.9034, Val F1: 0.7543
New best model saved (val_loss: 0.4570)
Epoch 12/500 - Train loss: 0.3737, Val loss: 0.4554, Learning rate: 0.001000
  Multiclass: Train acc: 0.8435, Val acc: 0.8247, Val F1: 0.8257
  Contralateral: Train acc: 0.9210, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9234, Val acc: 0.9191, Val F1: 0.7978
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.43it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 154.83it/s, loss=0.3336]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.32it/s]
Epoch 17 (Train):  65%|███████████▋      | 42/65 [00:00<00:00, 155.98it/s, loss=0.2524]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.43it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13/500 - Train loss: 0.3435, Val loss: 0.4068, Learning rate: 0.001000
  Multiclass: Train acc: 0.8532, Val acc: 0.8135, Val F1: 0.8149
  Contralateral: Train acc: 0.9177, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9244, Val acc: 0.9101, Val F1: 0.7895
New best model saved (val_loss: 0.4068)
Epoch 14/500 - Train loss: 0.3653, Val loss: 0.4728, Learning rate: 0.001000
  Multiclass: Train acc: 0.8671, Val acc: 0.8292, Val F1: 0.8285
  Contralateral: Train acc: 0.9191, Val acc: 0.9056, Val F1: 0.8037
  Ipsilateral: Train acc: 0.9403, Val acc: 0.9213, Val F1: 0.7826
Epoch 15/500 - Train loss: 0.3253, Val loss: 0.3535, Learning rate: 0.001000
  Multiclass: Train acc: 0.8729, Val acc: 0.8225, Val F1: 0.8226
  Contralateral: Train acc: 0.9287, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9336, Val acc: 0.9191, Val F1: 0.7857
New best model saved (val_loss: 0.3535)
Epoch 16/500 - Train loss: 0.3336, Val loss: 0.3867, Learning rate: 0.001000
  Multiclass: Train acc: 0.8792, Val acc: 0.8382, Val F1: 0.8387
  Contralateral: Train acc: 0.9321, Val acc: 0.9079, Val F1: 0.8145
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.24it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.18it/s, loss=0.2587]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.39it/s]
Epoch 21 (Train):   9%|█▊                  | 6/65 [00:00<00:00, 59.40it/s, loss=0.2440]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.24it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 17/500 - Train loss: 0.2713, Val loss: 0.4270, Learning rate: 0.001000
  Multiclass: Train acc: 0.8994, Val acc: 0.8247, Val F1: 0.8258
  Contralateral: Train acc: 0.9393, Val acc: 0.9011, Val F1: 0.8070
  Ipsilateral: Train acc: 0.9504, Val acc: 0.9191, Val F1: 0.8065
Epoch 18/500 - Train loss: 0.2579, Val loss: 0.4358, Learning rate: 0.001000
  Multiclass: Train acc: 0.9080, Val acc: 0.8315, Val F1: 0.8326
  Contralateral: Train acc: 0.9422, Val acc: 0.9169, Val F1: 0.8426
  Ipsilateral: Train acc: 0.9547, Val acc: 0.9101, Val F1: 0.7826
Epoch 19/500 - Train loss: 0.2947, Val loss: 0.3795, Learning rate: 0.001000
  Multiclass: Train acc: 0.8974, Val acc: 0.8315, Val F1: 0.8325
  Contralateral: Train acc: 0.9345, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.9543, Val acc: 0.9236, Val F1: 0.8132
Epoch 20/500 - Train loss: 0.2587, Val loss: 0.4142, Learning rate: 0.001000
  Multiclass: Train acc: 0.9095, Val acc: 0.8337, Val F1: 0.8340
  Contralateral: Train acc: 0.9393, Val acc: 0.9101, Val F1: 0.8305
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Epoch 1 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 156.13it/s, loss=1.3087]
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.59it/s]
Epoch 2 (Train):   9%|█▉                   | 6/65 [00:00<00:01, 57.92it/s, loss=1.2667]
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 00021: reducing learning rate of group 0 to 5.0000e-04.
Epoch 21/500 - Train loss: 0.2661, Val loss: 0.4197, Learning rate: 0.000500
  Multiclass: Train acc: 0.8984, Val acc: 0.8472, Val F1: 0.8476
  Contralateral: Train acc: 0.9413, Val acc: 0.9056, Val F1: 0.8125
  Ipsilateral: Train acc: 0.9519, Val acc: 0.9326, Val F1: 0.8235
Epoch 22/500 - Train loss: 0.1939, Val loss: 0.4316, Learning rate: 0.000500
  Multiclass: Train acc: 0.9273, Val acc: 0.8382, Val F1: 0.8388
  Contralateral: Train acc: 0.9576, Val acc: 0.9079, Val F1: 0.8194
  Ipsilateral: Train acc: 0.9615, Val acc: 0.9303, Val F1: 0.8166
Early stopping triggered after 22 epochs
Best model was at epoch 15
Training completed. Best validation loss: 0.3535
Evaluating on test set...
[2025-04-09 16:22:18,028][HYDRA] 	#3 : model=lstm model.hidden_size=32 model.num_layers=2 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 32
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 32, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 71175
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 158.57it/s, loss=1.1928]
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.15it/s]
Epoch 5 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 156.86it/s, loss=1.1767]
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 123.53it/s]
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 124.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1/500 - Train loss: 1.3087, Val loss: 1.2694, Learning rate: 0.000100
  Multiclass: Train acc: 0.3866, Val acc: 0.5371, Val F1: 0.4617
  Contralateral: Train acc: 0.4810, Val acc: 0.6787, Val F1: 0.2513
  Ipsilateral: Train acc: 0.6230, Val acc: 0.8022, Val F1: 0.1020
New best model saved (val_loss: 1.2694)
Epoch 2/500 - Train loss: 1.2618, Val loss: 1.2273, Learning rate: 0.000100
  Multiclass: Train acc: 0.4641, Val acc: 0.5618, Val F1: 0.4485
  Contralateral: Train acc: 0.5503, Val acc: 0.7483, Val F1: 0.1765
  Ipsilateral: Train acc: 0.7039, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.2273)
Epoch 3/500 - Train loss: 1.2307, Val loss: 1.1934, Learning rate: 0.000100
  Multiclass: Train acc: 0.5113, Val acc: 0.5685, Val F1: 0.4221
  Contralateral: Train acc: 0.6062, Val acc: 0.7573, Val F1: 0.0357
  Ipsilateral: Train acc: 0.7573, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1934)
Epoch 4/500 - Train loss: 1.1928, Val loss: 1.1633, Learning rate: 0.000100
  Multiclass: Train acc: 0.5311, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.6562, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7780, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.73it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.73it/s, loss=1.1374]
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 126.77it/s]
Epoch 9 (Train): 100%|███████████████████| 65/65 [00:00<00:00, 159.36it/s, loss=1.1315]
Epoch 9 (Val):   0%|                                            | 0/14 [00:00<?, ?it/s]
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 125.73it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5/500 - Train loss: 1.1767, Val loss: 1.1410, Learning rate: 0.000100
  Multiclass: Train acc: 0.5296, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.6663, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7978, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1410)
Epoch 6/500 - Train loss: 1.1648, Val loss: 1.1228, Learning rate: 0.000100
  Multiclass: Train acc: 0.5518, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6851, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8103, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1228)
Epoch 7/500 - Train loss: 1.1477, Val loss: 1.1119, Learning rate: 0.000100
  Multiclass: Train acc: 0.5575, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6875, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8069, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1119)
Epoch 8/500 - Train loss: 1.1374, Val loss: 1.0994, Learning rate: 0.000100
  Multiclass: Train acc: 0.5595, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6996, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8122, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.54it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 12 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.25it/s, loss=1.0884]
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.06it/s]
Epoch 13 (Train):  72%|█████████████     | 47/65 [00:00<00:00, 167.74it/s, loss=1.0837]
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.54it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9/500 - Train loss: 1.1315, Val loss: 1.0879, Learning rate: 0.000100
  Multiclass: Train acc: 0.5571, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7010, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8175, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0879)
Epoch 10/500 - Train loss: 1.1148, Val loss: 1.0779, Learning rate: 0.000100
  Multiclass: Train acc: 0.5691, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.7058, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8161, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0779)
Epoch 11/500 - Train loss: 1.1019, Val loss: 1.0683, Learning rate: 0.000100
  Multiclass: Train acc: 0.5619, Val acc: 0.5708, Val F1: 0.4195
  Contralateral: Train acc: 0.7232, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0683)
Epoch 12/500 - Train loss: 1.0884, Val loss: 1.0560, Learning rate: 0.000100
  Multiclass: Train acc: 0.5734, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.7193, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8180, Val acc: 0.8112, Val F1: 0.0000
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.64it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 16 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 157.54it/s, loss=1.0347]
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 116.19it/s]
Epoch 17 (Train):  40%|███████▏          | 26/65 [00:00<00:00, 138.95it/s, loss=1.0495]
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.64it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13/500 - Train loss: 1.0786, Val loss: 1.0473, Learning rate: 0.000100
  Multiclass: Train acc: 0.5739, Val acc: 0.5730, Val F1: 0.4244
  Contralateral: Train acc: 0.7275, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0473)
Epoch 14/500 - Train loss: 1.0795, Val loss: 1.0331, Learning rate: 0.000100
  Multiclass: Train acc: 0.5782, Val acc: 0.5798, Val F1: 0.4386
  Contralateral: Train acc: 0.7130, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0331)
Epoch 15/500 - Train loss: 1.0560, Val loss: 1.0195, Learning rate: 0.000100
  Multiclass: Train acc: 0.5831, Val acc: 0.5798, Val F1: 0.4419
  Contralateral: Train acc: 0.7362, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.69it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20 (Train): 100%|██████████████████| 65/65 [00:00<00:00, 159.95it/s, loss=0.9646]
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.82it/s]
Epoch 21 (Train):   9%|█▊                  | 6/65 [00:00<00:01, 58.21it/s, loss=0.9579]
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.69it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 16/500 - Train loss: 1.0347, Val loss: 1.0086, Learning rate: 0.000100
  Multiclass: Train acc: 0.5936, Val acc: 0.5843, Val F1: 0.4508
  Contralateral: Train acc: 0.7260, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0086)
Epoch 17/500 - Train loss: 1.0320, Val loss: 0.9890, Learning rate: 0.000100
  Multiclass: Train acc: 0.5845, Val acc: 0.6000, Val F1: 0.4873
  Contralateral: Train acc: 0.7448, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9890)
Epoch 18/500 - Train loss: 1.0003, Val loss: 0.9702, Learning rate: 0.000100
  Multiclass: Train acc: 0.5989, Val acc: 0.6112, Val F1: 0.5057
  Contralateral: Train acc: 0.7429, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9702)
Epoch 19/500 - Train loss: 0.9970, Val loss: 0.9493, Learning rate: 0.000100
  Multiclass: Train acc: 0.6042, Val acc: 0.6180, Val F1: 0.5195
  Contralateral: Train acc: 0.7520, Val acc: 0.7640, Val F1: 0.0870
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.22it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 24 (Train):   0%|                                         | 0/65 [00:00<?, ?it/s]
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.22it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20/500 - Train loss: 0.9646, Val loss: 0.9334, Learning rate: 0.000100
  Multiclass: Train acc: 0.6148, Val acc: 0.6292, Val F1: 0.5419
  Contralateral: Train acc: 0.7496, Val acc: 0.7708, Val F1: 0.1500
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9334)
Epoch 21/500 - Train loss: 0.9365, Val loss: 0.9077, Learning rate: 0.000100
  Multiclass: Train acc: 0.6196, Val acc: 0.6315, Val F1: 0.5479
  Contralateral: Train acc: 0.7703, Val acc: 0.8045, Val F1: 0.3650
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9077)
Epoch 22/500 - Train loss: 0.9237, Val loss: 0.8878, Learning rate: 0.000100
  Multiclass: Train acc: 0.6341, Val acc: 0.6494, Val F1: 0.5731
  Contralateral: Train acc: 0.7795, Val acc: 0.8090, Val F1: 0.4371
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8878)
Epoch 23/500 - Train loss: 0.9010, Val loss: 0.8670, Learning rate: 0.000100
  Multiclass: Train acc: 0.6259, Val acc: 0.6562, Val F1: 0.5806
  Contralateral: Train acc: 0.7857, Val acc: 0.8337, Val F1: 0.5542
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
Epoch 27 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 24/500 - Train loss: 0.8753, Val loss: 0.8452, Learning rate: 0.000100
  Multiclass: Train acc: 0.6432, Val acc: 0.6539, Val F1: 0.5806
  Contralateral: Train acc: 0.7838, Val acc: 0.8292, Val F1: 0.5824
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8452)
Epoch 25/500 - Train loss: 0.8548, Val loss: 0.8277, Learning rate: 0.000100
  Multiclass: Train acc: 0.6495, Val acc: 0.6562, Val F1: 0.5811
  Contralateral: Train acc: 0.7901, Val acc: 0.8404, Val F1: 0.6034
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8277)
Epoch 26/500 - Train loss: 0.8377, Val loss: 0.8008, Learning rate: 0.000100
  Multiclass: Train acc: 0.6461, Val acc: 0.6562, Val F1: 0.5831
  Contralateral: Train acc: 0.7968, Val acc: 0.8539, Val F1: 0.6667
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.59it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.59it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27/500 - Train loss: 0.8177, Val loss: 0.7809, Learning rate: 0.000100
  Multiclass: Train acc: 0.6644, Val acc: 0.6584, Val F1: 0.5868
  Contralateral: Train acc: 0.8060, Val acc: 0.8562, Val F1: 0.6800
  Ipsilateral: Train acc: 0.8209, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7809)
Epoch 28/500 - Train loss: 0.7908, Val loss: 0.7607, Learning rate: 0.000100
  Multiclass: Train acc: 0.6644, Val acc: 0.6629, Val F1: 0.5908
  Contralateral: Train acc: 0.8166, Val acc: 0.8562, Val F1: 0.6800
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7607)
Epoch 29/500 - Train loss: 0.7651, Val loss: 0.7417, Learning rate: 0.000100
  Multiclass: Train acc: 0.6745, Val acc: 0.6652, Val F1: 0.5937
  Contralateral: Train acc: 0.8214, Val acc: 0.8494, Val F1: 0.6825
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7417)
Epoch 30/500 - Train loss: 0.7574, Val loss: 0.7268, Learning rate: 0.000100
  Multiclass: Train acc: 0.6784, Val acc: 0.6742, Val F1: 0.6015
  Contralateral: Train acc: 0.8257, Val acc: 0.8607, Val F1: 0.7019
  Ipsilateral: Train acc: 0.8228, Val acc: 0.8112, Val F1: 0.0000
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.03it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.03it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 31/500 - Train loss: 0.7444, Val loss: 0.7063, Learning rate: 0.000100
  Multiclass: Train acc: 0.6760, Val acc: 0.6674, Val F1: 0.5960
  Contralateral: Train acc: 0.8190, Val acc: 0.8584, Val F1: 0.7042
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7063)
Epoch 32/500 - Train loss: 0.7149, Val loss: 0.6961, Learning rate: 0.000100
  Multiclass: Train acc: 0.6981, Val acc: 0.6697, Val F1: 0.5982
  Contralateral: Train acc: 0.8392, Val acc: 0.8607, Val F1: 0.7156
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6961)
Epoch 33/500 - Train loss: 0.7126, Val loss: 0.6841, Learning rate: 0.000100
  Multiclass: Train acc: 0.6890, Val acc: 0.6719, Val F1: 0.6004
  Contralateral: Train acc: 0.8402, Val acc: 0.8607, Val F1: 0.7182
  Ipsilateral: Train acc: 0.8262, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6841)
Epoch 34/500 - Train loss: 0.7009, Val loss: 0.6675, Learning rate: 0.000100
  Multiclass: Train acc: 0.6938, Val acc: 0.6787, Val F1: 0.6069
  Contralateral: Train acc: 0.8377, Val acc: 0.8652, Val F1: 0.7273
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8112, Val F1: 0.0000
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.04it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.04it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35/500 - Train loss: 0.6869, Val loss: 0.6455, Learning rate: 0.000100
  Multiclass: Train acc: 0.6943, Val acc: 0.6809, Val F1: 0.6087
  Contralateral: Train acc: 0.8435, Val acc: 0.8652, Val F1: 0.7248
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6455)
Epoch 36/500 - Train loss: 0.6496, Val loss: 0.6316, Learning rate: 0.000100
  Multiclass: Train acc: 0.7034, Val acc: 0.6831, Val F1: 0.6113
  Contralateral: Train acc: 0.8536, Val acc: 0.8719, Val F1: 0.7397
  Ipsilateral: Train acc: 0.8247, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6316)
Epoch 37/500 - Train loss: 0.6395, Val loss: 0.6128, Learning rate: 0.000100
  Multiclass: Train acc: 0.7174, Val acc: 0.6809, Val F1: 0.6094
  Contralateral: Train acc: 0.8599, Val acc: 0.8674, Val F1: 0.7378
  Ipsilateral: Train acc: 0.8281, Val acc: 0.8112, Val F1: 0.0000
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.65it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.65it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 38/500 - Train loss: 0.6408, Val loss: 0.5981, Learning rate: 0.000100
  Multiclass: Train acc: 0.7121, Val acc: 0.6787, Val F1: 0.6076
  Contralateral: Train acc: 0.8450, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5981)
Epoch 39/500 - Train loss: 0.5987, Val loss: 0.5772, Learning rate: 0.000100
  Multiclass: Train acc: 0.7333, Val acc: 0.6921, Val F1: 0.6323
  Contralateral: Train acc: 0.8739, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8339, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5772)
Epoch 40/500 - Train loss: 0.6132, Val loss: 0.5660, Learning rate: 0.000100
  Multiclass: Train acc: 0.7092, Val acc: 0.6899, Val F1: 0.6412
  Contralateral: Train acc: 0.8666, Val acc: 0.8697, Val F1: 0.7411
  Ipsilateral: Train acc: 0.8368, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5660)
Epoch 41/500 - Train loss: 0.5739, Val loss: 0.5551, Learning rate: 0.000100
  Multiclass: Train acc: 0.7227, Val acc: 0.7146, Val F1: 0.6870
  Contralateral: Train acc: 0.8719, Val acc: 0.8764, Val F1: 0.7598
  Ipsilateral: Train acc: 0.8329, Val acc: 0.8112, Val F1: 0.0000
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.29it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.29it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 42/500 - Train loss: 0.5822, Val loss: 0.5395, Learning rate: 0.000100
  Multiclass: Train acc: 0.7285, Val acc: 0.7236, Val F1: 0.7061
  Contralateral: Train acc: 0.8652, Val acc: 0.8742, Val F1: 0.7477
  Ipsilateral: Train acc: 0.8329, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5395)
Epoch 43/500 - Train loss: 0.5715, Val loss: 0.5243, Learning rate: 0.000100
  Multiclass: Train acc: 0.7352, Val acc: 0.7461, Val F1: 0.7372
  Contralateral: Train acc: 0.8734, Val acc: 0.8809, Val F1: 0.7644
  Ipsilateral: Train acc: 0.8382, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5243)
Epoch 44/500 - Train loss: 0.5599, Val loss: 0.5156, Learning rate: 0.000100
  Multiclass: Train acc: 0.7520, Val acc: 0.7393, Val F1: 0.7292
  Contralateral: Train acc: 0.8816, Val acc: 0.8742, Val F1: 0.7522
  Ipsilateral: Train acc: 0.8459, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5156)
Epoch 45/500 - Train loss: 0.5369, Val loss: 0.5049, Learning rate: 0.000100
  Multiclass: Train acc: 0.7559, Val acc: 0.7528, Val F1: 0.7476
  Contralateral: Train acc: 0.8796, Val acc: 0.8809, Val F1: 0.7644
  Ipsilateral: Train acc: 0.8551, Val acc: 0.8135, Val F1: 0.0235
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.93it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.93it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 46/500 - Train loss: 0.5191, Val loss: 0.4965, Learning rate: 0.000100
  Multiclass: Train acc: 0.7583, Val acc: 0.7596, Val F1: 0.7562
  Contralateral: Train acc: 0.8854, Val acc: 0.8831, Val F1: 0.7699
  Ipsilateral: Train acc: 0.8464, Val acc: 0.8337, Val F1: 0.2600
New best model saved (val_loss: 0.4965)
Epoch 47/500 - Train loss: 0.5191, Val loss: 0.4850, Learning rate: 0.000100
  Multiclass: Train acc: 0.7545, Val acc: 0.7730, Val F1: 0.7715
  Contralateral: Train acc: 0.8902, Val acc: 0.8831, Val F1: 0.7797
  Ipsilateral: Train acc: 0.8426, Val acc: 0.8472, Val F1: 0.3929
New best model saved (val_loss: 0.4850)
Epoch 48/500 - Train loss: 0.5019, Val loss: 0.4688, Learning rate: 0.000100
  Multiclass: Train acc: 0.7727, Val acc: 0.7775, Val F1: 0.7760
  Contralateral: Train acc: 0.8801, Val acc: 0.8899, Val F1: 0.7860
  Ipsilateral: Train acc: 0.8474, Val acc: 0.8674, Val F1: 0.5354
New best model saved (val_loss: 0.4688)
Epoch 49/500 - Train loss: 0.4931, Val loss: 0.4660, Learning rate: 0.000100
  Multiclass: Train acc: 0.7761, Val acc: 0.7708, Val F1: 0.7712
  Contralateral: Train acc: 0.8873, Val acc: 0.8787, Val F1: 0.7652
  Ipsilateral: Train acc: 0.8536, Val acc: 0.8809, Val F1: 0.6395
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.52it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.52it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 50/500 - Train loss: 0.4878, Val loss: 0.4619, Learning rate: 0.000100
  Multiclass: Train acc: 0.7670, Val acc: 0.7820, Val F1: 0.7816
  Contralateral: Train acc: 0.8897, Val acc: 0.8854, Val F1: 0.7866
  Ipsilateral: Train acc: 0.8464, Val acc: 0.8787, Val F1: 0.6250
New best model saved (val_loss: 0.4619)
Epoch 51/500 - Train loss: 0.4689, Val loss: 0.4514, Learning rate: 0.000100
  Multiclass: Train acc: 0.7877, Val acc: 0.7933, Val F1: 0.7927
  Contralateral: Train acc: 0.8999, Val acc: 0.8921, Val F1: 0.7966
  Ipsilateral: Train acc: 0.8527, Val acc: 0.8809, Val F1: 0.6395
New best model saved (val_loss: 0.4514)
Epoch 52/500 - Train loss: 0.4717, Val loss: 0.4413, Learning rate: 0.000100
  Multiclass: Train acc: 0.7776, Val acc: 0.7843, Val F1: 0.7834
  Contralateral: Train acc: 0.8970, Val acc: 0.8831, Val F1: 0.7719
  Ipsilateral: Train acc: 0.8575, Val acc: 0.8899, Val F1: 0.6711
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.01it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 122.01it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 53/500 - Train loss: 0.4582, Val loss: 0.4489, Learning rate: 0.000100
  Multiclass: Train acc: 0.7949, Val acc: 0.7955, Val F1: 0.7963
  Contralateral: Train acc: 0.9056, Val acc: 0.8809, Val F1: 0.7745
  Ipsilateral: Train acc: 0.8681, Val acc: 0.9079, Val F1: 0.7389
Epoch 54/500 - Train loss: 0.4612, Val loss: 0.4395, Learning rate: 0.000100
  Multiclass: Train acc: 0.7983, Val acc: 0.7955, Val F1: 0.7961
  Contralateral: Train acc: 0.9027, Val acc: 0.8854, Val F1: 0.7733
  Ipsilateral: Train acc: 0.8609, Val acc: 0.9101, Val F1: 0.7468
New best model saved (val_loss: 0.4395)
Epoch 55/500 - Train loss: 0.4366, Val loss: 0.4301, Learning rate: 0.000100
  Multiclass: Train acc: 0.7983, Val acc: 0.8022, Val F1: 0.8035
  Contralateral: Train acc: 0.9114, Val acc: 0.8876, Val F1: 0.7826
  Ipsilateral: Train acc: 0.8714, Val acc: 0.8966, Val F1: 0.7229
New best model saved (val_loss: 0.4301)
Epoch 56/500 - Train loss: 0.4395, Val loss: 0.4166, Learning rate: 0.000100
  Multiclass: Train acc: 0.8007, Val acc: 0.7888, Val F1: 0.7900
  Contralateral: Train acc: 0.8999, Val acc: 0.8876, Val F1: 0.7788
  Ipsilateral: Train acc: 0.8724, Val acc: 0.9011, Val F1: 0.7349
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 57/500 - Train loss: 0.4318, Val loss: 0.4079, Learning rate: 0.000100
  Multiclass: Train acc: 0.8108, Val acc: 0.8045, Val F1: 0.8050
  Contralateral: Train acc: 0.9109, Val acc: 0.8989, Val F1: 0.7926
  Ipsilateral: Train acc: 0.8806, Val acc: 0.9079, Val F1: 0.7630
New best model saved (val_loss: 0.4079)
Epoch 58/500 - Train loss: 0.4381, Val loss: 0.4025, Learning rate: 0.000100
  Multiclass: Train acc: 0.8036, Val acc: 0.8090, Val F1: 0.8095
  Contralateral: Train acc: 0.9008, Val acc: 0.8989, Val F1: 0.7982
  Ipsilateral: Train acc: 0.8763, Val acc: 0.9079, Val F1: 0.7574
New best model saved (val_loss: 0.4025)
Epoch 59/500 - Train loss: 0.4147, Val loss: 0.3947, Learning rate: 0.000100
  Multiclass: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.8118
  Contralateral: Train acc: 0.9090, Val acc: 0.8966, Val F1: 0.7965
  Ipsilateral: Train acc: 0.8888, Val acc: 0.9079, Val F1: 0.7574
New best model saved (val_loss: 0.3947)
Epoch 60/500 - Train loss: 0.4110, Val loss: 0.3878, Learning rate: 0.000100
  Multiclass: Train acc: 0.8344, Val acc: 0.8022, Val F1: 0.8026
  Contralateral: Train acc: 0.9148, Val acc: 0.8989, Val F1: 0.7982
  Ipsilateral: Train acc: 0.8864, Val acc: 0.9101, Val F1: 0.7647
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 61/500 - Train loss: 0.3961, Val loss: 0.3774, Learning rate: 0.000100
  Multiclass: Train acc: 0.8291, Val acc: 0.8135, Val F1: 0.8143
  Contralateral: Train acc: 0.9186, Val acc: 0.9011, Val F1: 0.8018
  Ipsilateral: Train acc: 0.8844, Val acc: 0.9169, Val F1: 0.7886
New best model saved (val_loss: 0.3774)
Epoch 62/500 - Train loss: 0.4257, Val loss: 0.3767, Learning rate: 0.000100
  Multiclass: Train acc: 0.8170, Val acc: 0.8112, Val F1: 0.8117
  Contralateral: Train acc: 0.9052, Val acc: 0.8989, Val F1: 0.8000
  Ipsilateral: Train acc: 0.8849, Val acc: 0.9146, Val F1: 0.7765
New best model saved (val_loss: 0.3767)
Epoch 63/500 - Train loss: 0.3836, Val loss: 0.3764, Learning rate: 0.000100
  Multiclass: Train acc: 0.8344, Val acc: 0.8337, Val F1: 0.8346
  Contralateral: Train acc: 0.9182, Val acc: 0.9079, Val F1: 0.8210
  Ipsilateral: Train acc: 0.8955, Val acc: 0.9236, Val F1: 0.8046
Epoch 67 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.66it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 67 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 123.66it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 64/500 - Train loss: 0.3796, Val loss: 0.3764, Learning rate: 0.000100
  Multiclass: Train acc: 0.8349, Val acc: 0.8112, Val F1: 0.8121
  Contralateral: Train acc: 0.9104, Val acc: 0.8966, Val F1: 0.8034
  Ipsilateral: Train acc: 0.9018, Val acc: 0.9169, Val F1: 0.7836
Epoch 65/500 - Train loss: 0.3798, Val loss: 0.3740, Learning rate: 0.000100
  Multiclass: Train acc: 0.8344, Val acc: 0.8045, Val F1: 0.8054
  Contralateral: Train acc: 0.9201, Val acc: 0.9034, Val F1: 0.8054
  Ipsilateral: Train acc: 0.8926, Val acc: 0.9034, Val F1: 0.7543
New best model saved (val_loss: 0.3740)
Epoch 66/500 - Train loss: 0.4044, Val loss: 0.3625, Learning rate: 0.000100
  Multiclass: Train acc: 0.8267, Val acc: 0.8067, Val F1: 0.8073
  Contralateral: Train acc: 0.9047, Val acc: 0.9079, Val F1: 0.8178
  Ipsilateral: Train acc: 0.8970, Val acc: 0.9056, Val F1: 0.7558
New best model saved (val_loss: 0.3625)
Epoch 67/500 - Train loss: 0.3701, Val loss: 0.3622, Learning rate: 0.000100
  Multiclass: Train acc: 0.8368, Val acc: 0.8157, Val F1: 0.8164
  Contralateral: Train acc: 0.9133, Val acc: 0.9079, Val F1: 0.8145
  Ipsilateral: Train acc: 0.9143, Val acc: 0.9124, Val F1: 0.7797
Epoch 71 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.57it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 71 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 126.57it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 68/500 - Train loss: 0.3633, Val loss: 0.3637, Learning rate: 0.000100
  Multiclass: Train acc: 0.8435, Val acc: 0.8180, Val F1: 0.8187
  Contralateral: Train acc: 0.9283, Val acc: 0.9079, Val F1: 0.8161
  Ipsilateral: Train acc: 0.9100, Val acc: 0.9101, Val F1: 0.7727
Epoch 69/500 - Train loss: 0.3691, Val loss: 0.3698, Learning rate: 0.000100
  Multiclass: Train acc: 0.8464, Val acc: 0.8180, Val F1: 0.8192
  Contralateral: Train acc: 0.9254, Val acc: 0.9011, Val F1: 0.8018
  Ipsilateral: Train acc: 0.9018, Val acc: 0.9101, Val F1: 0.7826
Epoch 70/500 - Train loss: 0.3494, Val loss: 0.3570, Learning rate: 0.000100
  Multiclass: Train acc: 0.8594, Val acc: 0.8090, Val F1: 0.8099
  Contralateral: Train acc: 0.9268, Val acc: 0.9011, Val F1: 0.8018
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9079, Val F1: 0.7709
New best model saved (val_loss: 0.3570)
Epoch 71/500 - Train loss: 0.3516, Val loss: 0.3584, Learning rate: 0.000100
  Multiclass: Train acc: 0.8575, Val acc: 0.8112, Val F1: 0.8122
  Contralateral: Train acc: 0.9287, Val acc: 0.8989, Val F1: 0.8069
Epoch 75 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 75 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 124.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 72/500 - Train loss: 0.3515, Val loss: 0.3479, Learning rate: 0.000100
  Multiclass: Train acc: 0.8536, Val acc: 0.8045, Val F1: 0.8054
  Contralateral: Train acc: 0.9215, Val acc: 0.8989, Val F1: 0.8000
  Ipsilateral: Train acc: 0.9124, Val acc: 0.9079, Val F1: 0.7684
New best model saved (val_loss: 0.3479)
Epoch 73/500 - Train loss: 0.3828, Val loss: 0.3442, Learning rate: 0.000100
  Multiclass: Train acc: 0.8517, Val acc: 0.8135, Val F1: 0.8144
  Contralateral: Train acc: 0.9167, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.8965, Val acc: 0.9124, Val F1: 0.7869
New best model saved (val_loss: 0.3442)
Epoch 74/500 - Train loss: 0.3451, Val loss: 0.3397, Learning rate: 0.000100
  Multiclass: Train acc: 0.8551, Val acc: 0.8247, Val F1: 0.8255
  Contralateral: Train acc: 0.9220, Val acc: 0.9079, Val F1: 0.8225
  Ipsilateral: Train acc: 0.9172, Val acc: 0.9191, Val F1: 0.7978
New best model saved (val_loss: 0.3397)
Epoch 75/500 - Train loss: 0.3438, Val loss: 0.3489, Learning rate: 0.000100
  Multiclass: Train acc: 0.8551, Val acc: 0.8247, Val F1: 0.8253
  Contralateral: Train acc: 0.9201, Val acc: 0.9056, Val F1: 0.8091
Epoch 79 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 79 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 76/500 - Train loss: 0.3356, Val loss: 0.3441, Learning rate: 0.000100
  Multiclass: Train acc: 0.8666, Val acc: 0.8292, Val F1: 0.8299
  Contralateral: Train acc: 0.9254, Val acc: 0.9079, Val F1: 0.8225
  Ipsilateral: Train acc: 0.9172, Val acc: 0.9191, Val F1: 0.7931
Epoch 77/500 - Train loss: 0.3253, Val loss: 0.3449, Learning rate: 0.000100
  Multiclass: Train acc: 0.8710, Val acc: 0.8337, Val F1: 0.8344
  Contralateral: Train acc: 0.9292, Val acc: 0.9146, Val F1: 0.8333
  Ipsilateral: Train acc: 0.9210, Val acc: 0.9236, Val F1: 0.8090
Epoch 78/500 - Train loss: 0.3258, Val loss: 0.3517, Learning rate: 0.000100
  Multiclass: Train acc: 0.8719, Val acc: 0.8360, Val F1: 0.8362
  Contralateral: Train acc: 0.9316, Val acc: 0.9146, Val F1: 0.8348
  ret = run_job(100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
  ret = run_job(100%|█████████████████████████████████| 14/14 [00:00<00:00, 125.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 79/500 - Train loss: 0.3208, Val loss: 0.3573, Learning rate: 0.000100
  Multiclass: Train acc: 0.8681, Val acc: 0.8225, Val F1: 0.8234
  Contralateral: Train acc: 0.9312, Val acc: 0.9056, Val F1: 0.8220
  Ipsilateral: Train acc: 0.9307, Val acc: 0.9191, Val F1: 0.8022
Epoch 00080: reducing learning rate of group 0 to 5.0000e-05.
Epoch 80/500 - Train loss: 0.3324, Val loss: 0.3401, Learning rate: 0.000050
  Multiclass: Train acc: 0.8589, Val acc: 0.8337, Val F1: 0.8345
  Contralateral: Train acc: 0.9234, Val acc: 0.9079, Val F1: 0.8225
  Ipsilateral: Train acc: 0.9230, Val acc: 0.9236, Val F1: 0.8132
Epoch 81/500 - Train loss: 0.3187, Val loss: 0.3437, Learning rate: 0.000050
  Multiclass: Train acc: 0.8714, Val acc: 0.8337, Val F1: 0.8343
  Contralateral: Train acc: 0.9331, Val acc: 0.9079, Val F1: 0.8240
  Ipsilateral: Train acc: 0.9225, Val acc: 0.9258, Val F1: 0.8114
Early stopping triggered after 81 epochs
Best model was at epoch 74
Training completed. Best validation loss: 0.3397
Evaluating on test set...
[2025-04-09 16:23:02,189][HYDRA] 	#4 : model=lstm model.hidden_size=64 model.num_layers=1 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 64
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 64, batch_first=True)
  (batch_norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=64, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 131271
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1/500 - Train loss: 1.1977, Val loss: 1.0817, Learning rate: 0.001000
  Multiclass: Train acc: 0.5272, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6341, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7468, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0817)
Epoch 2/500 - Train loss: 1.0593, Val loss: 0.9790, Learning rate: 0.001000
  Multiclass: Train acc: 0.5672, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8199, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9790)
Epoch 3/500 - Train loss: 0.9156, Val loss: 0.7802, Learning rate: 0.001000
  Multiclass: Train acc: 0.5927, Val acc: 0.6719, Val F1: 0.6263
  Contralateral: Train acc: 0.7487, Val acc: 0.7933, Val F1: 0.2923
  Ipsilateral: Train acc: 0.8252, Val acc: 0.8157, Val F1: 0.0465
New best model saved (val_loss: 0.7802)
Epoch 4/500 - Train loss: 0.7126, Val loss: 0.5786, Learning rate: 0.001000
  Multiclass: Train acc: 0.6769, Val acc: 0.7551, Val F1: 0.7551
  Contralateral: Train acc: 0.7853, Val acc: 0.8539, Val F1: 0.6597
  Ipsilateral: Train acc: 0.8541, Val acc: 0.8809, Val F1: 0.6536
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 120.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5/500 - Train loss: 0.5589, Val loss: 0.5072, Learning rate: 0.001000
  Multiclass: Train acc: 0.7535, Val acc: 0.7753, Val F1: 0.7761
  Contralateral: Train acc: 0.8315, Val acc: 0.8584, Val F1: 0.7175
  Ipsilateral: Train acc: 0.8897, Val acc: 0.9011, Val F1: 0.7381
New best model saved (val_loss: 0.5072)
Epoch 6/500 - Train loss: 0.4671, Val loss: 0.4152, Learning rate: 0.001000
  Multiclass: Train acc: 0.8031, Val acc: 0.8000, Val F1: 0.8017
  Contralateral: Train acc: 0.8714, Val acc: 0.8742, Val F1: 0.7724
  Ipsilateral: Train acc: 0.9104, Val acc: 0.9101, Val F1: 0.7674
New best model saved (val_loss: 0.4152)
Epoch 7/500 - Train loss: 0.4002, Val loss: 0.3702, Learning rate: 0.001000
  Multiclass: Train acc: 0.8344, Val acc: 0.8292, Val F1: 0.8298
  Contralateral: Train acc: 0.9003, Val acc: 0.9056, Val F1: 0.8108
  Ipsilateral: Train acc: 0.9196, Val acc: 0.9236, Val F1: 0.8023
New best model saved (val_loss: 0.3702)
Epoch 8/500 - Train loss: 0.3493, Val loss: 0.4021, Learning rate: 0.001000
  Multiclass: Train acc: 0.8609, Val acc: 0.8292, Val F1: 0.8299
  Contralateral: Train acc: 0.9071, Val acc: 0.9011, Val F1: 0.8197
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.71it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.71it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9/500 - Train loss: 0.3025, Val loss: 0.4077, Learning rate: 0.001000
  Multiclass: Train acc: 0.8835, Val acc: 0.8494, Val F1: 0.8501
  Contralateral: Train acc: 0.9292, Val acc: 0.9101, Val F1: 0.8230
  Ipsilateral: Train acc: 0.9485, Val acc: 0.9348, Val F1: 0.8304
Epoch 10/500 - Train loss: 0.2720, Val loss: 0.4070, Learning rate: 0.001000
  Multiclass: Train acc: 0.8984, Val acc: 0.8494, Val F1: 0.8502
  Contralateral: Train acc: 0.9340, Val acc: 0.9079, Val F1: 0.8210
  Ipsilateral: Train acc: 0.9528, Val acc: 0.9303, Val F1: 0.8208
Epoch 11/500 - Train loss: 0.2706, Val loss: 0.4266, Learning rate: 0.001000
  Multiclass: Train acc: 0.9095, Val acc: 0.8562, Val F1: 0.8558
  Contralateral: Train acc: 0.9417, Val acc: 0.9191, Val F1: 0.8378
  Ipsilateral: Train acc: 0.9552, Val acc: 0.9326, Val F1: 0.8101
Epoch 12/500 - Train loss: 0.2336, Val loss: 0.5020, Learning rate: 0.001000
  Multiclass: Train acc: 0.9133, Val acc: 0.8382, Val F1: 0.8380
  Contralateral: Train acc: 0.9437, Val acc: 0.9146, Val F1: 0.8390
  ret = run_job(100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.71it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
  ret = run_job(100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.71it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 00013: reducing learning rate of group 0 to 5.0000e-04.
Epoch 13/500 - Train loss: 0.2157, Val loss: 0.4995, Learning rate: 0.000500
  Multiclass: Train acc: 0.9244, Val acc: 0.8404, Val F1: 0.8409
  Contralateral: Train acc: 0.9528, Val acc: 0.9034, Val F1: 0.8089
  Ipsilateral: Train acc: 0.9673, Val acc: 0.9303, Val F1: 0.8187
Epoch 14/500 - Train loss: 0.1717, Val loss: 0.5357, Learning rate: 0.000500
  Multiclass: Train acc: 0.9316, Val acc: 0.8517, Val F1: 0.8518
  Contralateral: Train acc: 0.9567, Val acc: 0.9124, Val F1: 0.8186
  Ipsilateral: Train acc: 0.9745, Val acc: 0.9326, Val F1: 0.8256
Early stopping triggered after 14 epochs
Best model was at epoch 7
Training completed. Best validation loss: 0.3702
Evaluating on test set...
[2025-04-09 16:23:10,073][HYDRA] 	#5 : model=lstm model.hidden_size=64 model.num_layers=1 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 64
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 64, batch_first=True)
  (batch_norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=64, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 131271
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.3240, Val loss: 1.2590, Learning rate: 0.000100
  Multiclass: Train acc: 0.4155, Val acc: 0.5528, Val F1: 0.4340
  Contralateral: Train acc: 0.4521, Val acc: 0.4427, Val F1: 0.3333
  Ipsilateral: Train acc: 0.5874, Val acc: 0.7820, Val F1: 0.0935
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 117.88it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 117.88it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 2/500 - Train loss: 1.2629, Val loss: 1.2125, Learning rate: 0.000100
  Multiclass: Train acc: 0.4925, Val acc: 0.5618, Val F1: 0.4118
  Contralateral: Train acc: 0.5152, Val acc: 0.6607, Val F1: 0.2176
  Ipsilateral: Train acc: 0.6991, Val acc: 0.8090, Val F1: 0.0000
New best model saved (val_loss: 1.2125)
Epoch 3/500 - Train loss: 1.2212, Val loss: 1.1765, Learning rate: 0.000100
  Multiclass: Train acc: 0.5291, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.5811, Val acc: 0.7124, Val F1: 0.1351
  Ipsilateral: Train acc: 0.7434, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1765)
Epoch 4/500 - Train loss: 1.1896, Val loss: 1.1480, Learning rate: 0.000100
  Multiclass: Train acc: 0.5460, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6312, Val acc: 0.7438, Val F1: 0.0806
  Ipsilateral: Train acc: 0.7785, Val acc: 0.8112, Val F1: 0.0000
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.90it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.90it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5/500 - Train loss: 1.1541, Val loss: 1.1232, Learning rate: 0.000100
  Multiclass: Train acc: 0.5527, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6630, Val acc: 0.7528, Val F1: 0.0179
  Ipsilateral: Train acc: 0.7906, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1232)
Epoch 6/500 - Train loss: 1.1368, Val loss: 1.1040, Learning rate: 0.000100
  Multiclass: Train acc: 0.5518, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6837, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.7968, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1040)
Epoch 7/500 - Train loss: 1.1140, Val loss: 1.0882, Learning rate: 0.000100
  Multiclass: Train acc: 0.5633, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6991, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8040, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0882)
Epoch 8/500 - Train loss: 1.1025, Val loss: 1.0750, Learning rate: 0.000100
  Multiclass: Train acc: 0.5667, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7222, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8108, Val acc: 0.8112, Val F1: 0.0000
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9/500 - Train loss: 1.0804, Val loss: 1.0607, Learning rate: 0.000100
  Multiclass: Train acc: 0.5676, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7256, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8093, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0607)
Epoch 10/500 - Train loss: 1.0704, Val loss: 1.0501, Learning rate: 0.000100
  Multiclass: Train acc: 0.5681, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7174, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8146, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0501)
Epoch 11/500 - Train loss: 1.0611, Val loss: 1.0344, Learning rate: 0.000100
  Multiclass: Train acc: 0.5648, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7294, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8146, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0344)
Epoch 12/500 - Train loss: 1.0423, Val loss: 1.0201, Learning rate: 0.000100
  Multiclass: Train acc: 0.5681, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7260, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0201)
Epoch 12 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13/500 - Train loss: 1.0217, Val loss: 1.0053, Learning rate: 0.000100
  Multiclass: Train acc: 0.5710, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7357, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0053)
Epoch 14/500 - Train loss: 1.0035, Val loss: 0.9836, Learning rate: 0.000100
  Multiclass: Train acc: 0.5734, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.7352, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9836)
Epoch 15/500 - Train loss: 0.9764, Val loss: 0.9636, Learning rate: 0.000100
  Multiclass: Train acc: 0.5782, Val acc: 0.5685, Val F1: 0.4145
  Contralateral: Train acc: 0.7381, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.44it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 16 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.44it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 16/500 - Train loss: 0.9617, Val loss: 0.9420, Learning rate: 0.000100
  Multiclass: Train acc: 0.5802, Val acc: 0.5708, Val F1: 0.4194
  Contralateral: Train acc: 0.7347, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8281, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9420)
Epoch 17/500 - Train loss: 0.9337, Val loss: 0.9159, Learning rate: 0.000100
  Multiclass: Train acc: 0.5932, Val acc: 0.5730, Val F1: 0.4278
  Contralateral: Train acc: 0.7371, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8257, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9159)
Epoch 18/500 - Train loss: 0.9007, Val loss: 0.8929, Learning rate: 0.000100
  Multiclass: Train acc: 0.6018, Val acc: 0.5730, Val F1: 0.4278
  Contralateral: Train acc: 0.7386, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8929)
Epoch 19/500 - Train loss: 0.8787, Val loss: 0.8648, Learning rate: 0.000100
  Multiclass: Train acc: 0.6086, Val acc: 0.5820, Val F1: 0.4469
  Contralateral: Train acc: 0.7371, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8281, Val acc: 0.8135, Val F1: 0.0235
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.29it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 121.29it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20/500 - Train loss: 0.8425, Val loss: 0.8326, Learning rate: 0.000100
  Multiclass: Train acc: 0.6153, Val acc: 0.5910, Val F1: 0.4712
  Contralateral: Train acc: 0.7429, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8349, Val acc: 0.8135, Val F1: 0.0235
New best model saved (val_loss: 0.8326)
Epoch 21/500 - Train loss: 0.8170, Val loss: 0.8032, Learning rate: 0.000100
  Multiclass: Train acc: 0.6298, Val acc: 0.6202, Val F1: 0.5316
  Contralateral: Train acc: 0.7525, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8358, Val acc: 0.8135, Val F1: 0.0460
New best model saved (val_loss: 0.8032)
Epoch 22/500 - Train loss: 0.7897, Val loss: 0.7707, Learning rate: 0.000100
  Multiclass: Train acc: 0.6346, Val acc: 0.6427, Val F1: 0.5713
  Contralateral: Train acc: 0.7545, Val acc: 0.7640, Val F1: 0.0708
  Ipsilateral: Train acc: 0.8440, Val acc: 0.8157, Val F1: 0.0682
New best model saved (val_loss: 0.7707)
Epoch 23/500 - Train loss: 0.7452, Val loss: 0.7324, Learning rate: 0.000100
  Multiclass: Train acc: 0.6591, Val acc: 0.6629, Val F1: 0.6107
  Contralateral: Train acc: 0.7540, Val acc: 0.7618, Val F1: 0.0862
  Ipsilateral: Train acc: 0.8435, Val acc: 0.8225, Val F1: 0.1505
Epoch 24 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.11it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 24 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.11it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 24/500 - Train loss: 0.7024, Val loss: 0.6947, Learning rate: 0.000100
  Multiclass: Train acc: 0.6851, Val acc: 0.6876, Val F1: 0.6481
  Contralateral: Train acc: 0.7626, Val acc: 0.7708, Val F1: 0.1500
  Ipsilateral: Train acc: 0.8556, Val acc: 0.8337, Val F1: 0.2745
New best model saved (val_loss: 0.6947)
Epoch 25/500 - Train loss: 0.6686, Val loss: 0.6599, Learning rate: 0.000100
  Multiclass: Train acc: 0.6909, Val acc: 0.7079, Val F1: 0.6819
  Contralateral: Train acc: 0.7703, Val acc: 0.7933, Val F1: 0.3030
  Ipsilateral: Train acc: 0.8690, Val acc: 0.8404, Val F1: 0.3486
New best model saved (val_loss: 0.6599)
Epoch 26/500 - Train loss: 0.6477, Val loss: 0.6266, Learning rate: 0.000100
  Multiclass: Train acc: 0.7068, Val acc: 0.7348, Val F1: 0.7158
  Contralateral: Train acc: 0.7761, Val acc: 0.8135, Val F1: 0.4196
  Ipsilateral: Train acc: 0.8734, Val acc: 0.8494, Val F1: 0.4370
Epoch 28 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.75it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 28 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.75it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27/500 - Train loss: 0.6065, Val loss: 0.5922, Learning rate: 0.000100
  Multiclass: Train acc: 0.7236, Val acc: 0.7506, Val F1: 0.7366
  Contralateral: Train acc: 0.7829, Val acc: 0.8315, Val F1: 0.5161
  Ipsilateral: Train acc: 0.8820, Val acc: 0.8809, Val F1: 0.6015
New best model saved (val_loss: 0.5922)
Epoch 28/500 - Train loss: 0.5753, Val loss: 0.5688, Learning rate: 0.000100
  Multiclass: Train acc: 0.7395, Val acc: 0.7483, Val F1: 0.7363
  Contralateral: Train acc: 0.8007, Val acc: 0.8382, Val F1: 0.5556
  Ipsilateral: Train acc: 0.8844, Val acc: 0.8831, Val F1: 0.6176
New best model saved (val_loss: 0.5688)
Epoch 29/500 - Train loss: 0.5574, Val loss: 0.5384, Learning rate: 0.000100
  Multiclass: Train acc: 0.7540, Val acc: 0.7640, Val F1: 0.7582
  Contralateral: Train acc: 0.8045, Val acc: 0.8517, Val F1: 0.6207
  Ipsilateral: Train acc: 0.8883, Val acc: 0.9056, Val F1: 0.7123
New best model saved (val_loss: 0.5384)
Epoch 30/500 - Train loss: 0.5277, Val loss: 0.5124, Learning rate: 0.000100
  Multiclass: Train acc: 0.7655, Val acc: 0.7730, Val F1: 0.7677
  Contralateral: Train acc: 0.8199, Val acc: 0.8652, Val F1: 0.6667
  Ipsilateral: Train acc: 0.8974, Val acc: 0.9056, Val F1: 0.7200
Epoch 32 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.68it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 32 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.68it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 31/500 - Train loss: 0.5288, Val loss: 0.4981, Learning rate: 0.000100
  Multiclass: Train acc: 0.7694, Val acc: 0.7865, Val F1: 0.7844
  Contralateral: Train acc: 0.8137, Val acc: 0.8629, Val F1: 0.6872
  Ipsilateral: Train acc: 0.9052, Val acc: 0.9079, Val F1: 0.7421
New best model saved (val_loss: 0.4981)
Epoch 32/500 - Train loss: 0.4796, Val loss: 0.4671, Learning rate: 0.000100
  Multiclass: Train acc: 0.7920, Val acc: 0.7955, Val F1: 0.7934
  Contralateral: Train acc: 0.8209, Val acc: 0.8629, Val F1: 0.6806
  Ipsilateral: Train acc: 0.9018, Val acc: 0.9124, Val F1: 0.7692
New best model saved (val_loss: 0.4671)
Epoch 33/500 - Train loss: 0.4630, Val loss: 0.4543, Learning rate: 0.000100
  Multiclass: Train acc: 0.7963, Val acc: 0.8022, Val F1: 0.8023
  Contralateral: Train acc: 0.8296, Val acc: 0.8787, Val F1: 0.7379
  Ipsilateral: Train acc: 0.9129, Val acc: 0.9124, Val F1: 0.7692
New best model saved (val_loss: 0.4543)
Epoch 34/500 - Train loss: 0.4370, Val loss: 0.4360, Learning rate: 0.000100
  Multiclass: Train acc: 0.8146, Val acc: 0.7955, Val F1: 0.7954
  Contralateral: Train acc: 0.8479, Val acc: 0.8719, Val F1: 0.7164
  Ipsilateral: Train acc: 0.9167, Val acc: 0.9236, Val F1: 0.8023
Epoch 36 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.62it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 36 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.62it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35/500 - Train loss: 0.4205, Val loss: 0.4355, Learning rate: 0.000100
  Multiclass: Train acc: 0.8137, Val acc: 0.8135, Val F1: 0.8132
  Contralateral: Train acc: 0.8522, Val acc: 0.8764, Val F1: 0.7343
  Ipsilateral: Train acc: 0.9268, Val acc: 0.9191, Val F1: 0.7831
New best model saved (val_loss: 0.4355)
Epoch 36/500 - Train loss: 0.4182, Val loss: 0.4133, Learning rate: 0.000100
  Multiclass: Train acc: 0.8103, Val acc: 0.8157, Val F1: 0.8163
  Contralateral: Train acc: 0.8522, Val acc: 0.8921, Val F1: 0.7736
  Ipsilateral: Train acc: 0.9278, Val acc: 0.9191, Val F1: 0.7882
New best model saved (val_loss: 0.4133)
Epoch 37/500 - Train loss: 0.3931, Val loss: 0.4059, Learning rate: 0.000100
  Multiclass: Train acc: 0.8325, Val acc: 0.8157, Val F1: 0.8161
  Contralateral: Train acc: 0.8695, Val acc: 0.8944, Val F1: 0.7773
  Ipsilateral: Train acc: 0.9355, Val acc: 0.9169, Val F1: 0.7811
New best model saved (val_loss: 0.4059)
Epoch 38/500 - Train loss: 0.3784, Val loss: 0.3970, Learning rate: 0.000100
  Multiclass: Train acc: 0.8402, Val acc: 0.8225, Val F1: 0.8226
  Contralateral: Train acc: 0.8714, Val acc: 0.9034, Val F1: 0.8000
  Ipsilateral: Train acc: 0.9321, Val acc: 0.9169, Val F1: 0.7811
Epoch 40 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.16it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 40 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 118.16it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 39/500 - Train loss: 0.3433, Val loss: 0.3879, Learning rate: 0.000100
  Multiclass: Train acc: 0.8609, Val acc: 0.8292, Val F1: 0.8298
  Contralateral: Train acc: 0.8883, Val acc: 0.8966, Val F1: 0.7870
  Ipsilateral: Train acc: 0.9393, Val acc: 0.9191, Val F1: 0.8000
New best model saved (val_loss: 0.3879)
Epoch 40/500 - Train loss: 0.3392, Val loss: 0.3791, Learning rate: 0.000100
  Multiclass: Train acc: 0.8604, Val acc: 0.8270, Val F1: 0.8272
  Contralateral: Train acc: 0.8869, Val acc: 0.8989, Val F1: 0.7945
  Ipsilateral: Train acc: 0.9451, Val acc: 0.9213, Val F1: 0.7953
New best model saved (val_loss: 0.3791)
Epoch 41/500 - Train loss: 0.3086, Val loss: 0.3721, Learning rate: 0.000100
  Multiclass: Train acc: 0.8695, Val acc: 0.8315, Val F1: 0.8322
  Contralateral: Train acc: 0.8950, Val acc: 0.9011, Val F1: 0.8000
  Ipsilateral: Train acc: 0.9466, Val acc: 0.9236, Val F1: 0.8090
Epoch 44 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 44 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 120.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 42/500 - Train loss: 0.3233, Val loss: 0.3570, Learning rate: 0.000100
  Multiclass: Train acc: 0.8705, Val acc: 0.8382, Val F1: 0.8387
  Contralateral: Train acc: 0.9023, Val acc: 0.9146, Val F1: 0.8224
  Ipsilateral: Train acc: 0.9398, Val acc: 0.9213, Val F1: 0.8023
New best model saved (val_loss: 0.3570)
Epoch 43/500 - Train loss: 0.3243, Val loss: 0.3632, Learning rate: 0.000100
  Multiclass: Train acc: 0.8642, Val acc: 0.8427, Val F1: 0.8431
  Contralateral: Train acc: 0.8955, Val acc: 0.9124, Val F1: 0.8186
  Ipsilateral: Train acc: 0.9504, Val acc: 0.9258, Val F1: 0.8070
Epoch 44/500 - Train loss: 0.2890, Val loss: 0.3493, Learning rate: 0.000100
  Multiclass: Train acc: 0.8767, Val acc: 0.8404, Val F1: 0.8413
  Contralateral: Train acc: 0.9052, Val acc: 0.9124, Val F1: 0.8219
  Ipsilateral: Train acc: 0.9533, Val acc: 0.9213, Val F1: 0.8045
New best model saved (val_loss: 0.3493)
Epoch 45/500 - Train loss: 0.2887, Val loss: 0.3540, Learning rate: 0.000100
  Multiclass: Train acc: 0.8835, Val acc: 0.8382, Val F1: 0.8388
  Contralateral: Train acc: 0.9095, Val acc: 0.9146, Val F1: 0.8224
Epoch 48 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.94it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 48 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.94it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 46/500 - Train loss: 0.2828, Val loss: 0.3649, Learning rate: 0.000100
  Multiclass: Train acc: 0.8719, Val acc: 0.8315, Val F1: 0.8315
  Contralateral: Train acc: 0.9191, Val acc: 0.9079, Val F1: 0.8093
  Ipsilateral: Train acc: 0.9490, Val acc: 0.9191, Val F1: 0.7857
Epoch 47/500 - Train loss: 0.2901, Val loss: 0.3666, Learning rate: 0.000100
  Multiclass: Train acc: 0.8859, Val acc: 0.8315, Val F1: 0.8317
  Contralateral: Train acc: 0.9129, Val acc: 0.9124, Val F1: 0.8169
  Ipsilateral: Train acc: 0.9538, Val acc: 0.9213, Val F1: 0.7953
Epoch 48/500 - Train loss: 0.2587, Val loss: 0.3530, Learning rate: 0.000100
  Multiclass: Train acc: 0.8907, Val acc: 0.8337, Val F1: 0.8341
  Contralateral: Train acc: 0.9201, Val acc: 0.9079, Val F1: 0.8093
  Ipsilateral: Train acc: 0.9523, Val acc: 0.9169, Val F1: 0.7861
Epoch 49/500 - Train loss: 0.2873, Val loss: 0.3665, Learning rate: 0.000100
  Multiclass: Train acc: 0.8835, Val acc: 0.8360, Val F1: 0.8354
  Contralateral: Train acc: 0.9191, Val acc: 0.9056, Val F1: 0.8000
Epoch 52 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.24it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 52 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 119.24it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 50/500 - Train loss: 0.2415, Val loss: 0.3391, Learning rate: 0.000100
  Multiclass: Train acc: 0.9027, Val acc: 0.8494, Val F1: 0.8497
  Contralateral: Train acc: 0.9206, Val acc: 0.9124, Val F1: 0.8219
  Ipsilateral: Train acc: 0.9629, Val acc: 0.9371, Val F1: 0.8409
New best model saved (val_loss: 0.3391)
Epoch 51/500 - Train loss: 0.2493, Val loss: 0.3648, Learning rate: 0.000100
  Multiclass: Train acc: 0.8974, Val acc: 0.8427, Val F1: 0.8422
  Contralateral: Train acc: 0.9225, Val acc: 0.9011, Val F1: 0.7864
  Ipsilateral: Train acc: 0.9620, Val acc: 0.9371, Val F1: 0.8333
Epoch 52/500 - Train loss: 0.2433, Val loss: 0.3505, Learning rate: 0.000100
  Multiclass: Train acc: 0.9071, Val acc: 0.8494, Val F1: 0.8497
  Contralateral: Train acc: 0.9278, Val acc: 0.9056, Val F1: 0.8056
Epoch 56 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 116.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 56 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 116.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 53/500 - Train loss: 0.2173, Val loss: 0.3618, Learning rate: 0.000100
  Multiclass: Train acc: 0.9210, Val acc: 0.8472, Val F1: 0.8478
  Contralateral: Train acc: 0.9427, Val acc: 0.9124, Val F1: 0.8235
  Ipsilateral: Train acc: 0.9610, Val acc: 0.9236, Val F1: 0.8068
Epoch 54/500 - Train loss: 0.2132, Val loss: 0.3634, Learning rate: 0.000100
  Multiclass: Train acc: 0.9167, Val acc: 0.8360, Val F1: 0.8361
  Contralateral: Train acc: 0.9369, Val acc: 0.8989, Val F1: 0.7907
  Ipsilateral: Train acc: 0.9576, Val acc: 0.9258, Val F1: 0.8047
Epoch 55/500 - Train loss: 0.2134, Val loss: 0.3494, Learning rate: 0.000100
  Multiclass: Train acc: 0.9129, Val acc: 0.8494, Val F1: 0.8503
  Contralateral: Train acc: 0.9393, Val acc: 0.9146, Val F1: 0.8273
  Ipsilateral: Train acc: 0.9644, Val acc: 0.9281, Val F1: 0.8182
Epoch 00056: reducing learning rate of group 0 to 5.0000e-05.
Epoch 56/500 - Train loss: 0.2232, Val loss: 0.3717, Learning rate: 0.000050
  Multiclass: Train acc: 0.9167, Val acc: 0.8517, Val F1: 0.8515
  Contralateral: Train acc: 0.9393, Val acc: 0.9146, Val F1: 0.8190
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.61it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.61it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 57/500 - Train loss: 0.2097, Val loss: 0.3682, Learning rate: 0.000050
  Multiclass: Train acc: 0.9133, Val acc: 0.8427, Val F1: 0.8434
  Contralateral: Train acc: 0.9475, Val acc: 0.9056, Val F1: 0.8091
  Ipsilateral: Train acc: 0.9658, Val acc: 0.9213, Val F1: 0.8045
Early stopping triggered after 57 epochs
Best model was at epoch 50
Training completed. Best validation loss: 0.3391
Evaluating on test set...
[2025-04-09 16:23:41,351][HYDRA] 	#6 : model=lstm model.hidden_size=64 model.num_layers=2 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 64
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 64, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=64, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 164551
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.2237, Val loss: 1.1104, Learning rate: 0.001000
  Multiclass: Train acc: 0.5128, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7164, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.5705, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1104)
Epoch 2/500 - Train loss: 1.0756, Val loss: 0.9886, Learning rate: 0.001000
  Multiclass: Train acc: 0.5662, Val acc: 0.5865, Val F1: 0.4558
  Contralateral: Train acc: 0.7410, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8127, Val acc: 0.8112, Val F1: 0.0000
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 116.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 3/500 - Train loss: 0.9144, Val loss: 0.8389, Learning rate: 0.001000
  Multiclass: Train acc: 0.6095, Val acc: 0.6427, Val F1: 0.5907
  Contralateral: Train acc: 0.7607, Val acc: 0.8337, Val F1: 0.6263
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8389)
Epoch 4/500 - Train loss: 0.7407, Val loss: 0.6282, Learning rate: 0.001000
  Multiclass: Train acc: 0.6813, Val acc: 0.7124, Val F1: 0.7148
  Contralateral: Train acc: 0.8219, Val acc: 0.8360, Val F1: 0.6867
  Ipsilateral: Train acc: 0.8223, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6282)
Epoch 5/500 - Train loss: 0.6034, Val loss: 0.4976, Learning rate: 0.001000
  Multiclass: Train acc: 0.7366, Val acc: 0.7865, Val F1: 0.7879
  Contralateral: Train acc: 0.8488, Val acc: 0.8899, Val F1: 0.7783
  Ipsilateral: Train acc: 0.8459, Val acc: 0.8809, Val F1: 0.6490
New best model saved (val_loss: 0.4976)
Epoch 6/500 - Train loss: 0.5261, Val loss: 0.4330, Learning rate: 0.001000
  Multiclass: Train acc: 0.7785, Val acc: 0.7955, Val F1: 0.7975
  Contralateral: Train acc: 0.8739, Val acc: 0.8921, Val F1: 0.7931
  Ipsilateral: Train acc: 0.8763, Val acc: 0.9011, Val F1: 0.7528
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 110.82it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 110.82it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 7/500 - Train loss: 0.4486, Val loss: 0.4582, Learning rate: 0.001000
  Multiclass: Train acc: 0.8180, Val acc: 0.7798, Val F1: 0.7812
  Contralateral: Train acc: 0.8946, Val acc: 0.8854, Val F1: 0.7650
  Ipsilateral: Train acc: 0.9037, Val acc: 0.8876, Val F1: 0.7191
Epoch 8/500 - Train loss: 0.4514, Val loss: 0.4297, Learning rate: 0.001000
  Multiclass: Train acc: 0.8209, Val acc: 0.8202, Val F1: 0.8210
  Contralateral: Train acc: 0.8974, Val acc: 0.9056, Val F1: 0.8073
  Ipsilateral: Train acc: 0.8960, Val acc: 0.9079, Val F1: 0.7684
New best model saved (val_loss: 0.4297)
Epoch 9/500 - Train loss: 0.3769, Val loss: 0.3571, Learning rate: 0.001000
  Multiclass: Train acc: 0.8517, Val acc: 0.8337, Val F1: 0.8342
  Contralateral: Train acc: 0.9100, Val acc: 0.9034, Val F1: 0.8089
  Ipsilateral: Train acc: 0.9249, Val acc: 0.9258, Val F1: 0.8235
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.35it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 117.35it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 10/500 - Train loss: 0.3381, Val loss: 0.3781, Learning rate: 0.001000
  Multiclass: Train acc: 0.8714, Val acc: 0.8360, Val F1: 0.8368
  Contralateral: Train acc: 0.9249, Val acc: 0.9034, Val F1: 0.8155
  Ipsilateral: Train acc: 0.9374, Val acc: 0.9258, Val F1: 0.8136
Epoch 11/500 - Train loss: 0.3266, Val loss: 0.3558, Learning rate: 0.001000
  Multiclass: Train acc: 0.8782, Val acc: 0.8449, Val F1: 0.8457
  Contralateral: Train acc: 0.9302, Val acc: 0.9169, Val F1: 0.8326
  Ipsilateral: Train acc: 0.9369, Val acc: 0.9236, Val F1: 0.8152
New best model saved (val_loss: 0.3558)
Epoch 12/500 - Train loss: 0.3015, Val loss: 0.3917, Learning rate: 0.001000
  Multiclass: Train acc: 0.8883, Val acc: 0.8494, Val F1: 0.8500
  Contralateral: Train acc: 0.9345, Val acc: 0.9236, Val F1: 0.8482
  Ipsilateral: Train acc: 0.9427, Val acc: 0.9236, Val F1: 0.8068
Epoch 13/500 - Train loss: 0.2846, Val loss: 0.4723, Learning rate: 0.001000
  Multiclass: Train acc: 0.9013, Val acc: 0.8449, Val F1: 0.8458
  Contralateral: Train acc: 0.9379, Val acc: 0.9281, Val F1: 0.8621
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.22it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.22it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 14/500 - Train loss: 0.2958, Val loss: 0.4449, Learning rate: 0.001000
  Multiclass: Train acc: 0.8955, Val acc: 0.8494, Val F1: 0.8492
  Contralateral: Train acc: 0.9384, Val acc: 0.9213, Val F1: 0.8372
  Ipsilateral: Train acc: 0.9451, Val acc: 0.9213, Val F1: 0.7904
Epoch 15/500 - Train loss: 0.2599, Val loss: 0.3758, Learning rate: 0.001000
  Multiclass: Train acc: 0.9148, Val acc: 0.8607, Val F1: 0.8616
  Contralateral: Train acc: 0.9393, Val acc: 0.9191, Val F1: 0.8421
  Ipsilateral: Train acc: 0.9620, Val acc: 0.9348, Val F1: 0.8380
Epoch 16/500 - Train loss: 0.2308, Val loss: 0.4600, Learning rate: 0.001000
  Multiclass: Train acc: 0.9124, Val acc: 0.8494, Val F1: 0.8504
  Contralateral: Train acc: 0.9413, Val acc: 0.9146, Val F1: 0.8333
  Ipsilateral: Train acc: 0.9581, Val acc: 0.9258, Val F1: 0.8114
Epoch 17/500 - Train loss: 0.2396, Val loss: 0.3080, Learning rate: 0.001000
  Multiclass: Train acc: 0.9027, Val acc: 0.8764, Val F1: 0.8767
  Contralateral: Train acc: 0.9384, Val acc: 0.9303, Val F1: 0.8597
  Ipsilateral: Train acc: 0.9600, Val acc: 0.9461, Val F1: 0.8636
Epoch 21 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 21 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 18/500 - Train loss: 0.2106, Val loss: 0.3668, Learning rate: 0.001000
  Multiclass: Train acc: 0.9206, Val acc: 0.8562, Val F1: 0.8565
  Contralateral: Train acc: 0.9475, Val acc: 0.9213, Val F1: 0.8387
  Ipsilateral: Train acc: 0.9663, Val acc: 0.9348, Val F1: 0.8398
Epoch 19/500 - Train loss: 0.2255, Val loss: 0.3714, Learning rate: 0.001000
  Multiclass: Train acc: 0.9268, Val acc: 0.8674, Val F1: 0.8676
  Contralateral: Train acc: 0.9519, Val acc: 0.9258, Val F1: 0.8520
  Ipsilateral: Train acc: 0.9658, Val acc: 0.9393, Val F1: 0.8439
Epoch 20/500 - Train loss: 0.2089, Val loss: 0.4309, Learning rate: 0.001000
  Multiclass: Train acc: 0.9336, Val acc: 0.8787, Val F1: 0.8785
  Contralateral: Train acc: 0.9567, Val acc: 0.9303, Val F1: 0.8622
Epoch 21 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 104.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 21 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 104.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 21/500 - Train loss: 0.1802, Val loss: 0.3723, Learning rate: 0.001000
  Multiclass: Train acc: 0.9350, Val acc: 0.8629, Val F1: 0.8636
  Contralateral: Train acc: 0.9624, Val acc: 0.9213, Val F1: 0.8458
  Ipsilateral: Train acc: 0.9687, Val acc: 0.9393, Val F1: 0.8492
Epoch 22/500 - Train loss: 0.2365, Val loss: 0.3857, Learning rate: 0.001000
  Multiclass: Train acc: 0.9259, Val acc: 0.8607, Val F1: 0.8605
  Contralateral: Train acc: 0.9523, Val acc: 0.9146, Val F1: 0.8190
  Ipsilateral: Train acc: 0.9663, Val acc: 0.9438, Val F1: 0.8634
Epoch 00023: reducing learning rate of group 0 to 5.0000e-04.
Epoch 23/500 - Train loss: 0.1955, Val loss: 0.3885, Learning rate: 0.000500
  Multiclass: Train acc: 0.9331, Val acc: 0.8629, Val F1: 0.8632
  Contralateral: Train acc: 0.9547, Val acc: 0.9146, Val F1: 0.8319
  Ipsilateral: Train acc: 0.9716, Val acc: 0.9438, Val F1: 0.8466
Epoch 24/500 - Train loss: 0.1798, Val loss: 0.3884, Learning rate: 0.000500
  Multiclass: Train acc: 0.9403, Val acc: 0.8629, Val F1: 0.8627
  Contralateral: Train acc: 0.9653, Val acc: 0.9124, Val F1: 0.8235
  Ipsilateral: Train acc: 0.9697, Val acc: 0.9483, Val F1: 0.8553
Early stopping triggered after 24 epochs
Best model was at epoch 17
Training completed. Best validation loss: 0.3080
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.39it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.39it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
[2025-04-09 16:23:55,125][HYDRA] 	#7 : model=lstm model.hidden_size=64 model.num_layers=2 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 64
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 64, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=64, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 164551
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.3172, Val loss: 1.2604, Learning rate: 0.000100
  Multiclass: Train acc: 0.4092, Val acc: 0.5640, Val F1: 0.4332
  Contralateral: Train acc: 0.6663, Val acc: 0.7528, Val F1: 0.0000
  Ipsilateral: Train acc: 0.3568, Val acc: 0.2921, Val F1: 0.3046
New best model saved (val_loss: 1.2604)
Epoch 2/500 - Train loss: 1.2741, Val loss: 1.2280, Learning rate: 0.000100
  Multiclass: Train acc: 0.4521, Val acc: 0.5685, Val F1: 0.4199
  Contralateral: Train acc: 0.6981, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.4088, Val acc: 0.3820, Val F1: 0.3176
New best model saved (val_loss: 1.2280)
Epoch 3/500 - Train loss: 1.2408, Val loss: 1.2067, Learning rate: 0.000100
  Multiclass: Train acc: 0.5123, Val acc: 0.5685, Val F1: 0.4184
  Contralateral: Train acc: 0.7106, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.4468, Val acc: 0.5146, Val F1: 0.2752
Epoch 7 (Val):   0%|                                            | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 7 (Val):   0%|                                            | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4/500 - Train loss: 1.2283, Val loss: 1.1824, Learning rate: 0.000100
  Multiclass: Train acc: 0.5079, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7188, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.5551, Val acc: 0.6135, Val F1: 0.1650
New best model saved (val_loss: 1.1824)
Epoch 5/500 - Train loss: 1.1967, Val loss: 1.1594, Learning rate: 0.000100
  Multiclass: Train acc: 0.5320, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7198, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.5951, Val acc: 0.7236, Val F1: 0.0465
New best model saved (val_loss: 1.1594)
Epoch 6/500 - Train loss: 1.1753, Val loss: 1.1423, Learning rate: 0.000100
  Multiclass: Train acc: 0.5421, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7366, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.6505, Val acc: 0.8000, Val F1: 0.0220
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 7/500 - Train loss: 1.1625, Val loss: 1.1194, Learning rate: 0.000100
  Multiclass: Train acc: 0.5474, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7280, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.6899, Val acc: 0.8090, Val F1: 0.0000
New best model saved (val_loss: 1.1194)
Epoch 8/500 - Train loss: 1.1324, Val loss: 1.0999, Learning rate: 0.000100
  Multiclass: Train acc: 0.5599, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7381, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7222, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0999)
Epoch 9/500 - Train loss: 1.1225, Val loss: 1.0845, Learning rate: 0.000100
  Multiclass: Train acc: 0.5546, Val acc: 0.5640, Val F1: 0.4084
  Contralateral: Train acc: 0.7309, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7559, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0845)
Epoch 10/500 - Train loss: 1.0966, Val loss: 1.0664, Learning rate: 0.000100
  Multiclass: Train acc: 0.5725, Val acc: 0.5640, Val F1: 0.4090
  Contralateral: Train acc: 0.7333, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7694, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 103.55it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 103.55it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 11/500 - Train loss: 1.0725, Val loss: 1.0448, Learning rate: 0.000100
  Multiclass: Train acc: 0.5604, Val acc: 0.5663, Val F1: 0.4178
  Contralateral: Train acc: 0.7265, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7843, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0448)
Epoch 12/500 - Train loss: 1.0618, Val loss: 1.0314, Learning rate: 0.000100
  Multiclass: Train acc: 0.5763, Val acc: 0.5730, Val F1: 0.4323
  Contralateral: Train acc: 0.7424, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7910, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0314)
Epoch 13/500 - Train loss: 1.0402, Val loss: 1.0050, Learning rate: 0.000100
  Multiclass: Train acc: 0.5778, Val acc: 0.5820, Val F1: 0.4504
  Contralateral: Train acc: 0.7400, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8036, Val acc: 0.8112, Val F1: 0.0000
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.16it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.16it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 14/500 - Train loss: 1.0225, Val loss: 0.9855, Learning rate: 0.000100
  Multiclass: Train acc: 0.5840, Val acc: 0.5910, Val F1: 0.4697
  Contralateral: Train acc: 0.7395, Val acc: 0.7551, Val F1: 0.0180
  Ipsilateral: Train acc: 0.8089, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9855)
Epoch 15/500 - Train loss: 0.9930, Val loss: 0.9568, Learning rate: 0.000100
  Multiclass: Train acc: 0.5859, Val acc: 0.5910, Val F1: 0.4697
  Contralateral: Train acc: 0.7496, Val acc: 0.7528, Val F1: 0.0179
  Ipsilateral: Train acc: 0.8113, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9568)
Epoch 16/500 - Train loss: 0.9731, Val loss: 0.9331, Learning rate: 0.000100
  Multiclass: Train acc: 0.6066, Val acc: 0.6135, Val F1: 0.5110
  Contralateral: Train acc: 0.7525, Val acc: 0.7551, Val F1: 0.0684
  Ipsilateral: Train acc: 0.8108, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9331)
Epoch 17/500 - Train loss: 0.9408, Val loss: 0.9106, Learning rate: 0.000100
  Multiclass: Train acc: 0.6153, Val acc: 0.6292, Val F1: 0.5381
  Contralateral: Train acc: 0.7588, Val acc: 0.7573, Val F1: 0.1148
  Ipsilateral: Train acc: 0.8127, Val acc: 0.8112, Val F1: 0.0000
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.75it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.75it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 18/500 - Train loss: 0.9113, Val loss: 0.8878, Learning rate: 0.000100
  Multiclass: Train acc: 0.6230, Val acc: 0.6427, Val F1: 0.5579
  Contralateral: Train acc: 0.7540, Val acc: 0.7865, Val F1: 0.3357
  Ipsilateral: Train acc: 0.8117, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8878)
Epoch 19/500 - Train loss: 0.8924, Val loss: 0.8605, Learning rate: 0.000100
  Multiclass: Train acc: 0.6322, Val acc: 0.6449, Val F1: 0.5711
  Contralateral: Train acc: 0.7713, Val acc: 0.7933, Val F1: 0.3867
  Ipsilateral: Train acc: 0.8156, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8605)
Epoch 20/500 - Train loss: 0.8535, Val loss: 0.8344, Learning rate: 0.000100
  Multiclass: Train acc: 0.6514, Val acc: 0.6719, Val F1: 0.6051
  Contralateral: Train acc: 0.7853, Val acc: 0.8090, Val F1: 0.4848
  Ipsilateral: Train acc: 0.8166, Val acc: 0.8112, Val F1: 0.0000
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.60it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.60it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 21/500 - Train loss: 0.8197, Val loss: 0.8024, Learning rate: 0.000100
  Multiclass: Train acc: 0.6688, Val acc: 0.6831, Val F1: 0.6319
  Contralateral: Train acc: 0.7790, Val acc: 0.8315, Val F1: 0.5856
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8024)
Epoch 22/500 - Train loss: 0.7985, Val loss: 0.7670, Learning rate: 0.000100
  Multiclass: Train acc: 0.6765, Val acc: 0.6966, Val F1: 0.6544
  Contralateral: Train acc: 0.7959, Val acc: 0.8337, Val F1: 0.5978
  Ipsilateral: Train acc: 0.8195, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7670)
Epoch 23/500 - Train loss: 0.7634, Val loss: 0.7318, Learning rate: 0.000100
  Multiclass: Train acc: 0.6866, Val acc: 0.7258, Val F1: 0.7011
  Contralateral: Train acc: 0.8103, Val acc: 0.8382, Val F1: 0.6250
  Ipsilateral: Train acc: 0.8190, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7318)
Epoch 24/500 - Train loss: 0.7198, Val loss: 0.7098, Learning rate: 0.000100
  Multiclass: Train acc: 0.6967, Val acc: 0.7101, Val F1: 0.6820
  Contralateral: Train acc: 0.8161, Val acc: 0.8404, Val F1: 0.6243
  Ipsilateral: Train acc: 0.8180, Val acc: 0.8112, Val F1: 0.0000
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.84it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.84it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 25/500 - Train loss: 0.7140, Val loss: 0.6731, Learning rate: 0.000100
  Multiclass: Train acc: 0.7159, Val acc: 0.7461, Val F1: 0.7370
  Contralateral: Train acc: 0.8272, Val acc: 0.8472, Val F1: 0.6792
  Ipsilateral: Train acc: 0.8146, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6731)
Epoch 26/500 - Train loss: 0.6734, Val loss: 0.6506, Learning rate: 0.000100
  Multiclass: Train acc: 0.7183, Val acc: 0.7461, Val F1: 0.7371
  Contralateral: Train acc: 0.8329, Val acc: 0.8674, Val F1: 0.7230
  Ipsilateral: Train acc: 0.8185, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6506)
Epoch 27/500 - Train loss: 0.6432, Val loss: 0.6287, Learning rate: 0.000100
  Multiclass: Train acc: 0.7260, Val acc: 0.7438, Val F1: 0.7376
  Contralateral: Train acc: 0.8459, Val acc: 0.8809, Val F1: 0.7558
  Ipsilateral: Train acc: 0.8180, Val acc: 0.8112, Val F1: 0.0000
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.87it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 28/500 - Train loss: 0.6151, Val loss: 0.6046, Learning rate: 0.000100
  Multiclass: Train acc: 0.7564, Val acc: 0.7506, Val F1: 0.7469
  Contralateral: Train acc: 0.8488, Val acc: 0.8719, Val F1: 0.7299
  Ipsilateral: Train acc: 0.8137, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.6046)
Epoch 29/500 - Train loss: 0.6142, Val loss: 0.5667, Learning rate: 0.000100
  Multiclass: Train acc: 0.7559, Val acc: 0.7753, Val F1: 0.7731
  Contralateral: Train acc: 0.8580, Val acc: 0.8787, Val F1: 0.7523
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5667)
Epoch 30/500 - Train loss: 0.6073, Val loss: 0.5447, Learning rate: 0.000100
  Multiclass: Train acc: 0.7597, Val acc: 0.7640, Val F1: 0.7605
  Contralateral: Train acc: 0.8618, Val acc: 0.8787, Val F1: 0.7523
  Ipsilateral: Train acc: 0.8185, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.5447)
Epoch 31/500 - Train loss: 0.5581, Val loss: 0.5252, Learning rate: 0.000100
  Multiclass: Train acc: 0.7780, Val acc: 0.7843, Val F1: 0.7835
  Contralateral: Train acc: 0.8695, Val acc: 0.8831, Val F1: 0.7636
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
Epoch 35 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 32/500 - Train loss: 0.5339, Val loss: 0.4989, Learning rate: 0.000100
  Multiclass: Train acc: 0.7776, Val acc: 0.8045, Val F1: 0.8048
  Contralateral: Train acc: 0.8811, Val acc: 0.8989, Val F1: 0.8018
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.4989)
Epoch 33/500 - Train loss: 0.5065, Val loss: 0.4754, Learning rate: 0.000100
  Multiclass: Train acc: 0.7939, Val acc: 0.8022, Val F1: 0.8026
  Contralateral: Train acc: 0.8883, Val acc: 0.8944, Val F1: 0.7948
  Ipsilateral: Train acc: 0.8353, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.4754)
Epoch 34/500 - Train loss: 0.5018, Val loss: 0.4620, Learning rate: 0.000100
  Multiclass: Train acc: 0.7886, Val acc: 0.8067, Val F1: 0.8074
  Contralateral: Train acc: 0.8907, Val acc: 0.8944, Val F1: 0.8000
  Ipsilateral: Train acc: 0.8276, Val acc: 0.8112, Val F1: 0.0000
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.35it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.35it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35/500 - Train loss: 0.4945, Val loss: 0.4468, Learning rate: 0.000100
  Multiclass: Train acc: 0.8050, Val acc: 0.8112, Val F1: 0.8118
  Contralateral: Train acc: 0.8878, Val acc: 0.9034, Val F1: 0.8106
  Ipsilateral: Train acc: 0.8353, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.4468)
Epoch 36/500 - Train loss: 0.4775, Val loss: 0.4311, Learning rate: 0.000100
  Multiclass: Train acc: 0.8113, Val acc: 0.8067, Val F1: 0.8078
  Contralateral: Train acc: 0.8974, Val acc: 0.9011, Val F1: 0.8120
  Ipsilateral: Train acc: 0.8541, Val acc: 0.8517, Val F1: 0.3654
New best model saved (val_loss: 0.4311)
Epoch 37/500 - Train loss: 0.4649, Val loss: 0.4207, Learning rate: 0.000100
  Multiclass: Train acc: 0.8050, Val acc: 0.8135, Val F1: 0.8139
  Contralateral: Train acc: 0.8979, Val acc: 0.9079, Val F1: 0.8161
  Ipsilateral: Train acc: 0.8512, Val acc: 0.8697, Val F1: 0.5085
New best model saved (val_loss: 0.4207)
Epoch 38/500 - Train loss: 0.4341, Val loss: 0.4132, Learning rate: 0.000100
  Multiclass: Train acc: 0.8209, Val acc: 0.8090, Val F1: 0.8100
  Contralateral: Train acc: 0.9100, Val acc: 0.9124, Val F1: 0.8219
  Ipsilateral: Train acc: 0.8541, Val acc: 0.8876, Val F1: 0.6269
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.53it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.53it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 39/500 - Train loss: 0.4291, Val loss: 0.4149, Learning rate: 0.000100
  Multiclass: Train acc: 0.8276, Val acc: 0.8090, Val F1: 0.8096
  Contralateral: Train acc: 0.9090, Val acc: 0.8921, Val F1: 0.7895
  Ipsilateral: Train acc: 0.8556, Val acc: 0.8921, Val F1: 0.6418
Epoch 40/500 - Train loss: 0.4221, Val loss: 0.4169, Learning rate: 0.000100
  Multiclass: Train acc: 0.8368, Val acc: 0.8045, Val F1: 0.8043
  Contralateral: Train acc: 0.9076, Val acc: 0.9056, Val F1: 0.8205
  Ipsilateral: Train acc: 0.8686, Val acc: 0.8876, Val F1: 0.6377
Epoch 41/500 - Train loss: 0.3996, Val loss: 0.3882, Learning rate: 0.000100
  Multiclass: Train acc: 0.8402, Val acc: 0.8180, Val F1: 0.8194
  Contralateral: Train acc: 0.9157, Val acc: 0.8966, Val F1: 0.8017
  Ipsilateral: Train acc: 0.8782, Val acc: 0.9034, Val F1: 0.7394
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.08it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 43 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.08it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 42/500 - Train loss: 0.4090, Val loss: 0.3862, Learning rate: 0.000100
  Multiclass: Train acc: 0.8358, Val acc: 0.8202, Val F1: 0.8202
  Contralateral: Train acc: 0.9119, Val acc: 0.9034, Val F1: 0.8037
  Ipsilateral: Train acc: 0.8849, Val acc: 0.9079, Val F1: 0.7355
New best model saved (val_loss: 0.3862)
Epoch 43/500 - Train loss: 0.4193, Val loss: 0.3930, Learning rate: 0.000100
  Multiclass: Train acc: 0.8349, Val acc: 0.8045, Val F1: 0.8044
  Contralateral: Train acc: 0.9071, Val acc: 0.9011, Val F1: 0.8053
  Ipsilateral: Train acc: 0.8806, Val acc: 0.8989, Val F1: 0.7097
Epoch 44/500 - Train loss: 0.3924, Val loss: 0.3874, Learning rate: 0.000100
  Multiclass: Train acc: 0.8459, Val acc: 0.8135, Val F1: 0.8138
  Contralateral: Train acc: 0.9119, Val acc: 0.9034, Val F1: 0.8037
  Ipsilateral: Train acc: 0.8840, Val acc: 0.9011, Val F1: 0.7215
Epoch 45/500 - Train loss: 0.3856, Val loss: 0.3793, Learning rate: 0.000100
  Multiclass: Train acc: 0.8517, Val acc: 0.8202, Val F1: 0.8201
  Contralateral: Train acc: 0.9201, Val acc: 0.8989, Val F1: 0.8035
  Ipsilateral: Train acc: 0.8984, Val acc: 0.9079, Val F1: 0.7320
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.98it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 47 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.98it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 46/500 - Train loss: 0.3663, Val loss: 0.3743, Learning rate: 0.000100
  Multiclass: Train acc: 0.8575, Val acc: 0.8135, Val F1: 0.8138
  Contralateral: Train acc: 0.9186, Val acc: 0.9034, Val F1: 0.8139
  Ipsilateral: Train acc: 0.8888, Val acc: 0.9079, Val F1: 0.7515
New best model saved (val_loss: 0.3743)
Epoch 47/500 - Train loss: 0.3586, Val loss: 0.3861, Learning rate: 0.000100
  Multiclass: Train acc: 0.8556, Val acc: 0.8270, Val F1: 0.8275
  Contralateral: Train acc: 0.9201, Val acc: 0.9011, Val F1: 0.8070
  Ipsilateral: Train acc: 0.9061, Val acc: 0.9124, Val F1: 0.7692
Epoch 48/500 - Train loss: 0.3717, Val loss: 0.3788, Learning rate: 0.000100
  Multiclass: Train acc: 0.8599, Val acc: 0.8067, Val F1: 0.8070
  Contralateral: Train acc: 0.9244, Val acc: 0.8966, Val F1: 0.7928
  Ipsilateral: Train acc: 0.8878, Val acc: 0.9124, Val F1: 0.7719
Epoch 49/500 - Train loss: 0.3357, Val loss: 0.3720, Learning rate: 0.000100
  Multiclass: Train acc: 0.8686, Val acc: 0.8202, Val F1: 0.8210
  Contralateral: Train acc: 0.9292, Val acc: 0.9101, Val F1: 0.8246
  Ipsilateral: Train acc: 0.9032, Val acc: 0.9079, Val F1: 0.7684
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 108.18it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 51 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 108.18it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 50/500 - Train loss: 0.3448, Val loss: 0.3771, Learning rate: 0.000100
  Multiclass: Train acc: 0.8647, Val acc: 0.8270, Val F1: 0.8279
  Contralateral: Train acc: 0.9215, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9109, Val acc: 0.9124, Val F1: 0.7821
Epoch 51/500 - Train loss: 0.3458, Val loss: 0.3769, Learning rate: 0.000100
  Multiclass: Train acc: 0.8686, Val acc: 0.8157, Val F1: 0.8170
  Contralateral: Train acc: 0.9234, Val acc: 0.9034, Val F1: 0.8186
  Ipsilateral: Train acc: 0.9124, Val acc: 0.9079, Val F1: 0.7735
Epoch 52/500 - Train loss: 0.3564, Val loss: 0.3572, Learning rate: 0.000100
  Multiclass: Train acc: 0.8657, Val acc: 0.8270, Val F1: 0.8278
  Contralateral: Train acc: 0.9302, Val acc: 0.9169, Val F1: 0.8341
  Ipsilateral: Train acc: 0.9061, Val acc: 0.8966, Val F1: 0.7416
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.27it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 55 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 114.27it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 53/500 - Train loss: 0.3423, Val loss: 0.3845, Learning rate: 0.000100
  Multiclass: Train acc: 0.8772, Val acc: 0.8157, Val F1: 0.8160
  Contralateral: Train acc: 0.9302, Val acc: 0.9146, Val F1: 0.8273
  Ipsilateral: Train acc: 0.9133, Val acc: 0.8944, Val F1: 0.7283
Epoch 54/500 - Train loss: 0.3369, Val loss: 0.3828, Learning rate: 0.000100
  Multiclass: Train acc: 0.8743, Val acc: 0.8067, Val F1: 0.8064
  Contralateral: Train acc: 0.9350, Val acc: 0.9011, Val F1: 0.8053
  Ipsilateral: Train acc: 0.9177, Val acc: 0.9124, Val F1: 0.7746
Epoch 55/500 - Train loss: 0.3020, Val loss: 0.3639, Learning rate: 0.000100
  Multiclass: Train acc: 0.8888, Val acc: 0.8360, Val F1: 0.8368
  Contralateral: Train acc: 0.9369, Val acc: 0.9169, Val F1: 0.8326
  Ipsilateral: Train acc: 0.9268, Val acc: 0.9191, Val F1: 0.8000
Epoch 56/500 - Train loss: 0.3232, Val loss: 0.3512, Learning rate: 0.000100
  Multiclass: Train acc: 0.8811, Val acc: 0.8315, Val F1: 0.8319
  Contralateral: Train acc: 0.9331, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9186, Val acc: 0.9258, Val F1: 0.8177
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 59 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 57/500 - Train loss: 0.3045, Val loss: 0.3851, Learning rate: 0.000100
  Multiclass: Train acc: 0.8912, Val acc: 0.8292, Val F1: 0.8291
  Contralateral: Train acc: 0.9413, Val acc: 0.9124, Val F1: 0.8282
  Ipsilateral: Train acc: 0.9302, Val acc: 0.9146, Val F1: 0.7765
Epoch 58/500 - Train loss: 0.3132, Val loss: 0.3715, Learning rate: 0.000100
  Multiclass: Train acc: 0.8806, Val acc: 0.8472, Val F1: 0.8475
  Contralateral: Train acc: 0.9379, Val acc: 0.9191, Val F1: 0.8364
  Ipsilateral: Train acc: 0.9220, Val acc: 0.9056, Val F1: 0.7667
Epoch 59/500 - Train loss: 0.3260, Val loss: 0.3772, Learning rate: 0.000100
  Multiclass: Train acc: 0.8801, Val acc: 0.8337, Val F1: 0.8340
  Contralateral: Train acc: 0.9350, Val acc: 0.9124, Val F1: 0.8297
  Ipsilateral: Train acc: 0.9230, Val acc: 0.9124, Val F1: 0.7719
Epoch 60/500 - Train loss: 0.2968, Val loss: 0.3542, Learning rate: 0.000100
  Multiclass: Train acc: 0.8844, Val acc: 0.8427, Val F1: 0.8433
  Contralateral: Train acc: 0.9355, Val acc: 0.9146, Val F1: 0.8348
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 63 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 61/500 - Train loss: 0.3171, Val loss: 0.3461, Learning rate: 0.000100
  Multiclass: Train acc: 0.8902, Val acc: 0.8247, Val F1: 0.8255
  Contralateral: Train acc: 0.9389, Val acc: 0.9101, Val F1: 0.8319
  Ipsilateral: Train acc: 0.9234, Val acc: 0.9236, Val F1: 0.8111
New best model saved (val_loss: 0.3461)
Epoch 62/500 - Train loss: 0.2872, Val loss: 0.3561, Learning rate: 0.000100
  Multiclass: Train acc: 0.8864, Val acc: 0.8247, Val F1: 0.8257
  Contralateral: Train acc: 0.9326, Val acc: 0.9079, Val F1: 0.8240
  Ipsilateral: Train acc: 0.9312, Val acc: 0.9213, Val F1: 0.8087
Epoch 63/500 - Train loss: 0.2706, Val loss: 0.3688, Learning rate: 0.000100
  Multiclass: Train acc: 0.8897, Val acc: 0.8292, Val F1: 0.8306
  Contralateral: Train acc: 0.9456, Val acc: 0.9124, Val F1: 0.8282
Epoch 67 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 67 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 64/500 - Train loss: 0.2778, Val loss: 0.3688, Learning rate: 0.000100
  Multiclass: Train acc: 0.9027, Val acc: 0.8404, Val F1: 0.8416
  Contralateral: Train acc: 0.9470, Val acc: 0.9146, Val F1: 0.8403
  Ipsilateral: Train acc: 0.9384, Val acc: 0.9213, Val F1: 0.8066
Epoch 65/500 - Train loss: 0.2834, Val loss: 0.3594, Learning rate: 0.000100
  Multiclass: Train acc: 0.8955, Val acc: 0.8292, Val F1: 0.8299
  Contralateral: Train acc: 0.9437, Val acc: 0.9191, Val F1: 0.8435
  Ipsilateral: Train acc: 0.9364, Val acc: 0.9146, Val F1: 0.7865
Epoch 66/500 - Train loss: 0.2635, Val loss: 0.3841, Learning rate: 0.000100
  Multiclass: Train acc: 0.8965, Val acc: 0.8225, Val F1: 0.8230
  Contralateral: Train acc: 0.9413, Val acc: 0.9146, Val F1: 0.8390
  Ipsilateral: Train acc: 0.9408, Val acc: 0.9079, Val F1: 0.7657
Epoch 00067: reducing learning rate of group 0 to 5.0000e-05.
Epoch 67/500 - Train loss: 0.2741, Val loss: 0.3636, Learning rate: 0.000050
  Multiclass: Train acc: 0.8989, Val acc: 0.8225, Val F1: 0.8230
  Contralateral: Train acc: 0.9403, Val acc: 0.9101, Val F1: 0.8276
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 114.39it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 114.39it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 68/500 - Train loss: 0.2545, Val loss: 0.3702, Learning rate: 0.000050
  Multiclass: Train acc: 0.8941, Val acc: 0.8225, Val F1: 0.8228
  Contralateral: Train acc: 0.9446, Val acc: 0.9169, Val F1: 0.8439
  Ipsilateral: Train acc: 0.9427, Val acc: 0.9056, Val F1: 0.7614
Early stopping triggered after 68 epochs
Best model was at epoch 61
Training completed. Best validation loss: 0.3461
Evaluating on test set...
[2025-04-09 16:24:33,746][HYDRA] 	#8 : model=lstm model.hidden_size=128 model.num_layers=1 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 128
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 128, batch_first=True)
  (batch_norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=128, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 292935
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.1803, Val loss: 1.0316, Learning rate: 0.001000
  Multiclass: Train acc: 0.5113, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6688, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7699, Val acc: 0.8112, Val F1: 0.0000
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.01it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.01it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 2/500 - Train loss: 1.0100, Val loss: 0.8766, Learning rate: 0.001000
  Multiclass: Train acc: 0.5850, Val acc: 0.6135, Val F1: 0.5284
  Contralateral: Train acc: 0.7472, Val acc: 0.7978, Val F1: 0.4512
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8766)
Epoch 3/500 - Train loss: 0.8119, Val loss: 0.6527, Learning rate: 0.001000
  Multiclass: Train acc: 0.6625, Val acc: 0.7393, Val F1: 0.7338
  Contralateral: Train acc: 0.7833, Val acc: 0.8404, Val F1: 0.6359
  Ipsilateral: Train acc: 0.8426, Val acc: 0.8697, Val F1: 0.5857
New best model saved (val_loss: 0.6527)
Epoch 4/500 - Train loss: 0.6177, Val loss: 0.4564, Learning rate: 0.001000
  Multiclass: Train acc: 0.7371, Val acc: 0.7843, Val F1: 0.7827
  Contralateral: Train acc: 0.8344, Val acc: 0.8921, Val F1: 0.7857
  Ipsilateral: Train acc: 0.8729, Val acc: 0.8944, Val F1: 0.6928
New best model saved (val_loss: 0.4564)
Epoch 5/500 - Train loss: 0.4751, Val loss: 0.4308, Learning rate: 0.001000
  Multiclass: Train acc: 0.8098, Val acc: 0.7798, Val F1: 0.7795
  Contralateral: Train acc: 0.8743, Val acc: 0.8831, Val F1: 0.7815
  Ipsilateral: Train acc: 0.9085, Val acc: 0.8876, Val F1: 0.6835
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 114.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 114.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 6/500 - Train loss: 0.4180, Val loss: 0.4624, Learning rate: 0.001000
  Multiclass: Train acc: 0.8310, Val acc: 0.8112, Val F1: 0.8128
  Contralateral: Train acc: 0.9076, Val acc: 0.8809, Val F1: 0.7725
  Ipsilateral: Train acc: 0.9186, Val acc: 0.9191, Val F1: 0.8000
Epoch 7/500 - Train loss: 0.3414, Val loss: 0.4624, Learning rate: 0.001000
  Multiclass: Train acc: 0.8695, Val acc: 0.8180, Val F1: 0.8179
  Contralateral: Train acc: 0.9153, Val acc: 0.9011, Val F1: 0.8053
  Ipsilateral: Train acc: 0.9374, Val acc: 0.9124, Val F1: 0.7607
Epoch 8/500 - Train loss: 0.3390, Val loss: 0.4640, Learning rate: 0.001000
  Multiclass: Train acc: 0.8729, Val acc: 0.8067, Val F1: 0.8051
  Contralateral: Train acc: 0.9220, Val acc: 0.9079, Val F1: 0.8285
  Ipsilateral: Train acc: 0.9379, Val acc: 0.9056, Val F1: 0.7162
Epoch 9/500 - Train loss: 0.2682, Val loss: 0.5027, Learning rate: 0.001000
  Multiclass: Train acc: 0.8999, Val acc: 0.8382, Val F1: 0.8378
  Contralateral: Train acc: 0.9316, Val acc: 0.8989, Val F1: 0.8035
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
/home/ghazal/anaconda3/lib/python3.10/site-packages/hydra/_internal/core_plugins/basic_launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 10/500 - Train loss: 0.2529, Val loss: 0.4683, Learning rate: 0.001000
  Multiclass: Train acc: 0.9056, Val acc: 0.8584, Val F1: 0.8589
  Contralateral: Train acc: 0.9379, Val acc: 0.9101, Val F1: 0.8319
  Ipsilateral: Train acc: 0.9600, Val acc: 0.9416, Val F1: 0.8415
Epoch 00011: reducing learning rate of group 0 to 5.0000e-04.
Epoch 11/500 - Train loss: 0.2456, Val loss: 0.5144, Learning rate: 0.000500
  Multiclass: Train acc: 0.9119, Val acc: 0.8472, Val F1: 0.8466
  Contralateral: Train acc: 0.9451, Val acc: 0.9169, Val F1: 0.8326
  Ipsilateral: Train acc: 0.9596, Val acc: 0.9258, Val F1: 0.7950
Epoch 12/500 - Train loss: 0.2012, Val loss: 0.5122, Learning rate: 0.000500
  Multiclass: Train acc: 0.9350, Val acc: 0.8607, Val F1: 0.8611
  Contralateral: Train acc: 0.9624, Val acc: 0.9169, Val F1: 0.8295
  Ipsilateral: Train acc: 0.9687, Val acc: 0.9371, Val F1: 0.8409
Early stopping triggered after 12 epochs
Best model was at epoch 5
Training completed. Best validation loss: 0.4308
Evaluating on test set...
[2025-04-09 16:24:40,899][HYDRA] 	#9 : model=lstm model.hidden_size=128 model.num_layers=1 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 128
  num_layers: 1
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 128, batch_first=True)
  (batch_norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=128, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 292935
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 111.33it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 3 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 111.33it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1/500 - Train loss: 1.3205, Val loss: 1.2583, Learning rate: 0.000100
  Multiclass: Train acc: 0.3597, Val acc: 0.4764, Val F1: 0.4626
  Contralateral: Train acc: 0.5633, Val acc: 0.6539, Val F1: 0.2222
  Ipsilateral: Train acc: 0.6379, Val acc: 0.7910, Val F1: 0.1622
New best model saved (val_loss: 1.2583)
Epoch 2/500 - Train loss: 1.2527, Val loss: 1.1968, Learning rate: 0.000100
  Multiclass: Train acc: 0.4328, Val acc: 0.5685, Val F1: 0.4854
  Contralateral: Train acc: 0.6341, Val acc: 0.7169, Val F1: 0.1923
  Ipsilateral: Train acc: 0.7236, Val acc: 0.8112, Val F1: 0.0233
New best model saved (val_loss: 1.1968)
Epoch 3/500 - Train loss: 1.2127, Val loss: 1.1506, Learning rate: 0.000100
  Multiclass: Train acc: 0.4993, Val acc: 0.5775, Val F1: 0.4454
  Contralateral: Train acc: 0.6466, Val acc: 0.7461, Val F1: 0.1630
  Ipsilateral: Train acc: 0.7655, Val acc: 0.8112, Val F1: 0.0000
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 104.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 7 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 104.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 4/500 - Train loss: 1.1643, Val loss: 1.1105, Learning rate: 0.000100
  Multiclass: Train acc: 0.5407, Val acc: 0.5753, Val F1: 0.4292
  Contralateral: Train acc: 0.6957, Val acc: 0.7528, Val F1: 0.0833
  Ipsilateral: Train acc: 0.7800, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1105)
Epoch 5/500 - Train loss: 1.1263, Val loss: 1.0829, Learning rate: 0.000100
  Multiclass: Train acc: 0.5676, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.6962, Val acc: 0.7596, Val F1: 0.0531
  Ipsilateral: Train acc: 0.7987, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0829)
Epoch 6/500 - Train loss: 1.1071, Val loss: 1.0555, Learning rate: 0.000100
  Multiclass: Train acc: 0.5643, Val acc: 0.5663, Val F1: 0.4095
  Contralateral: Train acc: 0.7082, Val acc: 0.7618, Val F1: 0.0536
  Ipsilateral: Train acc: 0.7987, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0555)
Epoch 7/500 - Train loss: 1.0695, Val loss: 1.0288, Learning rate: 0.000100
  Multiclass: Train acc: 0.5797, Val acc: 0.5820, Val F1: 0.4435
  Contralateral: Train acc: 0.7400, Val acc: 0.7730, Val F1: 0.1368
  Ipsilateral: Train acc: 0.8175, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 11 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8/500 - Train loss: 1.0541, Val loss: 1.0088, Learning rate: 0.000100
  Multiclass: Train acc: 0.5797, Val acc: 0.5820, Val F1: 0.4435
  Contralateral: Train acc: 0.7174, Val acc: 0.7663, Val F1: 0.1034
  Ipsilateral: Train acc: 0.8166, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0088)
Epoch 9/500 - Train loss: 1.0267, Val loss: 0.9837, Learning rate: 0.000100
  Multiclass: Train acc: 0.5864, Val acc: 0.5888, Val F1: 0.4578
  Contralateral: Train acc: 0.7217, Val acc: 0.7798, Val F1: 0.1967
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9837)
Epoch 10/500 - Train loss: 0.9947, Val loss: 0.9601, Learning rate: 0.000100
  Multiclass: Train acc: 0.5980, Val acc: 0.5955, Val F1: 0.4707
  Contralateral: Train acc: 0.7328, Val acc: 0.7843, Val F1: 0.2258
  Ipsilateral: Train acc: 0.8219, Val acc: 0.8112, Val F1: 0.0000
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.46it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 11 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.46it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 11/500 - Train loss: 0.9685, Val loss: 0.9320, Learning rate: 0.000100
  Multiclass: Train acc: 0.6158, Val acc: 0.5978, Val F1: 0.4784
  Contralateral: Train acc: 0.7482, Val acc: 0.7933, Val F1: 0.2923
  Ipsilateral: Train acc: 0.8185, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9320)
Epoch 12/500 - Train loss: 0.9436, Val loss: 0.9047, Learning rate: 0.000100
  Multiclass: Train acc: 0.6192, Val acc: 0.6067, Val F1: 0.4949
  Contralateral: Train acc: 0.7559, Val acc: 0.7978, Val F1: 0.3284
  Ipsilateral: Train acc: 0.8276, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9047)
Epoch 13/500 - Train loss: 0.9311, Val loss: 0.8758, Learning rate: 0.000100
  Multiclass: Train acc: 0.6273, Val acc: 0.6112, Val F1: 0.5059
  Contralateral: Train acc: 0.7506, Val acc: 0.8067, Val F1: 0.3768
  Ipsilateral: Train acc: 0.8238, Val acc: 0.8090, Val F1: 0.0000
New best model saved (val_loss: 0.8758)
Epoch 14/500 - Train loss: 0.8736, Val loss: 0.8372, Learning rate: 0.000100
  Multiclass: Train acc: 0.6471, Val acc: 0.6247, Val F1: 0.5417
  Contralateral: Train acc: 0.7780, Val acc: 0.8180, Val F1: 0.4706
  Ipsilateral: Train acc: 0.8325, Val acc: 0.8112, Val F1: 0.0233
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 15 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 15/500 - Train loss: 0.8485, Val loss: 0.8049, Learning rate: 0.000100
  Multiclass: Train acc: 0.6673, Val acc: 0.6337, Val F1: 0.5634
  Contralateral: Train acc: 0.7694, Val acc: 0.8270, Val F1: 0.5096
  Ipsilateral: Train acc: 0.8373, Val acc: 0.8112, Val F1: 0.0233
New best model saved (val_loss: 0.8049)
Epoch 16/500 - Train loss: 0.7995, Val loss: 0.7590, Learning rate: 0.000100
  Multiclass: Train acc: 0.6740, Val acc: 0.6404, Val F1: 0.5816
  Contralateral: Train acc: 0.7886, Val acc: 0.8202, Val F1: 0.4937
  Ipsilateral: Train acc: 0.8349, Val acc: 0.8135, Val F1: 0.0460
New best model saved (val_loss: 0.7590)
Epoch 17/500 - Train loss: 0.7535, Val loss: 0.7186, Learning rate: 0.000100
  Multiclass: Train acc: 0.6928, Val acc: 0.6719, Val F1: 0.6423
  Contralateral: Train acc: 0.7857, Val acc: 0.8404, Val F1: 0.6034
  Ipsilateral: Train acc: 0.8455, Val acc: 0.8202, Val F1: 0.1489
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 19 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.21it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 18/500 - Train loss: 0.7048, Val loss: 0.6749, Learning rate: 0.000100
  Multiclass: Train acc: 0.7236, Val acc: 0.7146, Val F1: 0.7012
  Contralateral: Train acc: 0.7983, Val acc: 0.8404, Val F1: 0.6162
  Ipsilateral: Train acc: 0.8565, Val acc: 0.8337, Val F1: 0.3148
New best model saved (val_loss: 0.6749)
Epoch 19/500 - Train loss: 0.6667, Val loss: 0.6360, Learning rate: 0.000100
  Multiclass: Train acc: 0.7390, Val acc: 0.7483, Val F1: 0.7408
  Contralateral: Train acc: 0.8093, Val acc: 0.8360, Val F1: 0.6368
  Ipsilateral: Train acc: 0.8604, Val acc: 0.8562, Val F1: 0.4667
New best model saved (val_loss: 0.6360)
Epoch 20/500 - Train loss: 0.6156, Val loss: 0.5959, Learning rate: 0.000100
  Multiclass: Train acc: 0.7569, Val acc: 0.7640, Val F1: 0.7592
  Contralateral: Train acc: 0.8329, Val acc: 0.8472, Val F1: 0.6699
  Ipsilateral: Train acc: 0.8642, Val acc: 0.8764, Val F1: 0.5669
New best model saved (val_loss: 0.5959)
Epoch 21/500 - Train loss: 0.5947, Val loss: 0.5637, Learning rate: 0.000100
  Multiclass: Train acc: 0.7631, Val acc: 0.7730, Val F1: 0.7676
  Contralateral: Train acc: 0.8233, Val acc: 0.8494, Val F1: 0.6763
  Ipsilateral: Train acc: 0.8840, Val acc: 0.8854, Val F1: 0.6047
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.63it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 23 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.63it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 22/500 - Train loss: 0.5540, Val loss: 0.5196, Learning rate: 0.000100
  Multiclass: Train acc: 0.7877, Val acc: 0.8022, Val F1: 0.8012
  Contralateral: Train acc: 0.8353, Val acc: 0.8517, Val F1: 0.6887
  Ipsilateral: Train acc: 0.8844, Val acc: 0.9034, Val F1: 0.7152
New best model saved (val_loss: 0.5196)
Epoch 23/500 - Train loss: 0.5057, Val loss: 0.4913, Learning rate: 0.000100
  Multiclass: Train acc: 0.8089, Val acc: 0.8022, Val F1: 0.8020
  Contralateral: Train acc: 0.8599, Val acc: 0.8652, Val F1: 0.7368
  Ipsilateral: Train acc: 0.8912, Val acc: 0.9124, Val F1: 0.7310
New best model saved (val_loss: 0.4913)
Epoch 24/500 - Train loss: 0.4931, Val loss: 0.4671, Learning rate: 0.000100
  Multiclass: Train acc: 0.8050, Val acc: 0.8180, Val F1: 0.8174
  Contralateral: Train acc: 0.8541, Val acc: 0.8764, Val F1: 0.7489
  Ipsilateral: Train acc: 0.8950, Val acc: 0.9056, Val F1: 0.7237
New best model saved (val_loss: 0.4671)
Epoch 25/500 - Train loss: 0.4390, Val loss: 0.4455, Learning rate: 0.000100
  Multiclass: Train acc: 0.8406, Val acc: 0.8180, Val F1: 0.8176
  Contralateral: Train acc: 0.8772, Val acc: 0.8831, Val F1: 0.7679
  Ipsilateral: Train acc: 0.9066, Val acc: 0.9146, Val F1: 0.7625
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.90it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 27 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.90it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 26/500 - Train loss: 0.4172, Val loss: 0.4342, Learning rate: 0.000100
  Multiclass: Train acc: 0.8469, Val acc: 0.8135, Val F1: 0.8131
  Contralateral: Train acc: 0.8830, Val acc: 0.8989, Val F1: 0.7926
  Ipsilateral: Train acc: 0.9104, Val acc: 0.9056, Val F1: 0.7439
New best model saved (val_loss: 0.4342)
Epoch 27/500 - Train loss: 0.3992, Val loss: 0.4293, Learning rate: 0.000100
  Multiclass: Train acc: 0.8411, Val acc: 0.8067, Val F1: 0.8060
  Contralateral: Train acc: 0.8816, Val acc: 0.8921, Val F1: 0.7778
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9101, Val F1: 0.7468
New best model saved (val_loss: 0.4293)
Epoch 28/500 - Train loss: 0.3876, Val loss: 0.4093, Learning rate: 0.000100
  Multiclass: Train acc: 0.8488, Val acc: 0.8315, Val F1: 0.8318
  Contralateral: Train acc: 0.8902, Val acc: 0.8899, Val F1: 0.7860
  Ipsilateral: Train acc: 0.9273, Val acc: 0.9213, Val F1: 0.7879
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 31 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 110.32it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 29/500 - Train loss: 0.3717, Val loss: 0.3982, Learning rate: 0.000100
  Multiclass: Train acc: 0.8637, Val acc: 0.8270, Val F1: 0.8271
  Contralateral: Train acc: 0.8830, Val acc: 0.8944, Val F1: 0.7983
  Ipsilateral: Train acc: 0.9259, Val acc: 0.9169, Val F1: 0.7702
New best model saved (val_loss: 0.3982)
Epoch 30/500 - Train loss: 0.3431, Val loss: 0.4018, Learning rate: 0.000100
  Multiclass: Train acc: 0.8690, Val acc: 0.8270, Val F1: 0.8273
  Contralateral: Train acc: 0.9119, Val acc: 0.8944, Val F1: 0.7930
  Ipsilateral: Train acc: 0.9321, Val acc: 0.9213, Val F1: 0.7929
Epoch 31/500 - Train loss: 0.3252, Val loss: 0.4004, Learning rate: 0.000100
  Multiclass: Train acc: 0.8772, Val acc: 0.8247, Val F1: 0.8251
  Contralateral: Train acc: 0.9080, Val acc: 0.8944, Val F1: 0.7911
  Ipsilateral: Train acc: 0.9307, Val acc: 0.9146, Val F1: 0.7791
Epoch 32/500 - Train loss: 0.3135, Val loss: 0.3938, Learning rate: 0.000100
  Multiclass: Train acc: 0.8734, Val acc: 0.8315, Val F1: 0.8318
  Contralateral: Train acc: 0.9133, Val acc: 0.9011, Val F1: 0.8036
  Ipsilateral: Train acc: 0.9345, Val acc: 0.9146, Val F1: 0.7791
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 35 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.76it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 33/500 - Train loss: 0.3025, Val loss: 0.3901, Learning rate: 0.000100
  Multiclass: Train acc: 0.8820, Val acc: 0.8382, Val F1: 0.8385
  Contralateral: Train acc: 0.9157, Val acc: 0.9034, Val F1: 0.8072
  Ipsilateral: Train acc: 0.9360, Val acc: 0.9213, Val F1: 0.7929
New best model saved (val_loss: 0.3901)
Epoch 34/500 - Train loss: 0.3033, Val loss: 0.3958, Learning rate: 0.000100
  Multiclass: Train acc: 0.8854, Val acc: 0.8292, Val F1: 0.8298
  Contralateral: Train acc: 0.9153, Val acc: 0.8966, Val F1: 0.7982
  Ipsilateral: Train acc: 0.9451, Val acc: 0.9191, Val F1: 0.7931
Epoch 35/500 - Train loss: 0.2809, Val loss: 0.4024, Learning rate: 0.000100
  Multiclass: Train acc: 0.8970, Val acc: 0.8382, Val F1: 0.8386
  Contralateral: Train acc: 0.9215, Val acc: 0.9101, Val F1: 0.8198
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.06it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 39 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 109.06it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 36/500 - Train loss: 0.2700, Val loss: 0.4064, Learning rate: 0.000100
  Multiclass: Train acc: 0.8979, Val acc: 0.8382, Val F1: 0.8379
  Contralateral: Train acc: 0.9234, Val acc: 0.9169, Val F1: 0.8341
  Ipsilateral: Train acc: 0.9538, Val acc: 0.9169, Val F1: 0.7784
Epoch 37/500 - Train loss: 0.2653, Val loss: 0.3927, Learning rate: 0.000100
  Multiclass: Train acc: 0.9061, Val acc: 0.8360, Val F1: 0.8367
  Contralateral: Train acc: 0.9350, Val acc: 0.9169, Val F1: 0.8356
  Ipsilateral: Train acc: 0.9446, Val acc: 0.9146, Val F1: 0.7865
Epoch 38/500 - Train loss: 0.2370, Val loss: 0.3955, Learning rate: 0.000100
  Multiclass: Train acc: 0.9080, Val acc: 0.8315, Val F1: 0.8321
  Contralateral: Train acc: 0.9393, Val acc: 0.9011, Val F1: 0.8136
  Ipsilateral: Train acc: 0.9538, Val acc: 0.9146, Val F1: 0.7841
Epoch 00039: reducing learning rate of group 0 to 5.0000e-05.
Epoch 39/500 - Train loss: 0.2349, Val loss: 0.3957, Learning rate: 0.000050
  Multiclass: Train acc: 0.9143, Val acc: 0.8337, Val F1: 0.8337
  Contralateral: Train acc: 0.9302, Val acc: 0.9101, Val F1: 0.8182
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 115.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 40/500 - Train loss: 0.2386, Val loss: 0.3909, Learning rate: 0.000050
  Multiclass: Train acc: 0.9138, Val acc: 0.8472, Val F1: 0.8471
  Contralateral: Train acc: 0.9312, Val acc: 0.9169, Val F1: 0.8295
  Ipsilateral: Train acc: 0.9581, Val acc: 0.9348, Val F1: 0.8324
Early stopping triggered after 40 epochs
Best model was at epoch 33
Training completed. Best validation loss: 0.3901
Evaluating on test set...
[2025-04-09 16:25:03,758][HYDRA] 	#10 : model=lstm model.hidden_size=128 model.num_layers=2 training.learning_rate=0.001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 128
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 128, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=128, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 425031
Starting training for lstm model...
Epoch 1/500 - Train loss: 1.2077, Val loss: 1.0778, Learning rate: 0.001000
  Multiclass: Train acc: 0.4974, Val acc: 0.5708, Val F1: 0.4195
  Contralateral: Train acc: 0.6485, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7419, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0778)
Epoch 2/500 - Train loss: 1.0481, Val loss: 0.9450, Learning rate: 0.001000
  Multiclass: Train acc: 0.5912, Val acc: 0.6067, Val F1: 0.5195
  Contralateral: Train acc: 0.7183, Val acc: 0.7640, Val F1: 0.1176
  Ipsilateral: Train acc: 0.8137, Val acc: 0.8112, Val F1: 0.0000
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 103.53it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 103.53it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 3/500 - Train loss: 0.8906, Val loss: 0.8042, Learning rate: 0.001000
  Multiclass: Train acc: 0.6553, Val acc: 0.6427, Val F1: 0.5703
  Contralateral: Train acc: 0.7785, Val acc: 0.8270, Val F1: 0.5882
  Ipsilateral: Train acc: 0.8185, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8042)
Epoch 4/500 - Train loss: 0.7536, Val loss: 0.6645, Learning rate: 0.001000
  Multiclass: Train acc: 0.7111, Val acc: 0.7461, Val F1: 0.7432
  Contralateral: Train acc: 0.8243, Val acc: 0.8607, Val F1: 0.7075
  Ipsilateral: Train acc: 0.8267, Val acc: 0.8539, Val F1: 0.4961
New best model saved (val_loss: 0.6645)
Epoch 5/500 - Train loss: 0.5831, Val loss: 0.4976, Learning rate: 0.001000
  Multiclass: Train acc: 0.7713, Val acc: 0.7820, Val F1: 0.7841
  Contralateral: Train acc: 0.8690, Val acc: 0.8944, Val F1: 0.7948
  Ipsilateral: Train acc: 0.8565, Val acc: 0.8674, Val F1: 0.6467
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.28it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.28it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 6/500 - Train loss: 0.5482, Val loss: 0.4330, Learning rate: 0.001000
  Multiclass: Train acc: 0.7896, Val acc: 0.8157, Val F1: 0.8171
  Contralateral: Train acc: 0.8873, Val acc: 0.8966, Val F1: 0.7928
  Ipsilateral: Train acc: 0.8705, Val acc: 0.9101, Val F1: 0.7778
New best model saved (val_loss: 0.4330)
Epoch 7/500 - Train loss: 0.4511, Val loss: 0.4992, Learning rate: 0.001000
  Multiclass: Train acc: 0.8363, Val acc: 0.8202, Val F1: 0.8193
  Contralateral: Train acc: 0.9177, Val acc: 0.9056, Val F1: 0.8158
  Ipsilateral: Train acc: 0.8922, Val acc: 0.8966, Val F1: 0.7125
Epoch 8/500 - Train loss: 0.3801, Val loss: 0.4430, Learning rate: 0.001000
  Multiclass: Train acc: 0.8560, Val acc: 0.8292, Val F1: 0.8296
  Contralateral: Train acc: 0.9177, Val acc: 0.9056, Val F1: 0.8019
  Ipsilateral: Train acc: 0.9191, Val acc: 0.9146, Val F1: 0.7889
Epoch 9/500 - Train loss: 0.3802, Val loss: 0.3981, Learning rate: 0.001000
  Multiclass: Train acc: 0.8642, Val acc: 0.8404, Val F1: 0.8407
  Contralateral: Train acc: 0.9220, Val acc: 0.9146, Val F1: 0.8288
  Ipsilateral: Train acc: 0.9230, Val acc: 0.9213, Val F1: 0.7929
Epoch 13 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 10/500 - Train loss: 0.3396, Val loss: 0.4188, Learning rate: 0.001000
  Multiclass: Train acc: 0.8816, Val acc: 0.8315, Val F1: 0.8313
  Contralateral: Train acc: 0.9249, Val acc: 0.9079, Val F1: 0.8128
  Ipsilateral: Train acc: 0.9422, Val acc: 0.9191, Val F1: 0.7831
Epoch 11/500 - Train loss: 0.3074, Val loss: 0.4926, Learning rate: 0.001000
  Multiclass: Train acc: 0.8820, Val acc: 0.8270, Val F1: 0.8268
  Contralateral: Train acc: 0.9254, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9417, Val acc: 0.9101, Val F1: 0.7561
Epoch 12/500 - Train loss: 0.2984, Val loss: 0.3587, Learning rate: 0.001000
  Multiclass: Train acc: 0.8994, Val acc: 0.8539, Val F1: 0.8538
  Contralateral: Train acc: 0.9442, Val acc: 0.9303, Val F1: 0.8610
  Ipsilateral: Train acc: 0.9485, Val acc: 0.9236, Val F1: 0.7927
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.14it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.14it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13/500 - Train loss: 0.2699, Val loss: 0.3607, Learning rate: 0.001000
  Multiclass: Train acc: 0.9027, Val acc: 0.8337, Val F1: 0.8347
  Contralateral: Train acc: 0.9413, Val acc: 0.9101, Val F1: 0.8261
  Ipsilateral: Train acc: 0.9446, Val acc: 0.9146, Val F1: 0.7841
Epoch 14/500 - Train loss: 0.2506, Val loss: 0.4209, Learning rate: 0.001000
  Multiclass: Train acc: 0.9023, Val acc: 0.8315, Val F1: 0.8312
  Contralateral: Train acc: 0.9427, Val acc: 0.9146, Val F1: 0.8333
  Ipsilateral: Train acc: 0.9514, Val acc: 0.9056, Val F1: 0.7439
Epoch 15/500 - Train loss: 0.2530, Val loss: 0.3437, Learning rate: 0.001000
  Multiclass: Train acc: 0.9143, Val acc: 0.8382, Val F1: 0.8389
  Contralateral: Train acc: 0.9451, Val acc: 0.9101, Val F1: 0.8230
  Ipsilateral: Train acc: 0.9533, Val acc: 0.9258, Val F1: 0.8156
New best model saved (val_loss: 0.3437)
Epoch 16/500 - Train loss: 0.2223, Val loss: 0.4144, Learning rate: 0.001000
  Multiclass: Train acc: 0.9177, Val acc: 0.8607, Val F1: 0.8611
  Contralateral: Train acc: 0.9499, Val acc: 0.9236, Val F1: 0.8522
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 115.07it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 17/500 - Train loss: 0.2438, Val loss: 0.4655, Learning rate: 0.001000
  Multiclass: Train acc: 0.9297, Val acc: 0.8562, Val F1: 0.8566
  Contralateral: Train acc: 0.9557, Val acc: 0.9258, Val F1: 0.8533
  Ipsilateral: Train acc: 0.9639, Val acc: 0.9326, Val F1: 0.8256
Epoch 18/500 - Train loss: 0.1934, Val loss: 0.6453, Learning rate: 0.001000
  Multiclass: Train acc: 0.9177, Val acc: 0.8517, Val F1: 0.8510
  Contralateral: Train acc: 0.9451, Val acc: 0.9236, Val F1: 0.8411
  Ipsilateral: Train acc: 0.9668, Val acc: 0.9258, Val F1: 0.7975
Epoch 19/500 - Train loss: 0.1998, Val loss: 0.4626, Learning rate: 0.001000
  Multiclass: Train acc: 0.9278, Val acc: 0.8584, Val F1: 0.8575
  Contralateral: Train acc: 0.9504, Val acc: 0.9236, Val F1: 0.8440
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 111.72it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 111.72it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 20/500 - Train loss: 0.1929, Val loss: 0.5691, Learning rate: 0.001000
  Multiclass: Train acc: 0.9442, Val acc: 0.8494, Val F1: 0.8494
  Contralateral: Train acc: 0.9663, Val acc: 0.9236, Val F1: 0.8496
  Ipsilateral: Train acc: 0.9673, Val acc: 0.9281, Val F1: 0.8049
Epoch 00021: reducing learning rate of group 0 to 5.0000e-04.
Epoch 21/500 - Train loss: 0.2119, Val loss: 0.4495, Learning rate: 0.000500
  Multiclass: Train acc: 0.9340, Val acc: 0.8652, Val F1: 0.8657
  Contralateral: Train acc: 0.9596, Val acc: 0.9281, Val F1: 0.8559
  Ipsilateral: Train acc: 0.9649, Val acc: 0.9348, Val F1: 0.8380
Epoch 22/500 - Train loss: 0.1147, Val loss: 0.5626, Learning rate: 0.000500
  Multiclass: Train acc: 0.9586, Val acc: 0.8539, Val F1: 0.8533
  Contralateral: Train acc: 0.9740, Val acc: 0.9213, Val F1: 0.8444
  Ipsilateral: Train acc: 0.9793, Val acc: 0.9281, Val F1: 0.7975
Early stopping triggered after 22 epochs
Best model was at epoch 15
Training completed. Best validation loss: 0.3437
Evaluating on test set...
[2025-04-09 16:25:16,576][HYDRA] 	#11 : model=lstm model.hidden_size=128 model.num_layers=2 training.learning_rate=0.0001
Configuration:
model:
  type: lstm
  input_size: 421
  hidden_size: 128
  num_layers: 2
  num_classes: 3
  dropout: 0.5
  task_weights:
    multiclass: 1.0
    contralateral: 0.5
    ipsilateral: 0.5
dataset:
  name: neural_data
  path: ${paths.data_dir}/aligned_data_009.csv
  sequence_length: 32
  apply_pca: true
  n_components: 3
  normalize: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  batch_size: 32
training:
  epochs: 500
  learning_rate: 0.0001
  weight_decay: 1.0e-05
  early_stopping_patience: 7
  gradient_clip_val: 1.0
seed: 42
device: cuda
paths:
  data_dir: ${oc.env:PWD}/data
  output_dir: ${oc.env:PWD}/outputs
  checkpoints_dir: ${paths.output_dir}/checkpoints
  logs_dir: ${paths.output_dir}/logs
  visualizations_dir: ${paths.output_dir}/visualizations
wandb:
  project: neural-decoding
  entity: mirzaeeghazal
  group: experiments
  mode: online
Using device: cuda
Creating dataset...
Loaded data shape: (2999, 423)
Number of neurons: 421
Sequence length: 32
Normalizing features...
Applying PCA for neural activity visualization...
Explained variance ratios: [0.6684717  0.00727231 0.00667578]
Created 2968 sequences of length 32
Class distribution:
  multiclass: {0: 1698, 1: 751, 2: 519}
  contralateral: {0: 2217, 1: 751}
  ipsilateral: {0: 2449, 1: 519}
Creating data loaders...
Data split: Train=2077, Val=445, Test=446
Creating lstm model...
Model architecture:
LSTMModel(
  (lstm): LSTM(421, 128, num_layers=2, batch_first=True, dropout=0.5)
  (batch_norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=128, out_features=64, bias=True)
  (relu1): ReLU()
  (dropout1): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=64, out_features=32, bias=True)
  (relu2): ReLU()
  (dropout2): Dropout(p=0.5, inplace=False)
  (multiclass_head): Linear(in_features=32, out_features=3, bias=True)
  (contralateral_head): Linear(in_features=32, out_features=2, bias=True)
  (ipsilateral_head): Linear(in_features=32, out_features=2, bias=True)
)
Total parameters: 425031
Starting training for lstm model...
Epoch 1 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 111.72it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 1/500 - Train loss: 1.3240, Val loss: 1.2537, Learning rate: 0.000100
  Multiclass: Train acc: 0.4141, Val acc: 0.5326, Val F1: 0.4237
  Contralateral: Train acc: 0.4993, Val acc: 0.6022, Val F1: 0.3746
  Ipsilateral: Train acc: 0.5623, Val acc: 0.7236, Val F1: 0.0752
New best model saved (val_loss: 1.2537)
Epoch 2/500 - Train loss: 1.2697, Val loss: 1.1987, Learning rate: 0.000100
  Multiclass: Train acc: 0.4627, Val acc: 0.5618, Val F1: 0.4125
  Contralateral: Train acc: 0.5609, Val acc: 0.6854, Val F1: 0.2391
  Ipsilateral: Train acc: 0.6326, Val acc: 0.7978, Val F1: 0.0217
New best model saved (val_loss: 1.1987)
Epoch 3/500 - Train loss: 1.2242, Val loss: 1.1621, Learning rate: 0.000100
  Multiclass: Train acc: 0.5031, Val acc: 0.5708, Val F1: 0.4200
  Contralateral: Train acc: 0.5985, Val acc: 0.7371, Val F1: 0.1583
  Ipsilateral: Train acc: 0.6904, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1621)
Epoch 4/500 - Train loss: 1.1991, Val loss: 1.1327, Learning rate: 0.000100
  Multiclass: Train acc: 0.5282, Val acc: 0.5730, Val F1: 0.4249
  Contralateral: Train acc: 0.6298, Val acc: 0.7528, Val F1: 0.0517
  Ipsilateral: Train acc: 0.7347, Val acc: 0.8112, Val F1: 0.0000
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.66it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 112.66it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 5/500 - Train loss: 1.1588, Val loss: 1.1072, Learning rate: 0.000100
  Multiclass: Train acc: 0.5431, Val acc: 0.5730, Val F1: 0.4284
  Contralateral: Train acc: 0.6524, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7525, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.1072)
Epoch 6/500 - Train loss: 1.1432, Val loss: 1.0814, Learning rate: 0.000100
  Multiclass: Train acc: 0.5373, Val acc: 0.5775, Val F1: 0.4386
  Contralateral: Train acc: 0.6721, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7694, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0814)
Epoch 7/500 - Train loss: 1.1042, Val loss: 1.0601, Learning rate: 0.000100
  Multiclass: Train acc: 0.5628, Val acc: 0.5753, Val F1: 0.4335
  Contralateral: Train acc: 0.6846, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7848, Val acc: 0.8112, Val F1: 0.0000
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 105.64it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 9 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 105.64it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 8/500 - Train loss: 1.0841, Val loss: 1.0337, Learning rate: 0.000100
  Multiclass: Train acc: 0.5652, Val acc: 0.5798, Val F1: 0.4464
  Contralateral: Train acc: 0.6943, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7819, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0337)
Epoch 9/500 - Train loss: 1.0396, Val loss: 1.0126, Learning rate: 0.000100
  Multiclass: Train acc: 0.5821, Val acc: 0.5820, Val F1: 0.4570
  Contralateral: Train acc: 0.7058, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.7997, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 1.0126)
Epoch 10/500 - Train loss: 1.0270, Val loss: 0.9912, Learning rate: 0.000100
  Multiclass: Train acc: 0.5980, Val acc: 0.5820, Val F1: 0.4646
  Contralateral: Train acc: 0.7039, Val acc: 0.7551, Val F1: 0.0000
  Ipsilateral: Train acc: 0.8089, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9912)
Epoch 11/500 - Train loss: 0.9858, Val loss: 0.9668, Learning rate: 0.000100
  Multiclass: Train acc: 0.6095, Val acc: 0.5978, Val F1: 0.4980
  Contralateral: Train acc: 0.7082, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8002, Val acc: 0.8112, Val F1: 0.0000
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 106.05it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 13 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 106.05it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 12/500 - Train loss: 0.9587, Val loss: 0.9437, Learning rate: 0.000100
  Multiclass: Train acc: 0.6139, Val acc: 0.6112, Val F1: 0.5203
  Contralateral: Train acc: 0.7251, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8098, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9437)
Epoch 13/500 - Train loss: 0.9315, Val loss: 0.9209, Learning rate: 0.000100
  Multiclass: Train acc: 0.6351, Val acc: 0.6247, Val F1: 0.5432
  Contralateral: Train acc: 0.7241, Val acc: 0.7573, Val F1: 0.0182
  Ipsilateral: Train acc: 0.8045, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.9209)
Epoch 14/500 - Train loss: 0.8869, Val loss: 0.8979, Learning rate: 0.000100
  Multiclass: Train acc: 0.6461, Val acc: 0.6315, Val F1: 0.5552
  Contralateral: Train acc: 0.7299, Val acc: 0.7596, Val F1: 0.0531
  Ipsilateral: Train acc: 0.8045, Val acc: 0.8112, Val F1: 0.0000
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.23it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 17 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.23it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 15/500 - Train loss: 0.8732, Val loss: 0.8715, Learning rate: 0.000100
  Multiclass: Train acc: 0.6548, Val acc: 0.6360, Val F1: 0.5668
  Contralateral: Train acc: 0.7429, Val acc: 0.7730, Val F1: 0.1653
  Ipsilateral: Train acc: 0.8103, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8715)
Epoch 16/500 - Train loss: 0.8515, Val loss: 0.8403, Learning rate: 0.000100
  Multiclass: Train acc: 0.6765, Val acc: 0.6697, Val F1: 0.6065
  Contralateral: Train acc: 0.7492, Val acc: 0.7843, Val F1: 0.2500
  Ipsilateral: Train acc: 0.8089, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8403)
Epoch 17/500 - Train loss: 0.8137, Val loss: 0.8214, Learning rate: 0.000100
  Multiclass: Train acc: 0.6856, Val acc: 0.6629, Val F1: 0.6046
  Contralateral: Train acc: 0.7660, Val acc: 0.8157, Val F1: 0.4306
  Ipsilateral: Train acc: 0.8093, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.8214)
Epoch 18/500 - Train loss: 0.7868, Val loss: 0.7885, Learning rate: 0.000100
  Multiclass: Train acc: 0.7073, Val acc: 0.6764, Val F1: 0.6325
  Contralateral: Train acc: 0.7776, Val acc: 0.8337, Val F1: 0.5316
  Ipsilateral: Train acc: 0.8137, Val acc: 0.8112, Val F1: 0.0000
Epoch 21 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 93.11it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 21 (Val): 100%|██████████████████████████████████| 14/14 [00:00<00:00, 93.11it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 19/500 - Train loss: 0.7557, Val loss: 0.7624, Learning rate: 0.000100
  Multiclass: Train acc: 0.7102, Val acc: 0.7011, Val F1: 0.6583
  Contralateral: Train acc: 0.7795, Val acc: 0.8315, Val F1: 0.5455
  Ipsilateral: Train acc: 0.8204, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7624)
Epoch 20/500 - Train loss: 0.7274, Val loss: 0.7299, Learning rate: 0.000100
  Multiclass: Train acc: 0.7227, Val acc: 0.7169, Val F1: 0.6863
  Contralateral: Train acc: 0.8045, Val acc: 0.8562, Val F1: 0.6701
  Ipsilateral: Train acc: 0.8257, Val acc: 0.8112, Val F1: 0.0000
New best model saved (val_loss: 0.7299)
Epoch 21/500 - Train loss: 0.7058, Val loss: 0.6916, Learning rate: 0.000100
  Multiclass: Train acc: 0.7338, Val acc: 0.7303, Val F1: 0.7051
  Contralateral: Train acc: 0.8166, Val acc: 0.8719, Val F1: 0.7107
  Ipsilateral: Train acc: 0.8214, Val acc: 0.8112, Val F1: 0.0000
Epoch 25 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 25 (Val):   0%|                                           | 0/14 [00:00<?, ?it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 22/500 - Train loss: 0.6490, Val loss: 0.6644, Learning rate: 0.000100
  Multiclass: Train acc: 0.7573, Val acc: 0.7416, Val F1: 0.7225
  Contralateral: Train acc: 0.8406, Val acc: 0.8652, Val F1: 0.7000
  Ipsilateral: Train acc: 0.8233, Val acc: 0.8135, Val F1: 0.0235
New best model saved (val_loss: 0.6644)
Epoch 23/500 - Train loss: 0.6350, Val loss: 0.6161, Learning rate: 0.000100
  Multiclass: Train acc: 0.7660, Val acc: 0.7730, Val F1: 0.7628
  Contralateral: Train acc: 0.8416, Val acc: 0.8742, Val F1: 0.7308
  Ipsilateral: Train acc: 0.8363, Val acc: 0.8157, Val F1: 0.0465
New best model saved (val_loss: 0.6161)
Epoch 24/500 - Train loss: 0.6211, Val loss: 0.5995, Learning rate: 0.000100
  Multiclass: Train acc: 0.7718, Val acc: 0.7843, Val F1: 0.7815
  Contralateral: Train acc: 0.8479, Val acc: 0.8921, Val F1: 0.7757
  Ipsilateral: Train acc: 0.8363, Val acc: 0.8225, Val F1: 0.1505
New best model saved (val_loss: 0.5995)
Epoch 25/500 - Train loss: 0.5778, Val loss: 0.5778, Learning rate: 0.000100
  Multiclass: Train acc: 0.7877, Val acc: 0.8000, Val F1: 0.7981
  Contralateral: Train acc: 0.8556, Val acc: 0.8854, Val F1: 0.7583
  Ipsilateral: Train acc: 0.8430, Val acc: 0.8427, Val F1: 0.3137
Epoch 25 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 25 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.58it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 26/500 - Train loss: 0.5777, Val loss: 0.5516, Learning rate: 0.000100
  Multiclass: Train acc: 0.7886, Val acc: 0.8067, Val F1: 0.8057
  Contralateral: Train acc: 0.8801, Val acc: 0.8787, Val F1: 0.7453
  Ipsilateral: Train acc: 0.8339, Val acc: 0.8674, Val F1: 0.4870
New best model saved (val_loss: 0.5516)
Epoch 27/500 - Train loss: 0.5499, Val loss: 0.5568, Learning rate: 0.000100
  Multiclass: Train acc: 0.7959, Val acc: 0.8225, Val F1: 0.8228
  Contralateral: Train acc: 0.8825, Val acc: 0.8831, Val F1: 0.7699
  Ipsilateral: Train acc: 0.8512, Val acc: 0.8674, Val F1: 0.5124
Epoch 28/500 - Train loss: 0.5062, Val loss: 0.5282, Learning rate: 0.000100
  Multiclass: Train acc: 0.8247, Val acc: 0.8225, Val F1: 0.8223
  Contralateral: Train acc: 0.8849, Val acc: 0.8921, Val F1: 0.7838
  Ipsilateral: Train acc: 0.8575, Val acc: 0.8764, Val F1: 0.5802
Epoch 29 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.79it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 29 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.79it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 29/500 - Train loss: 0.4917, Val loss: 0.5080, Learning rate: 0.000100
  Multiclass: Train acc: 0.8175, Val acc: 0.8180, Val F1: 0.8189
  Contralateral: Train acc: 0.9042, Val acc: 0.8944, Val F1: 0.7965
  Ipsilateral: Train acc: 0.8671, Val acc: 0.8809, Val F1: 0.6345
New best model saved (val_loss: 0.5080)
Epoch 30/500 - Train loss: 0.4858, Val loss: 0.5026, Learning rate: 0.000100
  Multiclass: Train acc: 0.8310, Val acc: 0.8157, Val F1: 0.8165
  Contralateral: Train acc: 0.8902, Val acc: 0.8989, Val F1: 0.8052
  Ipsilateral: Train acc: 0.8565, Val acc: 0.9034, Val F1: 0.7190
New best model saved (val_loss: 0.5026)
Epoch 31/500 - Train loss: 0.4576, Val loss: 0.5034, Learning rate: 0.000100
  Multiclass: Train acc: 0.8373, Val acc: 0.8067, Val F1: 0.8070
  Contralateral: Train acc: 0.9027, Val acc: 0.8876, Val F1: 0.7748
  Ipsilateral: Train acc: 0.8637, Val acc: 0.9011, Val F1: 0.6944
Epoch 32/500 - Train loss: 0.4159, Val loss: 0.4780, Learning rate: 0.000100
  Multiclass: Train acc: 0.8580, Val acc: 0.8180, Val F1: 0.8187
  Contralateral: Train acc: 0.9138, Val acc: 0.8966, Val F1: 0.7982
  Ipsilateral: Train acc: 0.8796, Val acc: 0.8944, Val F1: 0.7006
Epoch 33 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.50it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 33 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.50it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 33/500 - Train loss: 0.4517, Val loss: 0.4879, Learning rate: 0.000100
  Multiclass: Train acc: 0.8474, Val acc: 0.8202, Val F1: 0.8194
  Contralateral: Train acc: 0.9076, Val acc: 0.9101, Val F1: 0.8182
  Ipsilateral: Train acc: 0.8758, Val acc: 0.8921, Val F1: 0.6712
Epoch 34/500 - Train loss: 0.4260, Val loss: 0.5052, Learning rate: 0.000100
  Multiclass: Train acc: 0.8498, Val acc: 0.8022, Val F1: 0.8002
  Contralateral: Train acc: 0.9090, Val acc: 0.8966, Val F1: 0.7909
  Ipsilateral: Train acc: 0.8753, Val acc: 0.8876, Val F1: 0.6479
Epoch 35/500 - Train loss: 0.4107, Val loss: 0.4752, Learning rate: 0.000100
  Multiclass: Train acc: 0.8517, Val acc: 0.8247, Val F1: 0.8245
  Contralateral: Train acc: 0.9177, Val acc: 0.8989, Val F1: 0.7926
  Ipsilateral: Train acc: 0.8777, Val acc: 0.8944, Val F1: 0.6928
Epoch 37 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.98it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 37 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 113.98it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 36/500 - Train loss: 0.3894, Val loss: 0.4441, Learning rate: 0.000100
  Multiclass: Train acc: 0.8671, Val acc: 0.8337, Val F1: 0.8344
  Contralateral: Train acc: 0.9167, Val acc: 0.9056, Val F1: 0.8091
  Ipsilateral: Train acc: 0.8907, Val acc: 0.9079, Val F1: 0.7545
New best model saved (val_loss: 0.4441)
Epoch 37/500 - Train loss: 0.3807, Val loss: 0.4674, Learning rate: 0.000100
  Multiclass: Train acc: 0.8719, Val acc: 0.8180, Val F1: 0.8179
  Contralateral: Train acc: 0.9268, Val acc: 0.8944, Val F1: 0.7911
  Ipsilateral: Train acc: 0.8984, Val acc: 0.9056, Val F1: 0.7342
Epoch 38/500 - Train loss: 0.3617, Val loss: 0.4705, Learning rate: 0.000100
  Multiclass: Train acc: 0.8811, Val acc: 0.8180, Val F1: 0.8184
  Contralateral: Train acc: 0.9249, Val acc: 0.8989, Val F1: 0.8000
  Ipsilateral: Train acc: 0.9056, Val acc: 0.9034, Val F1: 0.7362
Epoch 39/500 - Train loss: 0.3683, Val loss: 0.4471, Learning rate: 0.000100
  Multiclass: Train acc: 0.8666, Val acc: 0.8135, Val F1: 0.8145
  Contralateral: Train acc: 0.9292, Val acc: 0.8921, Val F1: 0.7983
Epoch 41 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.72it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 41 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.72it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 40/500 - Train loss: 0.3537, Val loss: 0.4421, Learning rate: 0.000100
  Multiclass: Train acc: 0.8724, Val acc: 0.8270, Val F1: 0.8275
  Contralateral: Train acc: 0.9283, Val acc: 0.9079, Val F1: 0.8128
  Ipsilateral: Train acc: 0.9076, Val acc: 0.8966, Val F1: 0.7229
New best model saved (val_loss: 0.4421)
Epoch 41/500 - Train loss: 0.3377, Val loss: 0.4588, Learning rate: 0.000100
  Multiclass: Train acc: 0.8936, Val acc: 0.8180, Val F1: 0.8188
  Contralateral: Train acc: 0.9331, Val acc: 0.8899, Val F1: 0.7841
  Ipsilateral: Train acc: 0.9119, Val acc: 0.9124, Val F1: 0.7771
Epoch 42/500 - Train loss: 0.3323, Val loss: 0.4523, Learning rate: 0.000100
  Multiclass: Train acc: 0.8926, Val acc: 0.8427, Val F1: 0.8435
  Contralateral: Train acc: 0.9360, Val acc: 0.9213, Val F1: 0.8402
Epoch 45 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.08it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 45 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 111.08it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 43/500 - Train loss: 0.3362, Val loss: 0.4612, Learning rate: 0.000100
  Multiclass: Train acc: 0.8869, Val acc: 0.8247, Val F1: 0.8254
  Contralateral: Train acc: 0.9446, Val acc: 0.9124, Val F1: 0.8251
  Ipsilateral: Train acc: 0.9095, Val acc: 0.9124, Val F1: 0.7771
Epoch 44/500 - Train loss: 0.3236, Val loss: 0.4730, Learning rate: 0.000100
  Multiclass: Train acc: 0.8946, Val acc: 0.8270, Val F1: 0.8275
  Contralateral: Train acc: 0.9336, Val acc: 0.9056, Val F1: 0.8142
  Ipsilateral: Train acc: 0.9249, Val acc: 0.9124, Val F1: 0.7746
Epoch 45/500 - Train loss: 0.3185, Val loss: 0.4400, Learning rate: 0.000100
  Multiclass: Train acc: 0.8984, Val acc: 0.8360, Val F1: 0.8365
  Contralateral: Train acc: 0.9432, Val acc: 0.9101, Val F1: 0.8214
  Ipsilateral: Train acc: 0.9215, Val acc: 0.9281, Val F1: 0.8222
New best model saved (val_loss: 0.4400)
Epoch 46/500 - Train loss: 0.3347, Val loss: 0.4509, Learning rate: 0.000100
  Multiclass: Train acc: 0.8883, Val acc: 0.8427, Val F1: 0.8436
  Contralateral: Train acc: 0.9384, Val acc: 0.9034, Val F1: 0.8122
Epoch 49 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 49 (Val): 100%|█████████████████████████████████| 14/14 [00:00<00:00, 112.70it/s]launcher.py:74: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
Epoch 47/500 - Train loss: 0.3139, Val loss: 0.4536, Learning rate: 0.000100
  Multiclass: Train acc: 0.8970, Val acc: 0.8472, Val F1: 0.8476
  Contralateral: Train acc: 0.9384, Val acc: 0.9146, Val F1: 0.8273
  Ipsilateral: Train acc: 0.9191, Val acc: 0.9303, Val F1: 0.8249
Epoch 48/500 - Train loss: 0.3029, Val loss: 0.4917, Learning rate: 0.000100
  Multiclass: Train acc: 0.9037, Val acc: 0.8360, Val F1: 0.8366
  Contralateral: Train acc: 0.9466, Val acc: 0.9124, Val F1: 0.8251
  Ipsilateral: Train acc: 0.9225, Val acc: 0.9191, Val F1: 0.7955
Epoch 49/500 - Train loss: 0.2880, Val loss: 0.4572, Learning rate: 0.000100
  Multiclass: Train acc: 0.9129, Val acc: 0.8337, Val F1: 0.8347
  Contralateral: Train acc: 0.9504, Val acc: 0.9056, Val F1: 0.8108
NameError: name 'F' is not defined: ['model=lstm', 'model.hidden_size=32', 'model.num_layers=1', 'training.learning_rate=0.001'] versions will no longer change working directory at job runtime by default.
NameError: name 'F' is not defined: ['model=lstm', 'model.hidden_size=32', 'model.num_layers=1', 'training.learning_rate=0.001'] versions will no longer change working directory at job runtime by default.
Epoch 50/500 - Train loss: 0.2723, Val loss: 0.5134, Learning rate: 0.000100
  Multiclass: Train acc: 0.9061, Val acc: 0.8382, Val F1: 0.8388
  Contralateral: Train acc: 0.9437, Val acc: 0.9056, Val F1: 0.8073
  Ipsilateral: Train acc: 0.9302, Val acc: 0.9169, Val F1: 0.7910
Epoch 00051: reducing learning rate of group 0 to 5.0000e-05.
Epoch 51/500 - Train loss: 0.2924, Val loss: 0.5157, Learning rate: 0.000050
  Multiclass: Train acc: 0.9027, Val acc: 0.8270, Val F1: 0.8276
  Contralateral: Train acc: 0.9514, Val acc: 0.9011, Val F1: 0.8036
  Ipsilateral: Train acc: 0.9283, Val acc: 0.9124, Val F1: 0.7797
Epoch 52/500 - Train loss: 0.2565, Val loss: 0.5144, Learning rate: 0.000050
  Multiclass: Train acc: 0.9109, Val acc: 0.8247, Val F1: 0.8257
  Contralateral: Train acc: 0.9533, Val acc: 0.9011, Val F1: 0.8018
  Ipsilateral: Train acc: 0.9326, Val acc: 0.9169, Val F1: 0.7910
Early stopping triggered after 52 epochs
Best model was at epoch 45
Training completed. Best validation loss: 0.4400
Evaluating on test set...