WandB initialized successfully!
Starting training...
Starting training for lstm model...
Using device: cuda
Model parameters: 164,551 total, 164,551 trainable
Epoch 1/100 - Time: 1.2s - Train loss: 0.2543, Val loss: 0.2468, Learning rate: 0.000001
  Multiclass: Train acc: 0.4360, Val acc: 0.5101, Val F1: 0.4523
  Contralateral: Train acc: 0.6943, Val acc: 0.7360, Val F1: 0.0484
  Ipsilateral: Train acc: 0.2900, Val acc: 0.2125, Val F1: 0.2903
Checkpoint saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/checkpoints/lstm/best_model.pth
New best model saved (val_loss: 0.2468)
Epoch 1 (Train): 100%|█████████████| 32/32 [00:00<00:00, 82.23it/s, loss=0.2543]
Epoch 1 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 65.39it/s, loss=0.2468]
Epoch 2 (Train): 100%|████████████| 32/32 [00:00<00:00, 119.17it/s, loss=0.2548]
Epoch 2 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 64.21it/s, loss=0.2490]
Epoch 3 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.97it/s, loss=0.2542]
Epoch 3 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 63.65it/s, loss=0.2500]
Epoch 4 (Train): 100%|████████████| 32/32 [00:00<00:00, 114.91it/s, loss=0.2538]
Epoch 4 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 62.96it/s, loss=0.2501]
Epoch 5 (Train):  12%|█▊            | 4/32 [00:00<00:00, 39.25it/s, loss=0.2584]
Epoch 2/100 - Time: 0.8s - Train loss: 0.2548, Val loss: 0.2490, Learning rate: 0.000001
  Multiclass: Train acc: 0.4146, Val acc: 0.5145, Val F1: 0.4574
  Contralateral: Train acc: 0.6895, Val acc: 0.7360, Val F1: 0.0484
  Ipsilateral: Train acc: 0.3101, Val acc: 0.2125, Val F1: 0.2874
No improvement in validation score: 1/7
Epoch 3/100 - Time: 0.8s - Train loss: 0.2542, Val loss: 0.2500, Learning rate: 0.000001
  Multiclass: Train acc: 0.4263, Val acc: 0.5101, Val F1: 0.4544
  Contralateral: Train acc: 0.6802, Val acc: 0.7360, Val F1: 0.0484
  Ipsilateral: Train acc: 0.3110, Val acc: 0.2192, Val F1: 0.2892
No improvement in validation score: 2/7
Epoch 4/100 - Time: 0.8s - Train loss: 0.2538, Val loss: 0.2501, Learning rate: 0.000001
  Multiclass: Train acc: 0.4204, Val acc: 0.5123, Val F1: 0.4551
  Contralateral: Train acc: 0.6973, Val acc: 0.7360, Val F1: 0.0484
  Ipsilateral: Train acc: 0.2822, Val acc: 0.2148, Val F1: 0.2880
Epoch 5 (Train): 100%|████████████| 32/32 [00:00<00:00, 119.14it/s, loss=0.2545]
Epoch 5 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 62.48it/s, loss=0.2500]
Epoch 6 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.46it/s, loss=0.2533]
Epoch 6 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 62.84it/s, loss=0.2500]
Epoch 7 (Train): 100%|████████████| 32/32 [00:00<00:00, 118.13it/s, loss=0.2535]
Epoch 7 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 61.79it/s, loss=0.2500]
Epoch 5/100 - Time: 0.8s - Train loss: 0.2545, Val loss: 0.2500, Learning rate: 0.000001
  Multiclass: Train acc: 0.4170, Val acc: 0.5101, Val F1: 0.4543
  Contralateral: Train acc: 0.6763, Val acc: 0.7338, Val F1: 0.0480
  Ipsilateral: Train acc: 0.3027, Val acc: 0.2125, Val F1: 0.2846
No improvement in validation score: 4/7
Epoch 6/100 - Time: 0.9s - Train loss: 0.2533, Val loss: 0.2500, Learning rate: 0.000001
  Multiclass: Train acc: 0.4458, Val acc: 0.5101, Val F1: 0.4548
  Contralateral: Train acc: 0.6890, Val acc: 0.7360, Val F1: 0.0484
  Ipsilateral: Train acc: 0.3047, Val acc: 0.2192, Val F1: 0.2863
No improvement in validation score: 5/7
Epoch 00007: reducing learning rate of group 0 to 5.0000e-07.
Epoch 7/100 - Time: 0.8s - Train loss: 0.2535, Val loss: 0.2500, Learning rate: 0.000000
  Multiclass: Train acc: 0.4380, Val acc: 0.5101, Val F1: 0.4534
  Contralateral: Train acc: 0.6841, Val acc: 0.7338, Val F1: 0.0480
  Ipsilateral: Train acc: 0.3135, Val acc: 0.2215, Val F1: 0.2869
No improvement in validation score: 6/7
Epoch 8/100 - Time: 0.8s - Train loss: 0.2527, Val loss: 0.2498, Learning rate: 0.000000
  Multiclass: Train acc: 0.4438, Val acc: 0.4966, Val F1: 0.4447
  Contralateral: Train acc: 0.6968, Val acc: 0.7315, Val F1: 0.0476
  Ipsilateral: Train acc: 0.2925, Val acc: 0.2260, Val F1: 0.2881
No improvement in validation score: 7/7
Early stopping triggered after 7 epochs without improvement
Early stopping triggered after 8 epochs
Best model was at epoch 1
Training completed in 6.7s. Best validation loss: 0.2468
Loaded model from checkpoint (epoch 1)
Evaluating model on test set...
Multiclass Test Metrics:
  accuracy: 0.5078
  precision: 0.4261
  recall: 0.5078
  f1: 0.4460
Contralateral Test Metrics:
  accuracy: 0.7251
  precision: 0.2353
  recall: 0.0348
  f1: 0.0606
Ipsilateral Test Metrics:
  accuracy: 0.2106
  precision: 0.1761
  recall: 0.9375
  f1: 0.2964
Overall Test Accuracy: 0.4812
Generating visualizations...
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_confusion_matrix.png
Epoch 8 (Train): 100%|████████████| 32/32 [00:00<00:00, 116.58it/s, loss=0.2527]
Epoch 8 (Val): 100%|█████████████████| 7/7 [00:00<00:00, 61.90it/s, loss=0.2498]
Evaluating: 100%|████████████████████| 8/8 [00:00<00:00, 68.84it/s, loss=0.4150]
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_confusion_matrix.png
Saved confusion matrix to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_confusion_matrix.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/multiclass_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/contralateral_roc_curves.png
Saved ROC curves to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/visualizations/ipsilateral_roc_curves.png
Test results saved to /home/ghazal/Documents/NS_Projects/NS_Revised_P1/neural_decoding/outputs/lstm/test_results.json